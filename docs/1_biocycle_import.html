<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Salivary and serum immunoassay comparison: Import</title>



  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-01-04"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-01-04"/>
  <meta name="article:author" content="Ruben Arslan"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Salivary and serum immunoassay comparison: Import"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Salivary and serum immunoassay comparison"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Salivary and serum immunoassay comparison: Import"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Import"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Ruben Arslan"]}]}]},{"type":"character","attributes":{},"value":["1/4/2021"]},{"type":"character","attributes":{},"value":["html_document"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
  <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Import","authors":[{"author":"Ruben Arslan","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-01-04T00:00:00.000+00:00","citationText":"Arslan, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Import</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  
  Ruben Arslan
  
<br/>1/4/2021
</div>

<div class="d-article">
<p>From Prasad et al. 2014</p>
<p>Blood collection and handling protocols were designed to minimize variability (Wactawski- Wende et al., 2009). All samples were processed and frozen at −80°C within 90 minutes of phlebotomy and analytes were measured in participant-specific batches within a single run to limit analytical variability. Estradiol, LH, follicle-stimulating hormone (FSH), and progesterone concentrations were measured in serum samples using solid-phase competitive chemiluminescent enzymatic immunoassays (DPC Immulite 2000 analyzer, Siemens Medical Solutions Diagnostics, Deerfield, IL) at the Kaleida Health Center for Laboratory Medicine (Buffalo, NY). Serum testosterone was measured by liquid chromatography/ tandem mass spectrometry (Shimadzu Prominence Liquid Chromatogram with an ABSceix 5500 tandem mass spectrometer) by the Advanced Research and Diagnostic Laboratory, Minneapolis, MN. Increased sensitivity was achieved by using 100% acetonitrile mobile phase B as the solvent gradient elution and adding a low standard of 4 ng/dL. The interassay maximum coefficients of variation reported by the laboratory were ≤10% for estradiol; ≤5% for LH and FSH; ≤14% for progesterone; and ≤7% for testosterone. All hormone measurements were log-transformed for normality before statistical analysis and then transformed by exponentiation for table display. In addition, LH and progesterone measurements were restricted in the analysis to mid-cycle (three days around the LH surge) and luteal phase (early, mid and late), respectively, as these are the phases with the greatest</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>── Attaching packages ───────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>✓ ggplot2 3.3.5     ✓ purrr   0.3.4
✓ tibble  3.1.4     ✓ dplyr   1.0.7
✓ tidyr   1.1.3     ✓ stringr 1.4.0
✓ readr   2.0.1     ✓ forcats 0.5.1</code></pre>
<pre><code>── Conflicts ──────────────────────────────── tidyverse_conflicts() ──
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/rubenarslan/codebook'>codebook</a></span><span class='op'>)</span>
<span class='va'>fool_renv</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='op'>)</span><span class='op'>{</span> <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/rstudio/DT'>DT</a></span><span class='op'>)</span>; <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-packages.gitlab.io/ufs'>ufs</a></span><span class='op'>)</span> <span class='op'>}</span>
</code></pre>
</div>
</div>
<h2 id="load-various-datasets">Load various datasets</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>&lt;-</span> <span class='fu'>rio</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rio/man/import.html'>import</a></span><span class='op'>(</span><span class='st'>"../data/BioCycle_StudyItems/biocycle04202017.sas7bdat"</span><span class='op'>)</span>
<span class='va'>biocycle_with_labels</span> <span class='op'>&lt;-</span> <span class='va'>biocycle</span>
<span class='va'>biocyclecsv</span> <span class='op'>&lt;-</span> <span class='fu'>rio</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rio/man/import.html'>import</a></span><span class='op'>(</span><span class='st'>"../data/BioCycle_StudyItems/biocycle04202017.csv"</span><span class='op'>)</span>
<span class='va'>biocycle_between</span> <span class='op'>&lt;-</span> <span class='fu'>rio</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rio/man/import.html'>import</a></span><span class='op'>(</span><span class='st'>"../data/BioCycle_StudyItems/biocyclebaseline05022017.sas7bdat"</span><span class='op'>)</span>
<span class='va'>biocycle_update</span> <span class='op'>&lt;-</span> <span class='fu'>rio</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rio/man/import.html'>import</a></span><span class='op'>(</span><span class='st'>"../data/BioCycle_StudyItems/biocycle_update.sas7bdat"</span><span class='op'>)</span> <span class='co'># todo: is peak day really expressed as cday? I think so</span>
<span class='va'>biocycle_sexdiary</span> <span class='op'>&lt;-</span> <span class='fu'>rio</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rio/man/import.html'>import</a></span><span class='op'>(</span><span class='st'>"../data/BioCycle_StudyItems/sex_nodates.sas7bdat"</span><span class='op'>)</span>
<span class='co'># add on update data with albumin and testosterone, urinary hormones and self-rep cycle length</span>
<span class='va'>biocycle</span> <span class='op'>&lt;-</span> <span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>biocycle_update</span> <span class='op'>%&gt;%</span> 
                                     <span class='fu'>select</span><span class='op'>(</span>id <span class='op'>=</span> <span class='va'>idnum</span>, <span class='va'>cycle</span>, <span class='va'>day</span>, <span class='va'>visit</span>, <span class='va'>ALBUMN</span>, <span class='va'>Testo</span>, <span class='va'>cycle_length_bl</span>, <span class='va'>LH_monitor_peak</span>, <span class='va'>E3g_monitor_peak</span>, <span class='va'>peak_day</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Joining, by = c(&quot;id&quot;, &quot;cycle&quot;, &quot;day&quot;, &quot;visit&quot;)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>&lt;-</span> <span class='fu'>full_join</span><span class='op'>(</span><span class='va'>biocycle</span>, <span class='va'>biocycle_between</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span> <span class='op'>=</span> <span class='st'>"idnum"</span><span class='op'>)</span><span class='op'>)</span>


<span class='fu'><a href='http://larmarange.github.io/labelled/reference/var_label.html'>var_label</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>Testo</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"Testosterone (ng/dL)"</span>
<span class='fu'><a href='http://larmarange.github.io/labelled/reference/var_label.html'>var_label</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>ALBUMN</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"Albumin (g/dL)"</span>
<span class='fu'><a href='http://larmarange.github.io/labelled/reference/var_label.html'>var_label</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>cycle_length_bl</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"Self-reported cycle length"</span>

<span class='fu'><a href='https://rdrr.io/r/stats/xtabs.html'>xtabs</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>day</span> <span class='op'>+</span> <span class='va'>visit</span>, <span class='va'>biocycle</span><span class='op'>)</span> <span class='co'># day is a redundant re-expression of visit type</span>
</code></pre>
</div>
<pre><code>    visit
day   CL  F1  L1  L2  M1  O1  O2  O3
  2    0   0   0   0 508   0   0   0
  7    0 508   0   0   0   0   0   0
  12   0   0   0   0   0 510   0   0
  13   0   0   0   0   0   0 510   0
  14   0   0   0   0   0   0   0 505
  18 499   0   0   0   0   0   0   0
  22   0   0 486   0   0   0   0   0
  27   0   0   0 389   0   0   0   0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>## I don't have labelled missing values for testo and albumin, so I don't know which are missing due to limits of detection and which because the assay was not run</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>biocyclecsv</span><span class='op'>$</span><span class='va'>SHBG</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>""</span>, <span class='st'>"M"</span><span class='op'>)</span>, <span class='va'>biocyclecsv</span><span class='op'>$</span><span class='va'>ESTRGEN</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>""</span>, <span class='st'>"M"</span><span class='op'>)</span>, <span class='va'>biocyclecsv</span><span class='op'>$</span><span class='va'>PROGEST</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>""</span>, <span class='st'>"M"</span><span class='op'>)</span>, exclude <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>, ,  = FALSE

       
        FALSE TRUE
  FALSE  3897    0
  TRUE      4    0

, ,  = TRUE

       
        FALSE TRUE
  FALSE     0    0
  TRUE      0   14</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># heuristically I can apparently hope to infer that these 14 samples had too little serum/were not run</span>
<span class='va'>biocycle</span><span class='op'>$</span><span class='va'>noserum</span> <span class='op'>&lt;-</span> <span class='va'>biocyclecsv</span><span class='op'>$</span><span class='va'>ESTRGEN</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>""</span>, <span class='st'>"M"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>noserum</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 14</code></pre>
</div>
<h2 id="limits-of-detection">Limits of detection</h2>
<p>Here, I label values below the limit of detection as left-censored and impute them using the limit (not divided by √2, as I will proceed to use a model-based approach in brms). Sources for the limits of detection: BioCycle documentation of the IMMULITE 2000 assays where possible (E, P), lowest observed value + other online descriptions of IMMULITE assays (SHBG, ALBUMIN, T).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>ESTRGEN</span>, <span class='va'>Testo</span>, <span class='va'>PROGEST</span>, <span class='va'>SHBG</span>, <span class='va'>ALBUMN</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>summarise_all</span><span class='op'>(</span><span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  ESTRGEN Testo PROGEST SHBG ALBUMN
1     102    47     161   22     16</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>ESTRGEN</span> <span class='op'>&lt;=</span> <span class='fl'>20</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>ESTRGEN</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   ESTRGEN
1      6.9
2     20.0
3     20.0
4     20.0
5     20.0
6     20.0
7     20.0
8     20.0
9     20.0
10    20.0
11    20.0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>ESTRGEN_cens</span> <span class='op'>&lt;-</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>biocyclecsv</span><span class='op'>$</span><span class='va'>ESTRGEN</span> <span class='op'>==</span> <span class='st'>"L"</span> <span class='op'>|</span> <span class='va'>biocycle</span><span class='op'>$</span><span class='va'>ESTRGEN</span> <span class='op'>&lt;</span> <span class='fl'>20</span>, <span class='st'>"left"</span>, <span class='st'>"none"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>Testo</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
FALSE  TRUE 
 3868    47 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>Testo_cens</span> <span class='op'>&lt;-</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>Testo</span> <span class='op'>&lt;</span> <span class='fl'>3</span>, <span class='st'>"left"</span>, <span class='st'>"none"</span>, <span class='cn'>NA_character_</span><span class='op'>)</span>

<span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>PROGEST</span> <span class='op'>&lt;=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>PROGEST</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>    PROGEST
1       0.2
2       0.2
3       0.2
4       0.2
5       0.2
6       0.2
7       0.2
8       0.2
9       0.2
10      0.2
11      0.2
12      0.2
13      0.2
14      0.2
15      0.2
16      0.2
17      0.2
18      0.2
19      0.2
20      0.2
21      0.2
22      0.2
23      0.2
24      0.2
25      0.2
26      0.2
27      0.2
28      0.2
29      0.2
30      0.2
31      0.2
32      0.2
33      0.2
34      0.2
35      0.2
36      0.2
37      0.2
38      0.2
39      0.2
40      0.2
41      0.2
42      0.2
43      0.2
44      0.2
45      0.2
46      0.2
47      0.2
48      0.2
49      0.2
50      0.2
51      0.2
52      0.2
53      0.2
54      0.2
55      0.2
56      0.2
57      0.2
58      0.2
59      0.2
60      0.2
61      0.2
62      0.2
63      0.2
64      0.2
65      0.2
66      0.2
67      0.2
68      0.2
69      0.2
70      0.2
71      0.2
72      0.2
73      0.2
74      0.2
75      0.2
76      0.2
77      0.2
78      0.2
79      0.2
80      0.2
81      0.2
82      0.2
83      0.2
84      0.2
85      0.2
86      0.2
87      0.2
88      0.2
89      0.2
90      0.2
91      0.2
92      0.2
93      0.2
94      0.2
95      0.2
96      0.2
97      0.2
98      0.2
99      0.2
100     0.2
101     0.2
102     0.2
103     0.2
104     0.2
105     0.2
106     0.2
107     0.2
108     0.2
109     0.2
110     0.2
111     0.2
112     0.2
113     0.2
114     0.2
115     0.2
116     0.2
117     0.2
118     0.2
119     0.2
120     0.2
121     0.2
122     0.2
123     0.2
124     0.2
125     0.2
126     0.2
127     0.2
128     0.2
129     0.2
130     0.2
131     0.2
132     0.2
133     0.2
134     0.2
135     0.2
136     0.2
137     0.2
138     0.2
139     0.2
140     0.2
141     0.2
142     0.2
143     0.2
144     0.2
145     0.2
146     0.2
147     0.2</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>PROGEST_cens</span> <span class='op'>&lt;-</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>biocyclecsv</span><span class='op'>$</span><span class='va'>PROGEST</span> <span class='op'>==</span> <span class='st'>"L"</span> <span class='op'>|</span> <span class='va'>biocycle</span><span class='op'>$</span><span class='va'>PROGEST</span> <span class='op'>&lt;</span> <span class='fl'>0.2</span>, <span class='st'>"left"</span>, <span class='st'>"none"</span><span class='op'>)</span>

<span class='co'># according to https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5754513/ the LOD for IMMULITE 2000 SHBG is 0.8nmol/L, but the lowest value measured here is 4.7 (and the reference is for a 2-site, this was 5-site I think)</span>
<span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>SHBG</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>SHBG</span>, <span class='va'>noserum</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>head</span>
</code></pre>
</div>
<pre><code>  SHBG noserum
1  4.7   FALSE
2  5.0   FALSE
3  5.0   FALSE
4  5.1   FALSE
5  5.1   FALSE
6  5.6   FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>SHBG</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 4.7</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>biocyclecsv</span><span class='op'>$</span><span class='va'>SHBG</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>SHBG</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
    L  M 
14  4  4 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>SHBG_cens</span> <span class='op'>&lt;-</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>biocyclecsv</span><span class='op'>$</span><span class='va'>SHBG</span> <span class='op'>==</span> <span class='st'>"L"</span> <span class='op'>|</span> <span class='va'>biocycle</span><span class='op'>$</span><span class='va'>SHBG</span> <span class='op'>&lt;</span> <span class='fl'>2</span>, <span class='st'>"left"</span>, <span class='st'>"none"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>SHBG</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
FALSE  TRUE 
 3893    22 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># could not find a source, so using lowest observed value</span>
<span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>ALBUMN</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>ALBUMN</span>, <span class='va'>noserum</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>head</span>
</code></pre>
</div>
<pre><code>  ALBUMN noserum
1    1.7   FALSE
2    2.9   FALSE
3    3.1   FALSE
4    3.1   FALSE
5    3.1   FALSE
6    3.1   FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>ALBUMN</span><span class='op'>)</span>, <span class='va'>biocycle</span><span class='op'>$</span><span class='va'>noserum</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>       
        FALSE TRUE
  FALSE  3895    4
  TRUE      6   10</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>ALBUMN_cens</span> <span class='op'>&lt;-</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>ALBUMN</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>noserum</span>, <span class='st'>"left"</span>, <span class='st'>"none"</span><span class='op'>)</span>

<span class='va'>biocycle</span> <span class='op'>&lt;-</span> <span class='va'>biocycle</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>
    ESTRGEN <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>ESTRGEN_cens</span> <span class='op'>==</span> <span class='st'>"left"</span>, <span class='fl'>20</span>, <span class='va'>ESTRGEN</span><span class='op'>)</span>,
    Testo <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>Testo_cens</span> <span class='op'>==</span> <span class='st'>"left"</span>, <span class='fl'>3</span>, <span class='va'>Testo</span><span class='op'>)</span>,
    <span class='va'>PROGEST</span> <span class='op'>&lt;-</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>PROGEST_cens</span> <span class='op'>==</span> <span class='st'>"left"</span>, <span class='fl'>0.2</span>, <span class='va'>PROGEST</span><span class='op'>)</span>,
    SHBG <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>SHBG_cens</span> <span class='op'>==</span> <span class='st'>"left"</span>, <span class='fl'>2</span>, <span class='va'>SHBG</span><span class='op'>)</span>,
    ALBUMN <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>ALBUMN_cens</span> <span class='op'>==</span> <span class='st'>"left"</span>, <span class='fl'>1.7</span>, <span class='va'>ALBUMN</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>ESTRGEN</span>, <span class='va'>Testo</span>, <span class='va'>PROGEST</span>, <span class='va'>SHBG</span>, <span class='va'>ALBUMN</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>summarise_all</span><span class='op'>(</span><span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  ESTRGEN Testo PROGEST SHBG ALBUMN
1      14    47     161   18     10</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/codebook/man/rescue_attributes.html'>rescue_attributes</a></span><span class='op'>(</span><span class='va'>biocycle</span>, <span class='va'>biocycle_with_labels</span><span class='op'>)</span>
<span class='fu'><a href='http://larmarange.github.io/labelled/reference/var_label.html'>var_label</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>ESTRGEN</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Estradiol (pg/mL) numeric&quot;</code></pre>
</div>
<h2 id="add-free-hormone-levels">Add free hormone levels</h2>
<p>Ugly: requires exporting and manual copy-pasting to an Excel sheet received from Tom Fiers.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>rio</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rio/man/export.html'>export</a></span><span class='op'>(</span><span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>SHBG</span>, <span class='va'>ALBUMN</span>, <span class='va'>Testo</span>, <span class='va'>ESTRGEN</span><span class='op'>)</span>, <span class='st'>"../data/BioCycle_StudyItems/hormones_for_conversion.xlsx"</span><span class='op'>)</span>
<span class='va'>free_hormones</span> <span class='op'>&lt;-</span> <span class='fu'>readxl</span><span class='fu'>::</span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_xlsx</a></span><span class='op'>(</span><span class='st'>"../data/BioCycle_StudyItems/hormone_converted_to_free.xlsx"</span>, skip <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span>SHBG <span class='op'>=</span> <span class='va'>shbg</span>, ALBUMN <span class='op'>=</span> <span class='va'>`Alb.`</span>, Testo <span class='op'>=</span> <span class='va'>`T...7`</span>, ESTRGEN <span class='op'>=</span> <span class='va'>E2</span>, <span class='va'>`Free T (ng/dL)`</span>, <span class='va'>`Free E2 (pg/mL)`</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>New names:
* `` -&gt; ...2
* nr -&gt; nr...3
* `` -&gt; ...4
* T -&gt; T...6
* T -&gt; T...7
* ...</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle2</span> <span class='op'>&lt;-</span> <span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>free_hormones</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Joining, by = c(&quot;ESTRGEN&quot;, &quot;SHBG&quot;, &quot;ALBUMN&quot;, &quot;Testo&quot;)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"T_check"</span>, <span class='st'>"E_check"</span>, <span class='st'>"SHBG_check"</span>, <span class='st'>"Free T (ng/dL)"</span>, <span class='st'>"Free E2 (pg/mL)"</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>free_hormones</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>Testo</span>, <span class='va'>ESTRGEN</span>, <span class='va'>SHBG</span>, <span class='va'>`Free T (ng/dL)`</span>, <span class='va'>`Free E2 (pg/mL)`</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/identical.html'>identical</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>Testo</span>, <span class='va'>biocycle</span><span class='op'>$</span><span class='va'>T_check</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/identical.html'>identical</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>ESTRGEN</span>, <span class='va'>biocycle</span><span class='op'>$</span><span class='va'>E_check</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/identical.html'>identical</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>SHBG</span>, <span class='va'>biocycle</span><span class='op'>$</span><span class='va'>SHBG_check</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>&lt;-</span> <span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>T_check</span>, <span class='op'>-</span><span class='va'>E_check</span>, <span class='op'>-</span><span class='va'>SHBG_check</span><span class='op'>)</span>

<span class='co'>## Sartorius formula</span>
<span class='va'>biocycle</span> <span class='op'>&lt;-</span> <span class='va'>biocycle</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>free_t_empirical <span class='op'>=</span> <span class='fl'>24.00314</span> <span class='op'>*</span> <span class='va'>Testo</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>SHBG</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>0.04599</span> <span class='op'>*</span> <span class='va'>Testo</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>

<span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>Testo</span>, <span class='va'>`Free T (ng/dL)`</span>, <span class='va'>free_t_empirical</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span>use<span class='op'>=</span><span class='st'>'p'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                 Testo Free T (ng/dL) free_t_empirical
Testo             1.00           0.71             0.84
Free T (ng/dL)    0.71           1.00             0.93
free_t_empirical  0.84           0.93             1.00</code></pre>
</div>
<h2 id="check-free-hormone-levels">Check free hormone levels</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>`Free E2 (pg/mL)`</span><span class='op'>/</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>ESTRGEN</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.01816731</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>`Free T (ng/dL)`</span><span class='op'>/</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>Testo</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.01590279</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>qplot</span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>`Free E2 (pg/mL)`</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_x_log10</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 14 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_biocycle_import_files/figure-html5/unnamed-chunk-5-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.test.html'>cor.test</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>`Free E2 (pg/mL)`</span>, <span class='va'>biocycle</span><span class='op'>$</span><span class='va'>ESTRGEN</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
    Pearson&#39;s product-moment correlation

data:  biocycle$`Free E2 (pg/mL)` and biocycle$ESTRGEN
t = 265.1, df = 3899, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.9716626 0.9749648
sample estimates:
      cor 
0.9733641 
</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggstatsplot</span><span class='fu'>::</span><span class='fu'><a href='https://indrajeetpatil.github.io/ggstatsplot/reference/ggscatterstats.html'>ggscatterstats</a></span><span class='op'>(</span><span class='va'>biocycle</span>, <span class='va'>ESTRGEN</span>, <span class='va'>`Free E2 (pg/mL)`</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning in genhypergeo_series_pos(U = c((n - 1)/2, (n - 1)/2), L = ((n
+ : Series not converged.</code></pre>
<pre><code>Loading required namespace: ggExtra</code></pre>
<p><img src="1_biocycle_import_files/figure-html5/unnamed-chunk-6-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.test.html'>cor.test</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>`Free T (ng/dL)`</span>, <span class='va'>biocycle</span><span class='op'>$</span><span class='va'>Testo</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
    Pearson&#39;s product-moment correlation

data:  biocycle$`Free T (ng/dL)` and biocycle$Testo
t = 62.754, df = 3866, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.6943919 0.7256326
sample estimates:
     cor 
0.710362 
</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggstatsplot</span><span class='fu'>::</span><span class='fu'><a href='https://indrajeetpatil.github.io/ggstatsplot/reference/ggscatterstats.html'>ggscatterstats</a></span><span class='op'>(</span><span class='va'>biocycle</span>, <span class='va'>Testo</span>, <span class='va'>`Free T (ng/dL)`</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning in genhypergeo_series_pos(U = c((n - 1)/2, (n - 1)/2), L = ((n
+ : Series not converged.</code></pre>
<p><img src="1_biocycle_import_files/figure-html5/unnamed-chunk-7-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># convert nanogram to picogram for progesterone</span>
<span class='va'>biocycle</span> <span class='op'>&lt;-</span> <span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>E_P <span class='op'>=</span> <span class='va'>ESTRGEN</span><span class='op'>/</span><span class='op'>(</span><span class='va'>PROGEST</span><span class='op'>*</span><span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>biocycle</span> <span class='op'>&lt;-</span> <span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>E_P_ws <span class='op'>=</span> <span class='va'>E_P</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>E_P</span>,na.rm<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>qplot</span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>E_P</span>,<span class='va'>biocycle</span><span class='op'>$</span><span class='va'>E_P_ws</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning: Removed 161 rows containing missing values (geom_point).</code></pre>
<img src="1_biocycle_import_files/figure-html5/unnamed-chunk-8-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>qplot</span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>E_P</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 161 rows containing non-finite values (stat_bin).</code></pre>
<img src="1_biocycle_import_files/figure-html5/unnamed-chunk-8-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>qplot</span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>E_P_ws</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 161 rows containing non-finite values (stat_bin).</code></pre>
<img src="1_biocycle_import_files/figure-html5/unnamed-chunk-8-3.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>E_P <span class='op'>=</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>E_P</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>pull</span><span class='op'>(</span><span class='va'>E_P</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>qplot</span>
</code></pre>
</div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 161 rows containing non-finite values (stat_bin).</code></pre>
<img src="1_biocycle_import_files/figure-html5/unnamed-chunk-8-4.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>ESTRGEN <span class='op'>=</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>ESTRGEN</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>pull</span><span class='op'>(</span><span class='va'>ESTRGEN</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>qplot</span>
</code></pre>
</div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 14 rows containing non-finite values (stat_bin).</code></pre>
<img src="1_biocycle_import_files/figure-html5/unnamed-chunk-8-5.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>ESTRGEN <span class='op'>=</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>ESTRGEN</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>pull</span><span class='op'>(</span><span class='va'>ESTRGEN</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>qplot</span>
</code></pre>
</div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 14 rows containing non-finite values (stat_bin).</code></pre>
<img src="1_biocycle_import_files/figure-html5/unnamed-chunk-8-6.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>PROGEST <span class='op'>=</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>PROGEST</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>pull</span><span class='op'>(</span><span class='va'>PROGEST</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>qplot</span>
</code></pre>
</div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 161 rows containing non-finite values (stat_bin).</code></pre>
<img src="1_biocycle_import_files/figure-html5/unnamed-chunk-8-7.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>PROGEST <span class='op'>=</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>PROGEST</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>pull</span><span class='op'>(</span><span class='va'>PROGEST</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>qplot</span>
</code></pre>
</div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 161 rows containing non-finite values (stat_bin).</code></pre>
<img src="1_biocycle_import_files/figure-html5/unnamed-chunk-8-8.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>PROGEST <span class='op'>=</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>PROGEST</span>,scale<span class='op'>=</span><span class='cn'>F</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>pull</span><span class='op'>(</span><span class='va'>PROGEST</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>qplot</span>
</code></pre>
</div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 161 rows containing non-finite values (stat_bin).</code></pre>
<img src="1_biocycle_import_files/figure-html5/unnamed-chunk-8-9.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>PROGEST <span class='op'>=</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>ESTRGEN</span>,scale<span class='op'>=</span><span class='cn'>F</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>pull</span><span class='op'>(</span><span class='va'>PROGEST</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>qplot</span>
</code></pre>
</div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 14 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_biocycle_import_files/figure-html5/unnamed-chunk-8-10.png" width="624" /></p>
</div>
<h2 id="remove-one-woman-with-empty-rows-in-one-cycle">Remove one woman with empty rows in one cycle</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>## remove one woman with empty rows for cycle 2</span>
<span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>==</span> <span class='fl'>1608</span>, <span class='va'>cycle</span> <span class='op'>==</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>nrow</span>
</code></pre>
</div>
<pre><code>[1] 4</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 3915</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>&lt;-</span> <span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>!=</span><span class='fl'>1608</span> <span class='op'>|</span> <span class='va'>cycle</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 3911</code></pre>
</div>
<h2 id="reverse-cycle-days">Reverse cycle days</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># anovulation algorithms https://www.sciencedirect.com/science/article/pii/S0015028214003951?casa_token=iNDHLoTcXM0AAAAA:AXjpvGRKhpZsSAK1frf9JGTjhzWgM72bbvw6w-0UlezAQkwGWhhrXmuavdmgz4myL66Sebu-4Q#kwrds0010</span>
<span class='va'>biocycle</span> <span class='op'>&lt;-</span> <span class='va'>biocycle</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>cycle_start_day <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='va'>cycle</span> <span class='op'>==</span> <span class='fl'>1</span> <span class='op'>~</span> <span class='va'>menseday1a</span>,
    <span class='va'>cycle</span> <span class='op'>==</span> <span class='fl'>2</span> <span class='op'>~</span> <span class='va'>menseday2a</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>NA_real_</span>
  <span class='op'>)</span>,
  cycle_end_day <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='va'>cycle</span> <span class='op'>==</span> <span class='fl'>1</span> <span class='op'>~</span> <span class='fu'>case_when</span><span class='op'>(</span>
      <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>menseday1end</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='va'>menseday2a</span> <span class='op'>&gt;</span> <span class='fl'>100</span> <span class='op'>~</span> <span class='cn'>NA_real_</span>,
      <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>menseday1end</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>menseday2a</span>, 
      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>menseday1end</span><span class='op'>)</span>,
    <span class='va'>cycle</span> <span class='op'>==</span> <span class='fl'>2</span> <span class='op'>~</span> <span class='va'>menseday3</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>NA_real_</span>
  <span class='op'>)</span>,
  cycle_length  <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='va'>cycle</span> <span class='op'>==</span> <span class='fl'>1</span> <span class='op'>~</span> <span class='va'>days1a</span>,
    <span class='va'>cycle</span> <span class='op'>==</span> <span class='fl'>2</span> <span class='op'>~</span> <span class='va'>days2a</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>NA_real_</span>
  <span class='op'>)</span>,
  cycle_length_mine <span class='op'>=</span> <span class='va'>cycle_end_day</span> <span class='op'>-</span> <span class='va'>cycle_start_day</span>,
  standardized_day_mine <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>cday</span> <span class='op'>/</span> <span class='va'>cycle_length_mine</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>
    anovulatory <span class='op'>=</span> 
      <span class='fu'>case_when</span><span class='op'>(</span>
        <span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>PROGEST</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|</span> <span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>LH</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>~</span> <span class='cn'>NA</span>,
        <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>PROGEST</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>&lt;=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>&amp;</span> 
        <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>LH</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='fl'>20</span><span class='op'>)</span> <span class='op'>~</span> <span class='cn'>TRUE</span>,
        <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>FALSE</span><span class='op'>)</span>,
    serum_LH_surge_day <span class='op'>=</span> <span class='fu'>first</span><span class='op'>(</span><span class='va'>cday</span><span class='op'>[</span><span class='va'>LH</span> <span class='op'>&gt;=</span> <span class='fl'>20</span><span class='op'>]</span><span class='op'>)</span>,
    serum_LH_peak_day <span class='op'>=</span> <span class='fu'>first</span><span class='op'>(</span><span class='va'>cday</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.min.html'>which.max</a></span><span class='op'>(</span><span class='va'>LH</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>,
    ovulation_day_LH_serum <span class='op'>=</span> <span class='va'>serum_LH_surge_day</span> <span class='op'>+</span> <span class='fl'>1</span>,
    ovulation_day_LH_serum_peak <span class='op'>=</span> <span class='va'>serum_LH_peak_day</span> <span class='op'>+</span> <span class='fl'>1</span>,
    ovulation_day_planned <span class='op'>=</span> <span class='fu'>first</span><span class='op'>(</span><span class='va'>cday</span><span class='op'>[</span><span class='va'>visit</span> <span class='op'>==</span> <span class='st'>"O3"</span><span class='op'>]</span><span class='op'>)</span>,
    RCD <span class='op'>=</span> <span class='va'>cday</span> <span class='op'>-</span> <span class='va'>cycle_end_day</span>,
    RCD <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>RCD</span> <span class='op'>&gt;</span> <span class='op'>-</span><span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>1</span>, <span class='va'>RCD</span><span class='op'>)</span>,
    FCD <span class='op'>=</span> <span class='va'>cday</span> <span class='op'>-</span> <span class='va'>cycle_start_day</span>,
    FCD <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>FCD</span> <span class='op'>&gt;</span> <span class='fl'>34</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>cycle_length</span><span class='op'>)</span>, <span class='cn'>NA_real_</span>, <span class='va'>FCD</span><span class='op'>)</span>,
    RCD_standardized <span class='op'>=</span> <span class='fl'>28</span><span class='op'>*</span><span class='va'>RCD</span><span class='op'>/</span><span class='va'>cycle_length</span>,
    DRLH_planned <span class='op'>=</span> <span class='va'>cday</span> <span class='op'>-</span> <span class='va'>ovulation_day_planned</span> <span class='op'>-</span> <span class='fl'>1</span>,
    DRLH <span class='op'>=</span> <span class='va'>FCD</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>peak_day</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span>,
    peak_day <span class='op'>=</span> <span class='va'>peak_day</span> <span class='op'>-</span> <span class='va'>FCD</span> <span class='op'>+</span> <span class='va'>cday</span>,
    DRLH_serum_surge <span class='op'>=</span> <span class='va'>cday</span> <span class='op'>-</span> <span class='va'>serum_LH_surge_day</span>,
    DRLH_serum_peak <span class='op'>=</span> <span class='va'>cday</span> <span class='op'>-</span> <span class='va'>serum_LH_peak_day</span>,
    standardized_day <span class='op'>=</span> <span class='fl'>28</span><span class='op'>*</span><span class='op'>(</span><span class='va'>FCD</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>/</span><span class='va'>cycle_length</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>

<span class='co'># biocycle %&gt;% select(id, cycle, ovulation_day_planned, ovulation_day_LH_serum, ovulation_day_LH_serum_peak, peak_day) %&gt;% distinct() %&gt;% head</span>
<span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>cycle</span> <span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>ovulation_day_planned</span>, <span class='va'>ovulation_day_LH_serum</span>, <span class='va'>ovulation_day_LH_serum_peak</span>,<span class='va'>serum_LH_peak_day</span>, <span class='va'>serum_LH_surge_day</span>, <span class='va'>peak_day</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>summarise_all</span><span class='op'>(</span><span class='va'>mean</span>,na.rm<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1 × 8
     id cycle ovulation_day_planned ovulation_day_LH… ovulation_day_L…
  &lt;dbl&gt; &lt;dbl&gt;                 &lt;dbl&gt;             &lt;dbl&gt;            &lt;dbl&gt;
1 1486.     1                  16.8              16.5             17.1
# … with 3 more variables: serum_LH_peak_day &lt;dbl&gt;,
#   serum_LH_surge_day &lt;dbl&gt;, peak_day &lt;dbl&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>cycle</span> <span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>ovulation_day_planned</span>, <span class='va'>ovulation_day_LH_serum</span>, <span class='va'>ovulation_day_LH_serum_peak</span>,<span class='va'>serum_LH_peak_day</span>, <span class='va'>serum_LH_surge_day</span>, <span class='va'>peak_day</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>summarise_all</span><span class='op'>(</span><span class='va'>sd</span>,na.rm<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1 × 8
     id cycle ovulation_day_planned ovulation_day_LH… ovulation_day_L…
  &lt;dbl&gt; &lt;dbl&gt;                 &lt;dbl&gt;             &lt;dbl&gt;            &lt;dbl&gt;
1  294.     0                  2.92              3.57             4.87
# … with 3 more variables: serum_LH_peak_day &lt;dbl&gt;,
#   serum_LH_surge_day &lt;dbl&gt;, peak_day &lt;dbl&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>ovulation_day_planned</span>, <span class='va'>ovulation_day_LH_serum</span>, <span class='va'>ovulation_day_LH_serum_peak</span>, <span class='va'>serum_LH_peak_day</span>, <span class='va'>peak_day</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span>use<span class='op'>=</span><span class='st'>'p'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>.</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>2</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                            ovulation_day_planned
ovulation_day_planned                        1.00
ovulation_day_LH_serum                       0.99
ovulation_day_LH_serum_peak                  0.99
serum_LH_peak_day                            0.99
peak_day                                     0.99
                            ovulation_day_LH_serum
ovulation_day_planned                         0.99
ovulation_day_LH_serum                        1.00
ovulation_day_LH_serum_peak                   1.00
serum_LH_peak_day                             1.00
peak_day                                      1.00
                            ovulation_day_LH_serum_peak
ovulation_day_planned                              0.99
ovulation_day_LH_serum                             1.00
ovulation_day_LH_serum_peak                        1.00
serum_LH_peak_day                                  1.00
peak_day                                           0.99
                            serum_LH_peak_day peak_day
ovulation_day_planned                    0.99     0.99
ovulation_day_LH_serum                   1.00     1.00
ovulation_day_LH_serum_peak              1.00     0.99
serum_LH_peak_day                        1.00     0.99
peak_day                                 0.99     1.00</code></pre>
</div>
<h2 id="anovulatory-cycles-vs.-rest">Anovulatory cycles vs. rest</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>anovulatory</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>summarise</span><span class='op'>(</span>mean_cl <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>cycle_length</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,
            min_cl <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>cycle_length</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,
            max_cl <span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>cycle_length</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,
            sd_cl <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>cycle_length</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,
            <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>ESTRGEN</span><span class='op'>)</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,
            <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>PROGEST</span><span class='op'>)</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
            <span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 2 × 7
  anovulatory mean_cl min_cl max_cl sd_cl `mean(log(ESTRGEN), na.rm =…
  &lt;lgl&gt;         &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;                        &lt;dbl&gt;
1 FALSE          28.8     13     44  3.51                         4.47
2 TRUE           31.2     19     58  9.05                         3.93
# … with 1 more variable: mean(log(PROGEST), na.rm = T) &lt;dbl&gt;</code></pre>
</div>
<h2 id="which-day-do-the-different-methods-get-as-the-day-of-ovulation">Which day do the different methods get as the day of ovulation?</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='co'>#filter(cycle == 1) %&gt;% </span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>cycle_start_day</span>, <span class='va'>ovulation_day_planned</span>, <span class='va'>ovulation_day_LH_serum</span>, <span class='va'>ovulation_day_LH_serum_peak</span>, <span class='va'>peak_day</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate_at</span><span class='op'>(</span><span class='fu'>vars</span><span class='op'>(</span><span class='va'>ovulation_day_planned</span>, <span class='va'>ovulation_day_LH_serum</span>, <span class='va'>ovulation_day_LH_serum_peak</span>, <span class='va'>peak_day</span><span class='op'>)</span>, <span class='op'>~</span> <span class='va'>.</span> <span class='op'>-</span> <span class='va'>cycle_start_day</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>cycle</span>, <span class='va'>ovulation_day_planned</span>, <span class='va'>ovulation_day_LH_serum</span>, <span class='va'>ovulation_day_LH_serum_peak</span>, ovulation_day_LH_urine <span class='op'>=</span> <span class='va'>peak_day</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>pivot_longer</span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ovulation_day_planned"</span>, <span class='st'>"ovulation_day_LH_serum"</span>, <span class='st'>"ovulation_day_LH_serum_peak"</span>, <span class='st'>"ovulation_day_LH_urine"</span><span class='op'>)</span>, names_to <span class='op'>=</span> <span class='st'>"method"</span>, values_to <span class='op'>=</span> <span class='st'>"day"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>method</span>, <span class='va'>cycle</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>summarise</span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>, sd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>left_join</span><span class='op'>(</span>
  
    <span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='co'>#filter(cycle == 1) %&gt;% </span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>cycle_end_day</span>, <span class='va'>ovulation_day_planned</span>, <span class='va'>ovulation_day_LH_serum</span>, <span class='va'>ovulation_day_LH_serum_peak</span>, <span class='va'>peak_day</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate_at</span><span class='op'>(</span><span class='fu'>vars</span><span class='op'>(</span><span class='va'>ovulation_day_planned</span>, <span class='va'>ovulation_day_LH_serum</span>, <span class='va'>ovulation_day_LH_serum_peak</span>, <span class='va'>peak_day</span><span class='op'>)</span>, <span class='op'>~</span> <span class='va'>.</span> <span class='op'>-</span> <span class='va'>cycle_end_day</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>cycle</span>, <span class='va'>ovulation_day_planned</span>, <span class='va'>ovulation_day_LH_serum</span>, <span class='va'>ovulation_day_LH_serum_peak</span>, ovulation_day_LH_urine <span class='op'>=</span> <span class='va'>peak_day</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>pivot_longer</span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ovulation_day_planned"</span>, <span class='st'>"ovulation_day_LH_serum"</span>, <span class='st'>"ovulation_day_LH_serum_peak"</span>, <span class='st'>"ovulation_day_LH_urine"</span><span class='op'>)</span>, names_to <span class='op'>=</span> <span class='st'>"method"</span>, values_to <span class='op'>=</span> <span class='st'>"day"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>method</span>, <span class='va'>cycle</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>summarise</span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>, sd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>,
  by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"method"</span>, <span class='st'>"cycle"</span><span class='op'>)</span>, suffix <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"_fc"</span>, <span class='st'>"_bc"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`summarise()` has grouped output by &#39;method&#39;. You can override using the `.groups` argument.
`summarise()` has grouped output by &#39;method&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code># A tibble: 8 × 6
# Groups:   method [4]
  method                      cycle mean_fc sd_fc mean_bc sd_bc
  &lt;chr&gt;                       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 ovulation_day_LH_serum          1    15.4  3.57   -13.5  2.47
2 ovulation_day_LH_serum          2    15.7  3.26   -13.3  2.34
3 ovulation_day_LH_serum_peak     1    16.0  4.87   -13.1  3.87
4 ovulation_day_LH_serum_peak     2    16.0  3.78   -12.9  2.69
5 ovulation_day_LH_urine          1    15.4  3.29   -13.2  2.92
6 ovulation_day_LH_urine          2    15.4  3.34   -13.4  2.96
7 ovulation_day_planned           1    15.8  2.96   -13.2  4.04
8 ovulation_day_planned           2    15.7  3.11   -13.1  3.28</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>DRLH</span>, <span class='va'>DRLH_serum_peak</span>, <span class='va'>DRLH_serum_surge</span><span class='op'>)</span>, use <span class='op'>=</span> <span class='st'>'p'</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                      DRLH DRLH_serum_peak DRLH_serum_surge
DRLH             1.0000000       0.9377206        0.9684680
DRLH_serum_peak  0.9377206       1.0000000        0.9979972
DRLH_serum_surge 0.9684680       0.9979972        1.0000000</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span> <span class='op'>=</span> <span class='va'>biocycle</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>
        RCD_std <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
          <span class='va'>visit</span> <span class='op'>==</span> <span class='st'>"M1"</span> <span class='op'>~</span> <span class='op'>-</span><span class='fl'>28</span>,
          <span class='va'>RCD</span> <span class='op'>&gt;</span> <span class='op'>-</span><span class='fl'>24</span> <span class='op'>~</span> <span class='va'>RCD</span>,
          <span class='op'>(</span><span class='va'>cycle_length</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>RCD</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='fl'>6</span> <span class='op'>~</span> <span class='op'>(</span><span class='va'>cycle_length</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>RCD</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='va'>cycle_length</span><span class='op'>*</span><span class='fl'>29</span> <span class='op'>-</span> <span class='fl'>29</span>
        <span class='op'>)</span>,
        RCD_squished <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span>
          <span class='va'>cycle_length</span> <span class='op'>-</span> <span class='va'>FCD</span> <span class='op'>&lt;</span> <span class='fl'>14</span>,
          <span class='fl'>29</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>cycle_length</span> <span class='op'>-</span> <span class='va'>FCD</span><span class='op'>)</span>,
          <span class='op'>(</span><span class='op'>(</span><span class='va'>FCD</span><span class='op'>/</span> <span class='op'>(</span><span class='va'>cycle_length</span> <span class='op'>-</span> <span class='fl'>14</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'>*</span> <span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span>,
        RCD_squished <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>RCD_squished</span> <span class='op'>&lt;</span> <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='va'>RCD_squished</span><span class='op'>)</span>,
        RCD_squished <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>RCD_squished</span> <span class='op'>&gt;</span> <span class='fl'>29</span>, <span class='fl'>29</span>, <span class='va'>RCD_squished</span><span class='op'>)</span>,
        RCD_squished <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>RCD</span> <span class='op'>&lt;</span> <span class='op'>-</span><span class='fl'>40</span>, <span class='cn'>NA_real_</span>, <span class='va'>RCD_squished</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>30</span>,
        RCD_squished <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>RCD_squished</span><span class='op'>)</span>
        <span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>RCD_squished</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
-29 -28 -27 -26 -25 -24 -23 -22 -21 -20 -19 -18 -17 -16 -15 -14 -13 
280 101  57  48  66  96 104 147  80 111 109 140 161 236 240 204 182 
-12 -11 -10  -9  -8  -7  -6  -5  -4  -3  -2  -1 
130 152 106 122 119 106 108 102 114  99  86  32 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>biocycle</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>RCD</span>, <span class='va'>RCD_std</span>, color <span class='op'>=</span> <span class='va'>cycle_length</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning: Removed 403 rows containing missing values (geom_point).</code></pre>
<img src="1_biocycle_import_files/figure-html5/unnamed-chunk-13-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>anov_cycles</span> <span class='op'>&lt;-</span> <span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>max_LH <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>LH</span>, na.rm<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span>, max_PROGEST <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>PROGEST</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>anovulatory</span>, <span class='va'>max_LH</span>, <span class='va'>max_PROGEST</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span> 
<span class='va'>anov_cycles</span> <span class='op'>%&gt;%</span> <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>anovulatory</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>.
FALSE  TRUE 
  466    43 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># View(anov_cycles)</span>
 

<span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>DRLH</span>, <span class='va'>biocycle</span><span class='op'>$</span><span class='va'>DRLH_planned</span>, use <span class='op'>=</span> <span class='st'>'pair'</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.9548818</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>ovulation_day_LH_serum</span>, exclude <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
   3    7   10   11   12   13   14   15   16   17   18   19   20   21 
   6    8    8   22   53   78   98  266  221  142  107   87   28   40 
  23   24   25   26   27   28   29   30   32   35   36   37   38   39 
   8   32    8    8    8   16    8    8   16    8   15   40   32   31 
  40   41   42   43   44   45   46   47   48   49   50   51   52   53 
  85   94   78  100  149  100   77   54   62   38   64   21   29   16 
  54   55   56   58   59   61   63   66   71   72   75   76   79   80 
  16   24    8    8   16    8    8    8   23   16   16   15    8    8 
  82   83   96   98  103  152  188 &lt;NA&gt; 
   8   16    7    8    8    8    8 1297 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>ovulation_day_planned</span>, exclude <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
  11   12   13   14   15   16   17   18   19   20   21   22   23   24 
  24   60   95  211  321  317  251  228  144   86   92   42   38   37 
  25   26   29   32   33   34   35   36   37   38   39   40   41   42 
  16    7    5    8    8    8   39   16   55   87   72   62  164   91 
  43   44   45   46   47   48   49   50   51   52   53   54   55   56 
  95  170  149  131   82   51   71   84   51   24    7   37   15   24 
  57   58   59   60   61   64   68   69   71   72   73   74   75   76 
  24   16   20   16    8    8    8    8   16    7   16   24    7    8 
  78   81   82   83   84   85   93   97  100  102  151  170  171  184 
   8    8   16    8    8    7    7    7    8    8    8    8    8    7 
 188 &lt;NA&gt; 
   8   26 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>FCD</span>, exclude <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
   0    1    2    3    4    5    6    7    8    9   10   11   12   13 
  46  280  106   54   36   74  142  143   96   93  110  162  160  223 
  14   15   16   17   18   19   20   21   22   23   24   25   26   27 
 234  210  195  177  168  126  140  139  123  126  126  101   77   71 
  28   29   30   31   32   33   34 &lt;NA&gt; 
  74   46   16    8   12    1    1   15 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>RCD</span>, exclude <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
 -57  -51  -48  -46  -44  -43  -42  -40  -39  -38  -37  -36  -35  -34 
   1    1    1    1    1    1    1    2    3    3    4    7    7    7 
 -33  -32  -31  -30  -29  -28  -27  -26  -25  -24  -23  -22  -21  -20 
  18   20   21   33   47   68   70   85   88   86   98  105  110  128 
 -19  -18  -17  -16  -15  -14  -13  -12  -11  -10   -9   -8   -7   -6 
  93   99  133  178  223  240  204  182  130  152  106  122  119  106 
  -5   -4   -3   -2   -1 &lt;NA&gt; 
 108  102  114   99  118  266 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>DRLH</span>, exclude <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
 -27  -23  -22  -21  -20  -19  -18  -17  -16  -15  -14  -13  -12  -11 
   1    1    1    9    6   10   10   18   21   31   44   47   73   52 
 -10   -9   -8   -7   -6   -5   -4   -3   -2   -1    0    1    2    3 
  57   83   76   75   77   76   74   80  114  119  282  262  127   56 
   4    5    6    7    8    9   10   11   12   13   14   15   16   17 
  66  116   86   62   77   98   74   62   71   59   48   19    1    1 
  18   19   20 &lt;NA&gt; 
   2    1    2 1184 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://testthat.r-lib.org'>testthat</a></span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Attaching package: &#39;testthat&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:dplyr&#39;:

    matches</code></pre>
<pre><code>The following object is masked from &#39;package:purrr&#39;:

    is_null</code></pre>
<pre><code>The following objects are masked from &#39;package:readr&#39;:

    edition_get, local_edition</code></pre>
<pre><code>The following object is masked from &#39;package:tidyr&#39;:

    matches</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://testthat.r-lib.org/reference/equality-expectations.html'>expect_equal</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>cycle_length</span>, <span class='va'>biocycle</span><span class='op'>$</span><span class='va'>cycle_length_mine</span><span class='op'>)</span>
<span class='co'># biocycle %&gt;%</span>
<span class='co'>#   select(id, cycle, cycle_length, cycle_length_mine, cycle_start_day, cycle_end_day, starts_with("mense")) %&gt;%</span>
<span class='co'>#   distinct() %&gt;%</span>
<span class='co'>#   mutate(equal = identical(cycle_length, cycle_length_mine)) %&gt;%</span>
<span class='co'>#   View()</span>
  
<span class='co'># biocycle %&gt;% </span>
<span class='co'>#   filter(round(cor(day, standardized_day),1) != 1) %&gt;% </span>
<span class='co'>#   select( cycle_length, cycle_length_mine, FCD, day, standardized_day) %&gt;% View()</span>
  <span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>FCD</span>, <span class='va'>RCD</span>, <span class='va'>day</span>, <span class='va'>standardized_day</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span>use <span class='op'>=</span> <span class='st'>'na.or.complete'</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                       FCD       RCD       day standardized_day
FCD              1.0000000 0.8679758 0.9408742        0.9594645
RCD              0.8679758 1.0000000 0.8734255        0.9561304
day              0.9408742 0.8734255 1.0000000        0.9387325
standardized_day 0.9594645 0.9561304 0.9387325        1.0000000</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>RCD</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
-57 -51 -48 -46 -44 -43 -42 -40 -39 -38 -37 -36 -35 -34 -33 -32 -31 
  1   1   1   1   1   1   1   2   3   3   4   7   7   7  18  20  21 
-30 -29 -28 -27 -26 -25 -24 -23 -22 -21 -20 -19 -18 -17 -16 -15 -14 
 33  47  68  70  85  88  86  98 105 110 128  93  99 133 178 223 240 
-13 -12 -11 -10  -9  -8  -7  -6  -5  -4  -3  -2  -1 
204 182 130 152 106 122 119 106 108 102 114  99 118 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>progesterone_pgml</span> <span class='op'>&lt;-</span> <span class='va'>biocycle</span><span class='op'>$</span><span class='va'>PROGEST</span> <span class='op'>*</span> <span class='fl'>1000</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>biocycle</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>between</span><span class='op'>(</span><span class='va'>cycle_length</span>, <span class='fl'>20</span>, <span class='fl'>35</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
         <span class='fu'>mutate</span><span class='op'>(</span>logP <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>progesterone_pgml</span><span class='op'>)</span>,
                logP <span class='op'>=</span> <span class='va'>logP</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>logP</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>RCD</span>, <span class='va'>logP</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 136 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 136 rows containing missing values (geom_point).</code></pre>
<p><img src="1_biocycle_import_files/figure-html5/unnamed-chunk-15-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>qplot</span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>BMI</span>, <span class='va'>biocycle</span><span class='op'>$</span><span class='va'>ESTRGEN</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 10 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 10 rows containing missing values (geom_point).</code></pre>
<img src="1_biocycle_import_files/figure-html5/unnamed-chunk-16-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>qplot</span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>BMI</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>ESTRGEN</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 10 rows containing non-finite values (stat_smooth).

Warning: Removed 10 rows containing missing values (geom_point).</code></pre>
<img src="1_biocycle_import_files/figure-html5/unnamed-chunk-16-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>qplot</span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>BMI</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>`Free E2 (pg/mL)`</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 10 rows containing non-finite values (stat_smooth).

Warning: Removed 10 rows containing missing values (geom_point).</code></pre>
<img src="1_biocycle_import_files/figure-html5/unnamed-chunk-16-3.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>qplot</span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>BMI</span>, <span class='va'>biocycle</span><span class='op'>$</span><span class='va'>SHBG</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 14 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 14 rows containing missing values (geom_point).</code></pre>
<img src="1_biocycle_import_files/figure-html5/unnamed-chunk-16-4.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>qplot</span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>BMI</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>SHBG</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>'lm'</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>Warning: Removed 14 rows containing non-finite values (stat_smooth).

Warning: Removed 14 rows containing missing values (geom_point).</code></pre>
<img src="1_biocycle_import_files/figure-html5/unnamed-chunk-16-5.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>BMI</span>, <span class='va'>biocycle</span><span class='op'>$</span><span class='va'>SHBG</span>, use <span class='op'>=</span> <span class='st'>'p'</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -0.2530885</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>BMI</span>, <span class='va'>biocycle</span><span class='op'>$</span><span class='va'>ESTRGEN</span>, use <span class='op'>=</span> <span class='st'>'p'</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.01439422</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>BMI</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>SHBG</span><span class='op'>)</span>, use <span class='op'>=</span> <span class='st'>'p'</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -0.2840897</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>BMI</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>ESTRGEN</span><span class='op'>)</span>, use <span class='op'>=</span> <span class='st'>'p'</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.02615477</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>BMI</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>biocycle</span><span class='op'>$</span><span class='va'>`Free E2 (pg/mL)`</span><span class='op'>)</span>, use <span class='op'>=</span> <span class='st'>'p'</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.09856212</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>biocycle</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>DRLH</span>, <span class='va'>Testo</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 1209 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 1209 rows containing missing values (geom_point).</code></pre>
<p><img src="1_biocycle_import_files/figure-html5/unnamed-chunk-17-1.png" width="624" /></p>
</div>
<h2 id="iccs">ICCs</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m_icc_shbg</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='va'>SHBG</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>:</span><span class='va'>cycle</span><span class='op'>)</span>, <span class='va'>biocycle</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: SHBG ~ (1 | id) + (1 | id:cycle)
   Data: biocycle

REML criterion at convergence: 27870.7

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-7.4453 -0.4394 -0.0443  0.3909  7.9405 

Random effects:
 Groups   Name        Variance Std.Dev.
 id:cycle (Intercept)  31.92    5.650  
 id       (Intercept) 421.29   20.525  
 Residual              48.05    6.932  
Number of obs: 3897, groups:  id:cycle, 509; id, 259

Fixed effects:
            Estimate Std. Error t value
(Intercept)   48.017      1.305    36.8</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='va'>m_icc_shbg</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.904
  Conditional ICC: 0.904</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m_icc_shbg</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='va'>SHBG</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span>, <span class='va'>biocycle</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: SHBG ~ (1 | id)
   Data: biocycle

REML criterion at convergence: 28516.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-6.7745 -0.4662 -0.0291  0.4308  7.4114 

Random effects:
 Groups   Name        Variance Std.Dev.
 id       (Intercept) 437.14   20.908  
 Residual              64.94    8.059  
Number of obs: 3897, groups:  id, 259

Fixed effects:
            Estimate Std. Error t value
(Intercept)   48.000      1.306   36.76</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='va'>m_icc_shbg</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.871
  Conditional ICC: 0.871</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m_icc_shbg</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>SHBG</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>:</span><span class='va'>cycle</span><span class='op'>)</span>, <span class='va'>biocycle</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: log(SHBG) ~ (1 | id) + (1 | id:cycle)
   Data: biocycle

REML criterion at convergence: -1539.8

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-18.6023  -0.4144  -0.0014   0.4386   7.9681 

Random effects:
 Groups   Name        Variance Std.Dev.
 id:cycle (Intercept) 0.01231  0.1110  
 id       (Intercept) 0.20222  0.4497  
 Residual             0.02597  0.1612  
Number of obs: 3897, groups:  id:cycle, 509; id, 259

Fixed effects:
            Estimate Std. Error t value
(Intercept)   3.7612     0.0285     132</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='va'>m_icc_shbg</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.892
  Conditional ICC: 0.892</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m_icc_shbg</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>SHBG</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span>, <span class='va'>biocycle</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: log(SHBG) ~ (1 | id)
   Data: biocycle

REML criterion at convergence: -1119.7

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-17.6054  -0.4558   0.0197   0.5068   7.4464 

Random effects:
 Groups   Name        Variance Std.Dev.
 id       (Intercept) 0.20866  0.4568  
 Residual             0.03237  0.1799  
Number of obs: 3897, groups:  id, 259

Fixed effects:
            Estimate Std. Error t value
(Intercept)  3.76071    0.02853   131.8</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='va'>m_icc_shbg</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.866
  Conditional ICC: 0.866</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m_icc_albumin</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='va'>ALBUMN</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>:</span><span class='va'>cycle</span><span class='op'>)</span>, <span class='va'>biocycle</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: ALBUMN ~ (1 | id) + (1 | id:cycle)
   Data: biocycle

REML criterion at convergence: -1427.9

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-13.0807  -0.5178   0.0032   0.5734   5.0175 

Random effects:
 Groups   Name        Variance Std.Dev.
 id:cycle (Intercept) 0.001961 0.04428 
 id       (Intercept) 0.037483 0.19361 
 Residual             0.032603 0.18056 
Number of obs: 3905, groups:  id:cycle, 509; id, 259

Fixed effects:
            Estimate Std. Error t value
(Intercept)  4.00657    0.01254   319.6</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='va'>m_icc_albumin</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.547
  Conditional ICC: 0.547</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m_icc_albumin</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>ALBUMN</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>:</span><span class='va'>cycle</span><span class='op'>)</span>, <span class='va'>biocycle</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: log(ALBUMN) ~ (1 | id) + (1 | id:cycle)
   Data: biocycle

REML criterion at convergence: -11198.7

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-16.2692  -0.4332   0.0251   0.5142   3.8131 

Random effects:
 Groups   Name        Variance  Std.Dev.
 id:cycle (Intercept) 0.0001303 0.01141 
 id       (Intercept) 0.0024149 0.04914 
 Residual             0.0027236 0.05219 
Number of obs: 3905, groups:  id:cycle, 509; id, 259

Fixed effects:
            Estimate Std. Error t value
(Intercept) 1.385453   0.003209   431.8</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='va'>m_icc_albumin</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.483
  Conditional ICC: 0.483</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m_icc_testosterone</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>Testo</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>:</span><span class='va'>cycle</span><span class='op'>)</span>, <span class='va'>biocycle</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: log(Testo) ~ (1 | id) + (1 | id:cycle)
   Data: biocycle

REML criterion at convergence: 610.1

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-6.8759 -0.5998  0.0379  0.6089  5.0127 

Random effects:
 Groups   Name        Variance  Std.Dev.
 id:cycle (Intercept) 0.0009976 0.03159 
 id       (Intercept) 0.1166329 0.34152 
 Residual             0.0536865 0.23170 
Number of obs: 3868, groups:  id:cycle, 509; id, 259

Fixed effects:
            Estimate Std. Error t value
(Intercept)   3.3248     0.0216   153.9</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='va'>m_icc_testosterone</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.687
  Conditional ICC: 0.687</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m_icc_estrogen</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>ESTRGEN</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>:</span><span class='va'>cycle</span><span class='op'>)</span>, <span class='va'>biocycle</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>boundary (singular) fit: see ?isSingular</code></pre>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: log(ESTRGEN) ~ (1 | id) + (1 | id:cycle)
   Data: biocycle

REML criterion at convergence: 8810.4

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.38910 -0.75631 -0.02573  0.72852  2.77817 

Random effects:
 Groups   Name        Variance Std.Dev.
 id:cycle (Intercept) 0.00000  0.0000  
 id       (Intercept) 0.08007  0.2830  
 Residual             0.51669  0.7188  
Number of obs: 3901, groups:  id:cycle, 509; id, 259

Fixed effects:
            Estimate Std. Error t value
(Intercept)  4.42334    0.02105   210.1
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='va'>m_icc_estrogen</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning: Can&#39;t compute random effect variances. Some variance components equal
  zero. Your model may suffer from singulariy.
  Solution: Respecify random structure! You may also decrease the
  &#39;tolerance&#39; level to enforce the calculation of random effect
  variances.</code></pre>
<pre><code>[1] NA</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m_icc_estrogen</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>ESTRGEN</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span>, <span class='va'>biocycle</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: log(ESTRGEN) ~ (1 | id)
   Data: biocycle

REML criterion at convergence: 8810.4

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.38910 -0.75631 -0.02573  0.72852  2.77817 

Random effects:
 Groups   Name        Variance Std.Dev.
 id       (Intercept) 0.08007  0.2830  
 Residual             0.51669  0.7188  
Number of obs: 3901, groups:  id, 259

Fixed effects:
            Estimate Std. Error t value
(Intercept)  4.42334    0.02105   210.1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='va'>m_icc_estrogen</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.134
  Conditional ICC: 0.134</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m_icc_free_estrogen</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>`Free E2 (pg/mL)`</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>:</span><span class='va'>cycle</span><span class='op'>)</span>, <span class='va'>biocycle</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>boundary (singular) fit: see ?isSingular</code></pre>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: log(`Free E2 (pg/mL)`) ~ (1 | id) + (1 | id:cycle)
   Data: biocycle

REML criterion at convergence: 9573.5

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.55055 -0.75679 -0.05221  0.71244  2.84074 

Random effects:
 Groups   Name        Variance Std.Dev.
 id:cycle (Intercept) 0.00000  0.0000  
 id       (Intercept) 0.07071  0.2659  
 Residual             0.63761  0.7985  
Number of obs: 3901, groups:  id:cycle, 509; id, 259

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.39927    0.02093   19.07
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='va'>m_icc_free_estrogen</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning: Can&#39;t compute random effect variances. Some variance components equal
  zero. Your model may suffer from singulariy.
  Solution: Respecify random structure! You may also decrease the
  &#39;tolerance&#39; level to enforce the calculation of random effect
  variances.</code></pre>
<pre><code>[1] NA</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m_icc_free_estrogen</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>`Free E2 (pg/mL)`</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span>, <span class='va'>biocycle</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: log(`Free E2 (pg/mL)`) ~ (1 | id)
   Data: biocycle

REML criterion at convergence: 9573.5

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.55055 -0.75679 -0.05221  0.71244  2.84074 

Random effects:
 Groups   Name        Variance Std.Dev.
 id       (Intercept) 0.07071  0.2659  
 Residual             0.63761  0.7985  
Number of obs: 3901, groups:  id, 259

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.39927    0.02093   19.07</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='va'>m_icc_free_estrogen</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.100
  Conditional ICC: 0.100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m_icc_progesterone</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>PROGEST</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>:</span><span class='va'>cycle</span><span class='op'>)</span>, <span class='va'>biocycle</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>boundary (singular) fit: see ?isSingular</code></pre>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: log(PROGEST) ~ (1 | id) + (1 | id:cycle)
   Data: biocycle

REML criterion at convergence: 12742

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.8359 -0.7934 -0.2625  0.9315  2.3031 

Random effects:
 Groups   Name        Variance Std.Dev.
 id:cycle (Intercept) 0.00000  0.0000  
 id       (Intercept) 0.08892  0.2982  
 Residual             1.67532  1.2943  
Number of obs: 3754, groups:  id:cycle, 509; id, 259

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.40437    0.02818   14.35
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='va'>m_icc_progesterone</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning: Can&#39;t compute random effect variances. Some variance components equal
  zero. Your model may suffer from singulariy.
  Solution: Respecify random structure! You may also decrease the
  &#39;tolerance&#39; level to enforce the calculation of random effect
  variances.</code></pre>
<pre><code>[1] NA</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m_icc_progesterone</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>PROGEST</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span>, <span class='va'>biocycle</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: log(PROGEST) ~ (1 | id)
   Data: biocycle

REML criterion at convergence: 12742

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.8359 -0.7934 -0.2625  0.9315  2.3031 

Random effects:
 Groups   Name        Variance Std.Dev.
 id       (Intercept) 0.08892  0.2982  
 Residual             1.67532  1.2943  
Number of obs: 3754, groups:  id, 259

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.40437    0.02818   14.35</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='va'>m_icc_progesterone</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.050
  Conditional ICC: 0.050</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m_icc_free_testosterone</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>`Free T (ng/dL)`</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>:</span><span class='va'>cycle</span><span class='op'>)</span>, <span class='va'>biocycle</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: log(`Free T (ng/dL)`) ~ (1 | id) + (1 | id:cycle)
   Data: biocycle

REML criterion at convergence: 1738.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.0466 -0.6006  0.0136  0.6075  5.6082 

Random effects:
 Groups   Name        Variance Std.Dev.
 id:cycle (Intercept) 0.004727 0.06875 
 id       (Intercept) 0.150647 0.38813 
 Residual             0.070413 0.26535 
Number of obs: 3906, groups:  id:cycle, 509; id, 259

Fixed effects:
            Estimate Std. Error t value
(Intercept) -0.86582    0.02469  -35.07</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='va'>m_icc_free_testosterone</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.688
  Conditional ICC: 0.688</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m_icc_free_testosterone</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>`Free T (ng/dL)`</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span>, <span class='va'>biocycle</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: log(`Free T (ng/dL)`) ~ (1 | id)
   Data: biocycle

REML criterion at convergence: 1761

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.1953 -0.6037  0.0185  0.6140  5.4585 

Random effects:
 Groups   Name        Variance Std.Dev.
 id       (Intercept) 0.15307  0.3912  
 Residual             0.07289  0.2700  
Number of obs: 3906, groups:  id, 259

Fixed effects:
            Estimate Std. Error t value
(Intercept)  -0.8655     0.0247  -35.04</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='va'>m_icc_free_testosterone</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.677
  Conditional ICC: 0.677</code></pre>
</div>
<h2 id="save-data">Save data</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle_stdnames</span> <span class='op'>&lt;-</span> <span class='va'>biocycle</span> <span class='op'>%&gt;%</span>
  <span class='fu'>rename</span><span class='op'>(</span>
  estradiol <span class='op'>=</span> <span class='va'>`Free E2 (pg/mL)`</span>,
  total_estradiol <span class='op'>=</span> <span class='va'>ESTRGEN</span>,
  estradiol_cens <span class='op'>=</span> <span class='va'>ESTRGEN_cens</span>,
  progesterone <span class='op'>=</span> <span class='va'>progesterone_pgml</span>, 
  progesterone_cens <span class='op'>=</span> <span class='va'>PROGEST_cens</span>,
  bc_day <span class='op'>=</span> <span class='va'>RCD</span>, 
  fc_day <span class='op'>=</span> <span class='va'>FCD</span>, 
  lh_day <span class='op'>=</span> <span class='va'>DRLH</span>,
  age <span class='op'>=</span> <span class='va'>screenage</span>,
  partner <span class='op'>=</span> <span class='va'>married</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>biocycle_stdnames</span><span class='op'>$</span><span class='va'>bc_day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -57  -1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>biocycle_stdnames</span><span class='op'>$</span><span class='va'>fc_day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  0 34</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>biocycle_stdnames</span><span class='op'>$</span><span class='va'>lh_day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -27  20</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>biocycle_stdnames</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>cycle_length</span><span class='op'>)</span> <span class='op'>|</span> <span class='fu'>between</span><span class='op'>(</span><span class='va'>cycle_length</span>, <span class='fl'>25</span>, <span class='fl'>35</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>$</span><span class='va'>bc_day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>$</span><span class='va'>fc_day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>$</span><span class='va'>lh_day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
<pre><code>[1] -34  -1
[1]  0 32
[1] -23  20</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>write_rds</span><span class='op'>(</span><span class='va'>biocycle_stdnames</span>, <span class='st'>"biocycle.rds"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="sourceCode" id="cb143"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
