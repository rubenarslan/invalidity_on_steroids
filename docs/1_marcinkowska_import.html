<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Salivary and serum immunoassay comparison: Untitled</title>




  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Salivary and serum immunoassay comparison: Untitled"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Salivary and serum immunoassay comparison"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Salivary and serum immunoassay comparison: Untitled"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{},"value":[]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
  <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Untitled","authors":[]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>1_marcinkowska_import.knit</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>


<div class="d-article">
<h2 id="import">Import</h2>
<h3 id="hormones">Hormones</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m_e2</span> <span class='op'>&lt;-</span> <span class='fu'>rio</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rio/man/import.html'>import</a></span><span class='op'>(</span><span class='st'>"data/marcinkowska/manual_clean/estradiolALL.xlsx"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>tibble</span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 88</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m_e2</span> <span class='op'>&lt;-</span> <span class='va'>m_e2</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Notes</span><span class='op'>)</span> <span class='op'>|</span> <span class='va'>Notes</span> <span class='op'>!=</span> <span class='st'>"control"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed one row (&lt;1%), 1,534 rows remaining</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>e2_dfs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span><span class='st'>"data/marcinkowska/manual_clean/"</span>, pattern <span class='op'>=</span> <span class='st'>"estradiol "</span>, full.names <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>map</span><span class='op'>(</span><span class='fu'>rio</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/rio/man/import.html'>import</a></span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>map</span><span class='op'>(</span><span class='va'>tibble</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>New names:
* `` -&gt; ...3
* `` -&gt; ...4
* `` -&gt; ...5</code></pre>
<pre><code>New names:
* `` -&gt; ...3
* `` -&gt; ...4
* `` -&gt; ...5
* `` -&gt; ...6
* `` -&gt; ...7
* ...</code></pre>
<pre><code>New names:
* `` -&gt; ...6
* `` -&gt; ...7
New names:
* `` -&gt; ...6
* `` -&gt; ...7</code></pre>
<pre><code>New names:
* `` -&gt; ...6
* `` -&gt; ...7
* `` -&gt; ...8</code></pre>
<pre><code>New names:
* `` -&gt; ...8
* `` -&gt; ...9
* `` -&gt; ...10
* `` -&gt; ...11
* `` -&gt; ...12
* ...</code></pre>
<pre><code>New names:
* `` -&gt; ...6
* `` -&gt; ...7
* `` -&gt; ...10
* `` -&gt; ...11
* `` -&gt; ...12
* ...</code></pre>
<pre><code>New names:
* `` -&gt; ...3
* `` -&gt; ...4
* `` -&gt; ...5
* `` -&gt; ...8</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>e2_dfs</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span><span class='st'>"data/marcinkowska/manual_clean/"</span>, pattern <span class='op'>=</span> <span class='st'>"estradiol "</span><span class='op'>)</span>
<span class='va'>m_e2_2</span> <span class='op'>&lt;-</span> <span class='va'>e2_dfs</span> <span class='op'>%&gt;%</span> <span class='fu'>map</span><span class='op'>(</span><span class='va'>.</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>data</span>, <span class='va'>`pg/ml`</span>, <span class='va'>Meetings</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>bind_rows</span><span class='op'>(</span>.id <span class='op'>=</span> <span class='st'>"batch"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: dropped 6 variables (...3, ...4, ...5, Ovul, Forward, …)</code></pre>
<pre><code>select: dropped 6 variables (...3, ...4, ...5, ...6, ...7, …)</code></pre>
<pre><code>select: dropped 5 variables (I pomiar, II pomiar, średnia, ...6, ...7)
select: dropped 5 variables (I pomiar, II pomiar, średnia, ...6, ...7)</code></pre>
<pre><code>select: dropped 6 variables (I pomiar, II pomiar, średnia, ...6, ...7, …)</code></pre>
<pre><code>select: dropped 3 variables (I pomiar, II pomiar, średnia)</code></pre>
<pre><code>select: dropped 9 variables (I pomiar, II pomiar, średnia, ...8, ...9, …)</code></pre>
<pre><code>select: dropped 12 variables (I pomiar, II pomiar, średnia, ...6, ...7, …)</code></pre>
<pre><code>select: dropped 4 variables (...3, ...4, ...5, ...8)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>m_e2_2</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 72</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p4_dfs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span><span class='st'>"data/marcinkowska/manual_clean/"</span>, pattern <span class='op'>=</span> <span class='st'>"progesteron"</span>, full.names <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>map</span><span class='op'>(</span><span class='fu'>rio</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/rio/man/import.html'>import</a></span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>map</span><span class='op'>(</span><span class='va'>tibble</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>New names:
* `` -&gt; ...3
* `` -&gt; ...4
* `` -&gt; ...5
* `` -&gt; ...8
* `` -&gt; ...9
* ...</code></pre>
<pre><code>New names:
* `` -&gt; ...3
* `` -&gt; ...4
* `` -&gt; ...5
* `` -&gt; ...8</code></pre>
<pre><code>New names:
* `` -&gt; ...6</code></pre>
<pre><code>New names:
* `` -&gt; ...8
* `` -&gt; ...9
* `` -&gt; ...10
* `` -&gt; ...11
* `` -&gt; ...12
* ...</code></pre>
<pre><code>New names:
* `` -&gt; ...8
New names:
* `` -&gt; ...8</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>p4_dfs</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span><span class='st'>"data/marcinkowska/manual_clean/"</span>, pattern <span class='op'>=</span> <span class='st'>"progesteron"</span><span class='op'>)</span>
<span class='va'>m_p4</span> <span class='op'>&lt;-</span> <span class='va'>p4_dfs</span> <span class='op'>%&gt;%</span> <span class='fu'>map</span><span class='op'>(</span><span class='va'>.</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>data</span>, <span class='va'>`pg/ml`</span>, <span class='va'>Meetings</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>bind_rows</span><span class='op'>(</span>.id <span class='op'>=</span> <span class='st'>"batch"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: dropped 10 variables (...3, ...4, ...5, ...8, ...9, …)</code></pre>
<pre><code>select: dropped 4 variables (...3, ...4, ...5, ...8)</code></pre>
<pre><code>select: dropped 3 variables (I pomiar, II pomiar, średnia)</code></pre>
<pre><code>select: dropped 4 variables (I pomiar, II pomiar, średnia, ...6)</code></pre>
<pre><code>select: dropped 3 variables (I pomiar, II pomiar, średnia)</code></pre>
<pre><code>select: dropped 10 variables (I pomiar, II pomiar, średnia, ...8, ...9, …)</code></pre>
<pre><code>select: dropped 4 variables (I pomiar, II pomiar, średnia, ...8)
select: dropped 4 variables (I pomiar, II pomiar, średnia, ...8)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m_p4</span> <span class='op'>&lt;-</span> <span class='va'>m_p4</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>data</span>, <span class='st'>"brak"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>data</span>, <span class='st'>"BRAK"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>date <span class='op'>=</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='https://lubridate.tidyverse.org/reference/ymd.html'>dmy</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed 95 rows (9%), 914 rows remaining</code></pre>
<pre><code>filter: removed 23 rows (3%), 891 rows remaining</code></pre>
<pre><code>Warning: 39 failed to parse.</code></pre>
<pre><code>mutate: new variable &#39;date&#39; (Date) with 184 unique values and 4% NA</code></pre>
<pre><code>filter: removed 39 rows (4%), 852 rows remaining</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m_e2</span> <span class='op'>&lt;-</span> <span class='va'>m_e2</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>date <span class='op'>=</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='https://lubridate.tidyverse.org/reference/ymd.html'>dmy</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning: 5 failed to parse.</code></pre>
<pre><code>mutate: new variable &#39;date&#39; (Date) with 288 unique values and &lt;1% NA</code></pre>
<pre><code>filter: removed 6 rows (&lt;1%), 1,528 rows remaining</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m_e2_2</span> <span class='op'>&lt;-</span> <span class='va'>m_e2_2</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>data</span>, <span class='st'>"brak"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>data</span>, <span class='st'>"BRAK"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>date <span class='op'>=</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='https://lubridate.tidyverse.org/reference/ymd.html'>dmy</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed 124 rows (9%), 1,188 rows remaining</code></pre>
<pre><code>filter: removed 26 rows (2%), 1,162 rows remaining</code></pre>
<pre><code>mutate: new variable &#39;date&#39; (Date) with 260 unique values and 0% NA</code></pre>
<pre><code>filter: no rows removed</code></pre>
</div>
<h3 id="dates-in-right-order">Dates in right order?</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m_e2_2</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>date_o <span class='op'>=</span> <span class='va'>date</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>!=</span> <span class='va'>date_o</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>date</span>, <span class='va'>date_o</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>nrow</span>
</code></pre>
</div>
<pre><code>group_by: one grouping variable (ID)</code></pre>
<pre><code>mutate (grouped): new variable &#39;date_o&#39; (Date) with 260 unique values and 0% NA</code></pre>
<pre><code>filter (grouped): removed all rows (100%)</code></pre>
<pre><code>select: dropped 4 variables (batch, data, pg/ml, Meetings)</code></pre>
<pre><code>[1] 0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m_p4</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>date_o <span class='op'>=</span> <span class='va'>date</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>!=</span> <span class='va'>date_o</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>date</span>, <span class='va'>date_o</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>nrow</span>
</code></pre>
</div>
<pre><code>group_by: one grouping variable (ID)</code></pre>
<pre><code>mutate (grouped): new variable &#39;date_o&#39; (Date) with 183 unique values and 0% NA</code></pre>
<pre><code>filter (grouped): removed all rows (100%)</code></pre>
<pre><code>select: dropped 4 variables (batch, data, pg/ml, Meetings)</code></pre>
<pre><code>[1] 0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m_e2</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>date_o <span class='op'>=</span> <span class='va'>date</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>!=</span> <span class='va'>date_o</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>date</span>, <span class='va'>date_o</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>nrow</span>
</code></pre>
</div>
<pre><code>group_by: one grouping variable (ID)</code></pre>
<pre><code>mutate (grouped): new variable &#39;date_o&#39; (Date) with 287 unique values and 0% NA</code></pre>
<pre><code>filter (grouped): removed all rows (100%)</code></pre>
<pre><code>select: dropped 13 variables (data, Pom1, Pom2, Avrg, St.Dev., …)</code></pre>
<pre><code>[1] 0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m_e2</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>date</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>group_by: 2 grouping variables (ID, date)</code></pre>
<pre><code>filter (grouped): removed all rows (100%)</code></pre>
<pre><code># A tibble: 0 × 15
# Groups:   ID, date [0]
# … with 15 variables: ID &lt;chr&gt;, data &lt;chr&gt;, Pom1 &lt;chr&gt;, Pom2 &lt;dbl&gt;,
#   Avrg &lt;dbl&gt;, St.Dev. &lt;dbl&gt;, %CV &lt;dbl&gt;, pg/ml &lt;dbl&gt;,
#   Meetings &lt;chr&gt;, Ovul &lt;chr&gt;, For &lt;dbl&gt;, Back &lt;dbl&gt;, Batch &lt;dbl&gt;,
#   Notes &lt;chr&gt;, date &lt;date&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m_e2_2</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>date</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>group_by: 2 grouping variables (ID, date)
filter (grouped): removed all rows (100%)</code></pre>
<pre><code># A tibble: 0 × 6
# Groups:   ID, date [0]
# … with 6 variables: batch &lt;chr&gt;, ID &lt;chr&gt;, data &lt;chr&gt;, pg/ml &lt;dbl&gt;,
#   Meetings &lt;chr&gt;, date &lt;date&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m_p4</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>date</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>group_by: 2 grouping variables (ID, date)
filter (grouped): removed all rows (100%)</code></pre>
<pre><code># A tibble: 0 × 6
# Groups:   ID, date [0]
# … with 6 variables: batch &lt;chr&gt;, ID &lt;chr&gt;, data &lt;chr&gt;, pg/ml &lt;dbl&gt;,
#   Meetings &lt;chr&gt;, date &lt;date&gt;</code></pre>
</div>
<h3 id="checks">Checks</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># cor/rank order avrg pg/ml</span>
<span class='fu'><a href='https://rdrr.io/r/stats/cor.test.html'>cor.test</a></span><span class='op'>(</span><span class='va'>m_e2</span><span class='op'>$</span><span class='va'>Avrg</span>, <span class='va'>m_e2</span><span class='op'>$</span><span class='va'>`pg/ml`</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
    Pearson&#39;s product-moment correlation

data:  m_e2$Avrg and m_e2$`pg/ml`
t = -51.995, df = 1451, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.8239282 -0.7879440
sample estimates:
       cor 
-0.8066825 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.test.html'>cor.test</a></span><span class='op'>(</span><span class='va'>m_e2</span><span class='op'>$</span><span class='va'>Avrg</span>, <span class='va'>m_e2</span><span class='op'>$</span><span class='va'>`pg/ml`</span>, method <span class='op'>=</span> <span class='st'>"s"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning in cor.test.default(m_e2$Avrg, m_e2$`pg/ml`, method = &quot;s&quot;):
Cannot compute exact p-value with ties</code></pre>
<pre><code>
    Spearman&#39;s rank correlation rho

data:  m_e2$Avrg and m_e2$`pg/ml`
S = 910006639, p-value &lt; 2.2e-16
alternative hypothesis: true rho is not equal to 0
sample estimates:
       rho 
-0.7799146 </code></pre>
</div>
<h3 id="collect-ids">Collect IDs</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 88</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>m_p4</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 57</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>m_e2_2</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 71</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>all_ids</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>union</a></span><span class='op'>(</span><span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>union</a></span><span class='op'>(</span><span class='va'>m_e2_2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_p4</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='fu'>str_sub</span><span class='op'>(</span><span class='va'>all_ids</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
 K  P 
41 61 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='fu'>str_sub</span><span class='op'>(</span><span class='va'>all_ids</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
   01    02    03    04    05    06    07    08    09    10    11 
    1     1     1     1     1     1     1     1     1     1     1 
 1196  1198  1199    12  1200  1201  1202  1205  1207  1208  1210 
    1     1     1     1     1     1     1     1     1     1     1 
 1211  1212  1215  1217  1218  1220  1221  1222  1223  1224  1225 
    1     1     1     1     1     1     1     1     1     1     1 
 1229  1230  1231  1232  1234  1236  1237  1238  1241  1243  1245 
    1     1     1     1     1     1     1     1     1     1     1 
   13    14    15    16    17    18    19    20    21    22    23 
    1     1     1     1     1     1     1     1     1     1     1 
   24    25    26    27    28    29    30    31    32    33    35 
    1     1     1     1     1     1     1     1     1     1     1 
   36    37    38    39    40    41    42    43    44    45    46 
    1     1     1     1     1     1     1     1     1     1     1 
   47    48    49    50    51    52    53    54    55    56    57 
    1     1     1     1     1     1     1     1     1     1     1 
   58    59    60    61    62    63    65    66    67    68    69 
    1     1     1     1     1     1     1     1     1     1     1 
   70    71    72 
    1     1     1 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>union</a></span><span class='op'>(</span><span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>union</a></span><span class='op'>(</span><span class='va'>m_e2_2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_p4</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 102</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>union</a></span><span class='op'>(</span><span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_e2_2</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 102</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>union</a></span><span class='op'>(</span><span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_p4</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 102</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>union</a></span><span class='op'>(</span><span class='va'>m_e2_2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_p4</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 71</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>intersect</a></span><span class='op'>(</span><span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_p4</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;P 02&quot; &quot;P 07&quot; &quot;P 27&quot; &quot;P 45&quot; &quot;P 46&quot; &quot;P 47&quot; &quot;P 53&quot; &quot;P 03&quot; &quot;P 25&quot;
[10] &quot;P 30&quot; &quot;P 32&quot; &quot;P 35&quot; &quot;P 37&quot; &quot;P 38&quot; &quot;P 48&quot; &quot;K 21&quot; &quot;K 31&quot; &quot;K 36&quot;
[19] &quot;K 39&quot; &quot;K 42&quot; &quot;K 51&quot; &quot;K 52&quot; &quot;K 58&quot; &quot;K 66&quot; &quot;K 04&quot; &quot;K 09&quot; &quot;K 16&quot;
[28] &quot;K 23&quot; &quot;K 26&quot; &quot;K 50&quot; &quot;K 57&quot; &quot;K 13&quot; &quot;K 49&quot; &quot;K 54&quot; &quot;K 55&quot; &quot;K 63&quot;
[37] &quot;K 65&quot; &quot;K 43&quot; &quot;K 44&quot; &quot;K 59&quot; &quot;K 60&quot; &quot;K 61&quot; &quot;K 62&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_p4</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;P 28&quot;   &quot;K 11&quot;   &quot;K 14&quot;   &quot;K 15&quot;   &quot;K 17&quot;   &quot;K 40&quot;   &quot;K 41&quot;  
 [8] &quot;K 56&quot;   &quot;K 67&quot;   &quot;K 68&quot;   &quot;K 69&quot;   &quot;K 70&quot;   &quot;K 71&quot;   &quot;K 72&quot;  
[15] &quot;P 1196&quot; &quot;P 1199&quot; &quot;P 1200&quot; &quot;P 1208&quot; &quot;P 1220&quot; &quot;P 1225&quot; &quot;P 1201&quot;
[22] &quot;P 1229&quot; &quot;P 1222&quot; &quot;P 1198&quot; &quot;P 1237&quot; &quot;P 1238&quot; &quot;P 1245&quot; &quot;P 1205&quot;
[29] &quot;P 1210&quot; &quot;P 1231&quot; &quot;P 1236&quot; &quot;P 1230&quot; &quot;P 1212&quot; &quot;P 1211&quot; &quot;P 1207&quot;
[36] &quot;P 1232&quot; &quot;P 1217&quot; &quot;P 1218&quot; &quot;P 1223&quot; &quot;P 1215&quot; &quot;P 1234&quot; &quot;P 1241&quot;
[43] &quot;P 1243&quot; &quot;P 1224&quot; &quot;P 1221&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='va'>m_p4</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;P 08&quot;   &quot;P 19&quot;   &quot;P 18&quot;   &quot;P 22&quot;   &quot;P 12&quot;   &quot;P 10&quot;   &quot;P 33&quot;  
 [8] &quot;P 1202&quot; &quot;P 01&quot;   &quot;P 05&quot;   &quot;P 06&quot;   &quot;P 20&quot;   &quot;P 24&quot;   &quot;P 29&quot;  </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>intersect</a></span><span class='op'>(</span><span class='va'>m_e2_2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_p4</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;P 27&quot;   &quot;P 07&quot;   &quot;P 46&quot;   &quot;P 47&quot;   &quot;P 45&quot;   &quot;P 53&quot;   &quot;P 02&quot;  
 [8] &quot;P 37&quot;   &quot;P 32&quot;   &quot;P 03&quot;   &quot;P 48&quot;   &quot;P 25&quot;   &quot;P 30&quot;   &quot;P 35&quot;  
[15] &quot;P 38&quot;   &quot;K 04&quot;   &quot;K 21&quot;   &quot;K 31&quot;   &quot;K 36&quot;   &quot;K 39&quot;   &quot;K 42&quot;  
[22] &quot;K 51&quot;   &quot;K 52&quot;   &quot;K 58&quot;   &quot;K 66&quot;   &quot;K 09&quot;   &quot;K 16&quot;   &quot;K 23&quot;  
[29] &quot;K 26&quot;   &quot;K 50&quot;   &quot;K 57&quot;   &quot;K 13&quot;   &quot;K 63&quot;   &quot;K 65&quot;   &quot;K 54&quot;  
[36] &quot;K 55&quot;   &quot;K 49&quot;   &quot;K 59&quot;   &quot;K 60&quot;   &quot;K 61&quot;   &quot;K 44&quot;   &quot;K 43&quot;  
[43] &quot;K 62&quot;   &quot;P 08&quot;   &quot;P 19&quot;   &quot;P 18&quot;   &quot;P 22&quot;   &quot;P 12&quot;   &quot;P 10&quot;  
[50] &quot;P 33&quot;   &quot;P 1202&quot; &quot;P 01&quot;   &quot;P 05&quot;   &quot;P 06&quot;   &quot;P 20&quot;   &quot;P 24&quot;  
[57] &quot;P 29&quot;  </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='va'>m_e2_2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_p4</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;P 28&quot; &quot;K 11&quot; &quot;K 14&quot; &quot;K 15&quot; &quot;K 17&quot; &quot;K 40&quot; &quot;K 41&quot; &quot;K 56&quot; &quot;K 67&quot;
[10] &quot;K 68&quot; &quot;K 69&quot; &quot;K 70&quot; &quot;K 71&quot; &quot;K 72&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='va'>m_p4</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_e2_2</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>character(0)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>intersect</a></span><span class='op'>(</span><span class='va'>m_e2_2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;P 27&quot; &quot;P 07&quot; &quot;P 46&quot; &quot;P 47&quot; &quot;P 45&quot; &quot;P 53&quot; &quot;P 02&quot; &quot;P 28&quot; &quot;P 37&quot;
[10] &quot;P 32&quot; &quot;P 03&quot; &quot;P 48&quot; &quot;P 25&quot; &quot;P 30&quot; &quot;P 35&quot; &quot;P 38&quot; &quot;K 04&quot; &quot;K 21&quot;
[19] &quot;K 31&quot; &quot;K 36&quot; &quot;K 39&quot; &quot;K 42&quot; &quot;K 51&quot; &quot;K 52&quot; &quot;K 58&quot; &quot;K 66&quot; &quot;K 09&quot;
[28] &quot;K 16&quot; &quot;K 23&quot; &quot;K 26&quot; &quot;K 50&quot; &quot;K 57&quot; &quot;K 11&quot; &quot;K 14&quot; &quot;K 15&quot; &quot;K 17&quot;
[37] &quot;K 40&quot; &quot;K 41&quot; &quot;K 56&quot; &quot;K 67&quot; &quot;K 68&quot; &quot;K 69&quot; &quot;K 70&quot; &quot;K 71&quot; &quot;K 72&quot;
[46] &quot;K 13&quot; &quot;K 63&quot; &quot;K 65&quot; &quot;K 54&quot; &quot;K 55&quot; &quot;K 49&quot; &quot;K 59&quot; &quot;K 60&quot; &quot;K 61&quot;
[55] &quot;K 44&quot; &quot;K 43&quot; &quot;K 62&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='va'>m_e2_2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;P 08&quot;   &quot;P 19&quot;   &quot;P 18&quot;   &quot;P 22&quot;   &quot;P 12&quot;   &quot;P 10&quot;   &quot;P 33&quot;  
 [8] &quot;P 1202&quot; &quot;P 01&quot;   &quot;P 05&quot;   &quot;P 06&quot;   &quot;P 20&quot;   &quot;P 24&quot;   &quot;P 29&quot;  </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_e2_2</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;P 1196&quot; &quot;P 1199&quot; &quot;P 1200&quot; &quot;P 1208&quot; &quot;P 1220&quot; &quot;P 1225&quot; &quot;P 1201&quot;
 [8] &quot;P 1229&quot; &quot;P 1222&quot; &quot;P 1198&quot; &quot;P 1237&quot; &quot;P 1238&quot; &quot;P 1245&quot; &quot;P 1205&quot;
[15] &quot;P 1210&quot; &quot;P 1231&quot; &quot;P 1236&quot; &quot;P 1230&quot; &quot;P 1212&quot; &quot;P 1211&quot; &quot;P 1207&quot;
[22] &quot;P 1232&quot; &quot;P 1217&quot; &quot;P 1218&quot; &quot;P 1223&quot; &quot;P 1215&quot; &quot;P 1234&quot; &quot;P 1241&quot;
[29] &quot;P 1243&quot; &quot;P 1224&quot; &quot;P 1221&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='va'>m_p4</span><span class='op'>$</span><span class='va'>ID</span>, <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>union</a></span><span class='op'>(</span><span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_e2_2</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>character(0)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>union</a></span><span class='op'>(</span><span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_e2_2</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>, <span class='va'>m_p4</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;P 28&quot;   &quot;K 11&quot;   &quot;K 14&quot;   &quot;K 15&quot;   &quot;K 17&quot;   &quot;K 40&quot;   &quot;K 41&quot;  
 [8] &quot;K 56&quot;   &quot;K 67&quot;   &quot;K 68&quot;   &quot;K 69&quot;   &quot;K 70&quot;   &quot;K 71&quot;   &quot;K 72&quot;  
[15] &quot;P 1196&quot; &quot;P 1199&quot; &quot;P 1200&quot; &quot;P 1208&quot; &quot;P 1220&quot; &quot;P 1225&quot; &quot;P 1201&quot;
[22] &quot;P 1229&quot; &quot;P 1222&quot; &quot;P 1198&quot; &quot;P 1237&quot; &quot;P 1238&quot; &quot;P 1245&quot; &quot;P 1205&quot;
[29] &quot;P 1210&quot; &quot;P 1231&quot; &quot;P 1236&quot; &quot;P 1230&quot; &quot;P 1212&quot; &quot;P 1211&quot; &quot;P 1207&quot;
[36] &quot;P 1232&quot; &quot;P 1217&quot; &quot;P 1218&quot; &quot;P 1223&quot; &quot;P 1215&quot; &quot;P 1234&quot; &quot;P 1241&quot;
[43] &quot;P 1243&quot; &quot;P 1224&quot; &quot;P 1221&quot;</code></pre>
</div>
<h3 id="bind-e2-files">Bind E2 files</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m_e2</span> <span class='op'>&lt;-</span> <span class='fu'>bind_rows</span><span class='op'>(</span><span class='va'>m_e2</span>, <span class='va'>m_e2_2</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/anti_join.html'>anti_join</a></span><span class='op'>(</span><span class='va'>m_e2</span>, by <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>data</span>, <span class='va'>`pg/ml`</span>, <span class='va'>Meetings</span>, <span class='va'>date</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>anti_join: added no columns</code></pre>
<pre><code>           &gt; rows only in x   235</code></pre>
<pre><code>           &gt; rows only in y  (571)</code></pre>
<pre><code>           &gt; matched rows    (927)</code></pre>
<pre><code>           &gt;                 =====</code></pre>
<pre><code>           &gt; rows total       235</code></pre>
<pre><code>select: dropped one variable (batch)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 102</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>m_e2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 1763</code></pre>
</div>
<h3 id="merge-e2p4">Merge E2/P4</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>marc</span> <span class='op'>&lt;-</span> <span class='va'>m_e2</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/rename.html'>rename</a></span><span class='op'>(</span>estradiol <span class='op'>=</span> <span class='va'>`pg/ml`</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/full_join.html'>full_join</a></span><span class='op'>(</span><span class='va'>m_p4</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/rename.html'>rename</a></span><span class='op'>(</span>progesterone <span class='op'>=</span> <span class='va'>`pg/ml`</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ID"</span>, <span class='st'>"date"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>rename: renamed one variable (estradiol)</code></pre>
<pre><code>rename: renamed one variable (progesterone)</code></pre>
<pre><code>full_join: added 6 columns (data.x, Meetings.x, batch, data.y, progesterone, …)</code></pre>
<pre><code>           &gt; rows only in x   1,210</code></pre>
<pre><code>           &gt; rows only in y     299</code></pre>
<pre><code>           &gt; matched rows       553</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       2,062</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>marc</span><span class='op'>$</span><span class='va'>estradiol</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.03596557</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>marc</span><span class='op'>$</span><span class='va'>progesterone</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.1465</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.test.html'>cor.test</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>marc</span><span class='op'>$</span><span class='va'>estradiol</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>marc</span><span class='op'>$</span><span class='va'>progesterone</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
    Pearson&#39;s product-moment correlation

data:  log(marc$estradiol) and log(marc$progesterone)
t = 7.0441, df = 541, p-value = 5.698e-12
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.2108485 0.3650899
sample estimates:
      cor 
0.2898501 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/xtabs.html'>xtabs</a></span><span class='op'>(</span><span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>estradiol</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>progesterone</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span>, <span class='va'>marc</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>, , is.na(date) = FALSE

                is.na(progesterone)
is.na(estradiol) FALSE TRUE
           FALSE   543 1137
           TRUE    288   94</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># m_p4 %&gt;% filter(is.na(date)) %&gt;% select(ID, data) %&gt;% View</span>


<span class='va'>marc</span> <span class='op'>&lt;-</span> <span class='va'>marc</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>estradiol_cens <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>estradiol</span> <span class='op'>&lt;=</span> <span class='fl'>0.4</span>, <span class='st'>"left"</span>, <span class='st'>"none"</span><span class='op'>)</span>,
    estradiol <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>estradiol_cens</span> <span class='op'>==</span> <span class='st'>"left"</span>, <span class='fl'>0.4</span>, <span class='va'>estradiol</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>
    progesterone_cens <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>progesterone</span> <span class='op'>&lt;=</span> <span class='fl'>2.5</span>, <span class='st'>"left"</span>, <span class='st'>"none"</span><span class='op'>)</span>,
    progesterone <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>progesterone_cens</span> <span class='op'>==</span> <span class='st'>"left"</span>, <span class='fl'>2.5</span>, <span class='va'>progesterone</span><span class='op'>)</span>
  <span class='op'>)</span>
</code></pre>
</div>
<pre><code>mutate: changed 10 values (&lt;1%) of &#39;estradiol&#39; (0 new NA)</code></pre>
<pre><code>        new variable &#39;estradiol_cens&#39; (character) with 3 unique values and 19% NA</code></pre>
<pre><code>mutate: changed 10 values (&lt;1%) of &#39;progesterone&#39; (0 new NA)</code></pre>
<pre><code>        new variable &#39;progesterone_cens&#39; (character) with 3 unique values and 60% NA</code></pre>
</div>
<h3 id="calendar">Calendar</h3>
<p>The legend for colours: First blue is the follicular days. Grey is when they started doing LH tests. Green/blue is the luteal phase. If the hour is written in the cell, it means the meeting took place then. Pink is when they report a positive result of the LH test, pink hour is on the date that the peri-ovulatory meeting took place. Yellow is a peri-ovulatory meeting, but in a cycle that was potentially anovulatory - participants did not report positive results of the LH test. Red is the first day of the next menses.</p>
<p>A032: red # bg_colors[23] AF05: pink # bg_colors[44] AD19: pink # bg_colors[61] DS51: pink # EL66: pink # bg_colors[90]</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>## STRATEGY A</span>
<span class='va'>mensdates_orig</span> <span class='op'>&lt;-</span> <span class='fu'>rio</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rio/man/import.html'>import</a></span><span class='op'>(</span><span class='st'>"data/marcinkowska/manual_clean/Calendar.xlsx"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/slice.html'>slice</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>102</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/rename.html'>rename</a></span><span class='op'>(</span>cycle_length <span class='op'>=</span> <span class='va'>`Cycle length`</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>LH_peak <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='va'>`LH+When`</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"--"</span>, <span class='st'>"-"</span><span class='op'>)</span> <span class='op'>~</span> <span class='cn'>NA_real_</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>`LH+When`</span><span class='op'>)</span><span class='op'>)</span>,
    cycle_length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>cycle_length</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AG2 / R2C33: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AW2 / R2C49: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in BB2 / R2C54: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in S3 / R3C19: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AE3 / R3C31: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AV4 / R4C48: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in V5 / R5C22: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AG5 / R5C33: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AZ6 / R6C52: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in BP6 / R6C68: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AZ7 / R7C52: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AG8 / R8C33: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AW8 / R8C49: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in W9 / R9C23: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AT9 / R9C46: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AA10 / R10C27: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AK10 / R10C37: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AX10 / R10C50: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AE11 / R11C31: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AL11 / R11C38: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AV11 / R11C48: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AV12 / R12C48: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in BB12 / R12C54: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in V13 / R13C22: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AN13 / R13C40: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AS13 / R13C45: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AA14 / R14C27: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AX14 / R14C50: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AU15 / R15C47: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in BI15 / R15C61: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in BP15 / R15C68: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AW16 / R16C49: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in Z17 / R17C26: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AR17 / R17C44: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AK18 / R18C37: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AW18 / R18C49: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in V19 / R19C22: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AD19 / R19C30: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in Z20 / R20C26: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AR20 / R20C44: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AZ20 / R20C52: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in T21 / R21C20: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AE21 / R21C31: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in BD22 / R22C56: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in BL22 / R22C64: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AN23 / R23C40: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AX23 / R23C50: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AU24 / R24C47: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AM25 / R25C39: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AR25 / R25C44: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in BB25 / R25C54: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AZ26 / R26C52: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AW27 / R27C49: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in BC27 / R27C55: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in BL27 / R27C64: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AV28 / R28C48: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in Z29 / R29C26: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AV29 / R29C48: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AS30 / R30C45: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in BD30 / R30C56: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in T31 / R31C20: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in S32 / R32C19: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AA32 / R32C27: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AN33 / R33C40: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in AZ33 / R33C52: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DD34 / R34C108: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DL34 / R34C116: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EO35 / R35C145: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EW35 / R35C153: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EH36 / R36C138: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DT37 / R37C124: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EH37 / R37C138: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EL37 / R37C142: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DN38 / R38C118: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DX38 / R38C128: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EH38 / R38C138: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DB39 / R39C106: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DW39 / R39C127: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in ED39 / R39C134: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DF40 / R40C110: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DI41 / R41C113: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DU41 / R41C125: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EB41 / R41C132: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DT42 / R42C124: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EB42 / R42C132: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DU43 / R43C125: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in GN44 / R44C196: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HD44 / R44C212: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DP45 / R45C120: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EL45 / R45C142: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DT46 / R46C124: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EH46 / R46C138: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EO46 / R46C145: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DP47 / R47C120: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EL47 / R47C142: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HR50 / R50C226: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DI51 / R51C113: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DT51 / R51C124: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DN52 / R52C118: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EK53 / R53C141: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EW53 / R53C153: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DN54 / R54C118: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EB54 / R54C132: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EH55 / R55C138: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EH56 / R56C138: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EC57 / R57C133: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in DT58 / R58C124: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EL58 / R58C142: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EK59 / R59C141: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EO60 / R60C145: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EH61 / R61C138: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EL62 / R62C142: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EZ62 / R62C156: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EL63 / R63C142: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EH65 / R65C138: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EO66 / R66C145: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EW66 / R66C153: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EY68 / R68C155: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EO69 / R69C145: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EZ70 / R70C156: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in FT70 / R70C176: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in GA71 / R71C183: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in FO74 / R74C171: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in FU74 / R74C177: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EO75 / R75C145: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EY76 / R76C155: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in FU76 / R76C177: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in FM77 / R77C169: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in FX77 / R77C180: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in GE77 / R77C187: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in FL78 / R78C168: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in FQ79 / R79C173: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in EY80 / R80C155: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in FT80 / R80C176: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in FO81 / R81C171: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in GE81 / R81C187: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in GL81 / R81C194: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in FX82 / R82C180: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in GA83 / R83C183: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in GV84 / R84C204: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HD84 / R84C212: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HN84 / R84C222: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in FX85 / R85C180: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HD86 / R86C212: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HR86 / R86C226: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in GE87 / R87C187: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HG87 / R87C215: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in IL88 / R88C246: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in GM89 / R89C195: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HH89 / R89C216: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in GL90 / R90C194: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HI90 / R90C217: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HV91 / R91C230: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HR93 / R93C226: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HN94 / R94C222: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HU94 / R94C229: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HQ95 / R95C225: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HU96 / R96C229: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in IL96 / R96C246: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HG97 / R97C215: got a date</code></pre>
<pre><code>Warning in read_fun(path = enc2native(normalizePath(path)), sheet_i =
sheet, : Expecting numeric in HU97 / R97C229: got a date</code></pre>
<pre><code>New names:
* `` -&gt; ...11
* `` -&gt; ...12</code></pre>
<pre><code>slice: removed 6 rows (6%), 102 rows remaining</code></pre>
<pre><code>rename: renamed one variable (cycle_length)</code></pre>
<pre><code>Warning in eval_tidy(pair$rhs, env = default_env): NAs introduced by
coercion</code></pre>
<pre><code>mutate: converted &#39;cycle_length&#39; from character to double (0 new NA)</code></pre>
<pre><code>        new variable &#39;LH_peak&#39; (double) with 12 unique values and 34% NA</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>mensdates_orig</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 102</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>intersect</a></span><span class='op'>(</span><span class='va'>mensdates_orig</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>character(0)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='va'>mensdates_orig</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  [1] &quot;1196&quot; &quot;1198&quot; &quot;1199&quot; &quot;1200&quot; &quot;1201&quot; &quot;1202&quot; &quot;1205&quot; &quot;1207&quot; &quot;1208&quot;
 [10] &quot;1210&quot; &quot;1211&quot; &quot;1212&quot; &quot;1215&quot; &quot;1217&quot; &quot;1218&quot; &quot;1220&quot; &quot;1221&quot; &quot;1222&quot;
 [19] &quot;1223&quot; &quot;1224&quot; &quot;1225&quot; &quot;1229&quot; &quot;1230&quot; &quot;1231&quot; &quot;1232&quot; &quot;1234&quot; &quot;1236&quot;
 [28] &quot;1237&quot; &quot;1238&quot; &quot;1241&quot; &quot;1243&quot; &quot;1245&quot; &quot;K01&quot;  &quot;K02&quot;  &quot;K03&quot;  &quot;K04&quot; 
 [37] &quot;K05&quot;  &quot;K06&quot;  &quot;K07&quot;  &quot;K08&quot;  &quot;K09&quot;  &quot;K10&quot;  &quot;K11&quot;  &quot;K12&quot;  &quot;K13&quot; 
 [46] &quot;K14&quot;  &quot;K15&quot;  &quot;K16&quot;  &quot;K17&quot;  &quot;K18&quot;  &quot;K19&quot;  &quot;K20&quot;  &quot;K21&quot;  &quot;K22&quot; 
 [55] &quot;K23&quot;  &quot;K24&quot;  &quot;K25&quot;  &quot;K26&quot;  &quot;K27&quot;  &quot;K28&quot;  &quot;K29&quot;  &quot;K30&quot;  &quot;K31&quot; 
 [64] &quot;K32&quot;  &quot;K33&quot;  &quot;K35&quot;  &quot;K36&quot;  &quot;K37&quot;  &quot;K38&quot;  &quot;K39&quot;  &quot;K40&quot;  &quot;K41&quot; 
 [73] &quot;K42&quot;  &quot;K43&quot;  &quot;K44&quot;  &quot;K45&quot;  &quot;K46&quot;  &quot;K47&quot;  &quot;K48&quot;  &quot;K49&quot;  &quot;K50&quot; 
 [82] &quot;K51&quot;  &quot;K52&quot;  &quot;K53&quot;  &quot;K54&quot;  &quot;K55&quot;  &quot;K56&quot;  &quot;k57&quot;  &quot;K58&quot;  &quot;K59&quot; 
 [91] &quot;K60&quot;  &quot;K61&quot;  &quot;K62&quot;  &quot;K63&quot;  &quot;K65&quot;  &quot;K66&quot;  &quot;K67&quot;  &quot;K68&quot;  &quot;K69&quot; 
[100] &quot;K70&quot;  &quot;K71&quot;  &quot;K72&quot; </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='va'>m_e2</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>mensdates_orig</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  [1] &quot;P 02&quot;   &quot;P 07&quot;   &quot;P 27&quot;   &quot;P 45&quot;   &quot;P 46&quot;   &quot;P 47&quot;   &quot;P 53&quot;  
  [8] &quot;P 03&quot;   &quot;P 25&quot;   &quot;P 28&quot;   &quot;P 30&quot;   &quot;P 32&quot;   &quot;P 35&quot;   &quot;P 37&quot;  
 [15] &quot;P 38&quot;   &quot;P 48&quot;   &quot;K 21&quot;   &quot;K 31&quot;   &quot;K 36&quot;   &quot;K 39&quot;   &quot;K 42&quot;  
 [22] &quot;K 51&quot;   &quot;K 52&quot;   &quot;K 58&quot;   &quot;K 66&quot;   &quot;K 04&quot;   &quot;K 09&quot;   &quot;K 16&quot;  
 [29] &quot;K 23&quot;   &quot;K 26&quot;   &quot;K 50&quot;   &quot;K 57&quot;   &quot;K 11&quot;   &quot;K 14&quot;   &quot;K 15&quot;  
 [36] &quot;K 17&quot;   &quot;K 40&quot;   &quot;K 41&quot;   &quot;K 56&quot;   &quot;K 67&quot;   &quot;K 68&quot;   &quot;K 69&quot;  
 [43] &quot;K 70&quot;   &quot;K 71&quot;   &quot;K 72&quot;   &quot;K 13&quot;   &quot;K 49&quot;   &quot;K 54&quot;   &quot;K 55&quot;  
 [50] &quot;K 63&quot;   &quot;K 65&quot;   &quot;K 43&quot;   &quot;K 44&quot;   &quot;K 59&quot;   &quot;K 60&quot;   &quot;K 61&quot;  
 [57] &quot;K 62&quot;   &quot;P 1196&quot; &quot;P 1199&quot; &quot;P 1200&quot; &quot;P 1208&quot; &quot;P 1220&quot; &quot;P 1225&quot;
 [64] &quot;P 1201&quot; &quot;P 1229&quot; &quot;P 1222&quot; &quot;P 1198&quot; &quot;P 1237&quot; &quot;P 1238&quot; &quot;P 1245&quot;
 [71] &quot;P 1205&quot; &quot;P 1210&quot; &quot;P 1231&quot; &quot;P 1236&quot; &quot;P 1230&quot; &quot;P 1212&quot; &quot;P 1211&quot;
 [78] &quot;P 1207&quot; &quot;P 1232&quot; &quot;P 1217&quot; &quot;P 1218&quot; &quot;P 1223&quot; &quot;P 1215&quot; &quot;P 1234&quot;
 [85] &quot;P 1241&quot; &quot;P 1243&quot; &quot;P 1224&quot; &quot;P 1221&quot; &quot;P 08&quot;   &quot;P 19&quot;   &quot;P 18&quot;  
 [92] &quot;P 22&quot;   &quot;P 12&quot;   &quot;P 10&quot;   &quot;P 33&quot;   &quot;P 1202&quot; &quot;P 01&quot;   &quot;P 05&quot;  
 [99] &quot;P 06&quot;   &quot;P 20&quot;   &quot;P 24&quot;   &quot;P 29&quot;  </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mensdates</span> <span class='op'>&lt;-</span> <span class='va'>mensdates_orig</span> <span class='op'>%&gt;%</span>   
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>LH_peak</span>, <span class='va'>cycle_length</span>, <span class='va'>`42185`</span><span class='op'>:</span><span class='va'>`42424`</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate_all.html'>mutate_all</a></span><span class='op'>(</span><span class='va'>as.character</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>LH_peak</span>, <span class='va'>cycle_length</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>date <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>name</span><span class='op'>)</span>, origin <span class='op'>=</span> <span class='st'>"1899-12-30"</span><span class='op'>)</span>,
         cycle_length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>cycle_length</span><span class='op'>)</span>,
         LH_peak <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>LH_peak</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>row_number</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/ungroup.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>last_menstrual_onset <span class='op'>=</span> <span class='va'>date</span>,
         next_menstrual_onset <span class='op'>=</span> <span class='va'>date</span> <span class='op'>+</span> <span class='va'>cycle_length</span>,
         lh_surge_date <span class='op'>=</span> <span class='va'>date</span> <span class='op'>+</span> <span class='va'>cycle_length</span> <span class='op'>+</span> <span class='va'>LH_peak</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>name</span>, <span class='op'>-</span><span class='va'>value</span>, <span class='op'>-</span><span class='va'>date</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: dropped 10 variables (E2Peak, E2PeakWhen, LH+, LH+When, LH+weak, …)</code></pre>
<pre><code>mutate_all: converted &#39;LH_peak&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;cycle_length&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42185&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42186&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42187&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42188&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42189&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42190&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42191&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42192&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42193&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42194&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42195&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42196&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42197&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42198&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42199&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42201&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42202&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42203&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42205&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42209&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42210&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42211&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42212&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42216&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42217&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42218&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42219&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42220&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42221&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42222&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42223&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42224&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42225&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42226&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42227&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42228&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42231&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42232&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42233&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42235&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42236&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42237&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42238&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42239&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42240&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42241&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42242&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42243&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42244&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42245&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42246&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42247&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42248&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42249&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42250&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42251&#39; from logical to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42252&#39; from logical to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42253&#39; from logical to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42254&#39; from logical to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42255&#39; from logical to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42256&#39; from logical to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42257&#39; from logical to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42258&#39; from logical to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42259&#39; from logical to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42260&#39; from logical to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42261&#39; from logical to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42262&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42263&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42264&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42265&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42266&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42267&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42268&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42269&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42270&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42271&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42272&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42273&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42278&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42279&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42280&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42281&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42282&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42283&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42284&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42285&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42286&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42287&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42288&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42289&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42290&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42291&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42292&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42294&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42295&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42296&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42297&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42298&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42299&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42300&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42304&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42305&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42306&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42309&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42310&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42312&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42313&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42314&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42317&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42319&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42322&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42323&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42324&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42325&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42327&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42328&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42329&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42335&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42336&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42339&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42340&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42341&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42343&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42345&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42347&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42348&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42349&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42350&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42351&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42352&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42354&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42355&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42356&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42357&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42358&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42359&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42360&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42361&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42362&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42364&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42365&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42366&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42367&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42368&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42370&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42371&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42372&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42373&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42374&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42375&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42376&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42377&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42382&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42383&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42384&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42385&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42386&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42387&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42388&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42389&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42391&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42392&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42393&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42394&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42396&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42397&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42398&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42399&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42400&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42401&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42402&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42403&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42404&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42411&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42412&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42413&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42415&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42416&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42417&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42418&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42419&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42420&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42421&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42422&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42423&#39; from double to character (0 new NA)</code></pre>
<pre><code>            converted &#39;42424&#39; from double to character (0 new NA)</code></pre>
<pre><code>pivot_longer: reorganized (42185, 42186, 42187, 42188, 42189, …) into (name, value) [was 102x243, now 24480x5]</code></pre>
<pre><code>mutate: converted &#39;LH_peak&#39; from character to double (0 new NA)</code></pre>
<pre><code>        converted &#39;cycle_length&#39; from character to double (0 new NA)</code></pre>
<pre><code>        new variable &#39;date&#39; (Date) with 240 unique values and 0% NA</code></pre>
<pre><code>filter: removed 24,356 rows (99%), 124 rows remaining</code></pre>
<pre><code>group_by: one grouping variable (ID)</code></pre>
<pre><code>filter (grouped): removed 32 rows (26%), 92 rows remaining</code></pre>
<pre><code>ungroup: no grouping variables</code></pre>
<pre><code>mutate: new variable &#39;last_menstrual_onset&#39; (Date) with 68 unique values and 0% NA</code></pre>
<pre><code>        new variable &#39;next_menstrual_onset&#39; (Date) with 76 unique values and 0% NA</code></pre>
<pre><code>        new variable &#39;lh_surge_date&#39; (Date) with 49 unique values and 34% NA</code></pre>
<pre><code>select: dropped 3 variables (name, value, date)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>mensdates</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 92</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>mensdates</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 92</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mensdates</span> <span class='op'>&lt;-</span> <span class='va'>mensdates_orig</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>cycle_length</span>, <span class='va'>LH_peak</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/full_join.html'>full_join</a></span><span class='op'>(</span><span class='va'>mensdates</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: dropped 250 variables (E2Peak, E2PeakWhen, LH+, LH+When, LH+weak, …)</code></pre>
<pre><code>Joining, by = c(&quot;ID&quot;, &quot;cycle_length&quot;, &quot;LH_peak&quot;)</code></pre>
<pre><code>full_join: added 3 columns (last_menstrual_onset, next_menstrual_onset, lh_surge_date)</code></pre>
<pre><code>           &gt; rows only in x    10</code></pre>
<pre><code>           &gt; rows only in y     0</code></pre>
<pre><code>           &gt; matched rows      92</code></pre>
<pre><code>           &gt;                 =====</code></pre>
<pre><code>           &gt; rows total       102</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>mensdates</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 102</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>mensdates</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 102</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>rio</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rio/man/export.html'>export</a></span><span class='op'>(</span><span class='va'>mensdates</span>, <span class='st'>"data/marcinkowska/manual_clean/Calendar_dates.xlsx"</span><span class='op'>)</span>

<span class='co'># ## STRATEGY B (abandoned)</span>
<span class='co'># library(tidyxl)</span>
<span class='co'># formats &lt;- xlsx_formats("data/marcinkowska/manual_clean/Calendar.xlsx")</span>
<span class='co'># bg_colors &lt;- formats$local$fill$patternFill$bgColor$rgb</span>
<span class='co'># bg_colors[23]</span>
<span class='co'># table(bg_colors)</span>
<span class='co'># bg_colors &lt;- tibble(local_format_id = 1:length(bg_colors), color = bg_colors) %&gt;% drop_na()</span>
<span class='co'># showCols &lt;- function(cl=colors(), bg = "grey",</span>
<span class='co'>#                      cex = 0.75, rot = 30) {</span>
<span class='co'>#     m &lt;- ceiling(sqrt(n &lt;-length(cl)))</span>
<span class='co'>#     length(cl) &lt;- m*m; cm &lt;- matrix(cl, m)</span>
<span class='co'>#     require("grid")</span>
<span class='co'>#     grid.newpage(); vp &lt;- viewport(w = .92, h = .92)</span>
<span class='co'>#     grid.rect(gp=gpar(fill=bg))</span>
<span class='co'>#     grid.text(cm, x = col(cm)/m, y = rev(row(cm))/m, rot = rot,</span>
<span class='co'>#               vp=vp, gp=gpar(cex = cex, col = cm))</span>
<span class='co'># }</span>
<span class='co'># showCols(bg="gray20",cl=bg_colors$color %&gt;% unique() %&gt;% str_sub(3) %&gt;% str_c("#", .), rot=0, cex=1.9)</span>
<span class='co'># </span>
<span class='co'># bg_colors %&gt;% drop_na() %&gt;% mutate(id = factor(local_format_id)) %&gt;% ggplot(aes(id, 1, color = paste0("#", color))) + geom_point()</span>
<span class='co'># </span>
<span class='co'># dates &lt;- xlsx_cells("data/marcinkowska/manual_clean/Calendar.xlsx") %&gt;% </span>
<span class='co'>#   left_join(bg_colors)</span>
<span class='co'># date_in_study &lt;- dates %&gt;% filter(row == 1, !is.na(date)) %&gt;% select(col, part_date = date)</span>
<span class='co'># ids &lt;- dates %&gt;% filter(col == 1) %&gt;% mutate(ID = coalesce(character, as.character(round(numeric))), row) %&gt;% select(ID, row) %&gt;% slice(2:103)</span>
<span class='co'># </span>
<span class='co'># date_colors &lt;- dates %&gt;% select(row, col, color) %&gt;% </span>
<span class='co'>#   left_join(date_in_study, by = "col") %&gt;% </span>
<span class='co'>#   left_join(ids, by = "row")</span>
<span class='co'># # drop_na(date_colors) %&gt;% View</span>
<span class='co'>#   </span>
<span class='co'># </span>
<span class='co'># dates %&gt;% filter(color == "FFFF00FF") %&gt;% pull(numeric) %&gt;% table(exclude = NULL)</span>
<span class='co'># dates %&gt;% filter(color == "FFFF00FF") %&gt;% pull(date) %&gt;% table(exclude = NULL)</span>
</code></pre>
</div>
</div>
<h2 id="merge">Merge</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mensdates</span> <span class='op'>&lt;-</span> <span class='va'>mensdates</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'>str_match</span><span class='op'>(</span><span class='va'>ID</span>, <span class='st'>"(\\d+)"</span><span class='op'>)</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>mutate: converted &#39;ID&#39; from character to double (0 new NA)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>marc</span> <span class='op'>&lt;-</span> <span class='va'>marc</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>
    KP <span class='op'>=</span> <span class='fu'>str_sub</span><span class='op'>(</span><span class='va'>ID</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,
    ID <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'>str_match</span><span class='op'>(</span><span class='va'>ID</span>, <span class='st'>"(\\d+)"</span><span class='op'>)</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>mutate: converted &#39;ID&#39; from character to double (0 new NA)</code></pre>
<pre><code>        new variable &#39;KP&#39; (character) with 2 unique values and 0% NA</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>intersect</a></span><span class='op'>(</span><span class='va'>mensdates</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>marc</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 102</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='va'>mensdates</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>marc</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>numeric(0)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='va'>marc</span><span class='op'>$</span><span class='va'>ID</span>, <span class='va'>mensdates</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>numeric(0)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mensdates</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>lh_surge_date</span> <span class='op'>&gt;</span> <span class='va'>next_menstrual_onset</span> <span class='op'>|</span>
                       <span class='va'>lh_surge_date</span> <span class='op'>&lt;</span> <span class='va'>last_menstrual_onset</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>lh_surge_date</span>, <span class='va'>next_menstrual_onset</span>, <span class='va'>last_menstrual_onset</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed all rows (100%)</code></pre>
<pre><code>select: dropped 2 variables (cycle_length, LH_peak)</code></pre>
<pre><code>[1] ID                   lh_surge_date        next_menstrual_onset
[4] last_menstrual_onset
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mensdates</span> <span class='op'>&lt;-</span> <span class='va'>mensdates</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>last_menstrual_onset</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>cycle <span class='op'>=</span> <span class='fu'>row_number</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>group_by: one grouping variable (ID)</code></pre>
<pre><code>mutate (grouped): new variable &#39;cycle&#39; (integer) with one unique value and 0% NA</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>mensdates</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 102</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>mensdates</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 102</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cycles</span> <span class='op'>&lt;-</span> <span class='va'>mensdates</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>cycle</span>, <span class='va'>cycle_length</span>, <span class='va'>LH_peak</span>, <span class='va'>last_menstrual_onset</span>,
                               <span class='va'>next_menstrual_onset</span>, <span class='va'>lh_surge_date</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: columns reordered (ID, cycle, cycle_length, LH_peak, last_menstrual_onset, …)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>merge_date_on_cycle</span> <span class='op'>&lt;-</span> <span class='va'>mensdates</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/drop_na.html'>drop_na</a></span><span class='op'>(</span><span class='va'>last_menstrual_onset</span>, <span class='va'>next_menstrual_onset</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>expand</span><span class='op'>(</span>date <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='va'>last_menstrual_onset</span>, 
                    to <span class='op'>=</span> <span class='va'>next_menstrual_onset</span> <span class='op'>-</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='https://lubridate.tidyverse.org/reference/period.html'>days</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>,
                    by <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/left_join.html'>left_join</a></span><span class='op'>(</span><span class='va'>cycles</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>last_menstrual_onset</span>, <span class='va'>next_menstrual_onset</span>, <span class='va'>lh_surge_date</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>drop_na (grouped): removed 10 rows (10%), 92 rows remaining</code></pre>
<pre><code>group_by: one grouping variable (ID)</code></pre>
<pre><code>select: dropped 3 variables (cycle, cycle_length, LH_peak)</code></pre>
<pre><code>left_join: added 3 columns (last_menstrual_onset, next_menstrual_onset, lh_surge_date)</code></pre>
<pre><code>           &gt; rows only in x       0</code></pre>
<pre><code>           &gt; rows only in y  (   10)</code></pre>
<pre><code>           &gt; matched rows     2,605</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       2,605</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>marc</span> <span class='op'>&lt;-</span> <span class='va'>marc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/left_join.html'>left_join</a></span><span class='op'>(</span><span class='va'>merge_date_on_cycle</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ID"</span>, <span class='st'>"date"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/left_join.html'>left_join</a></span><span class='op'>(</span><span class='va'>cycles</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>cycle</span>, <span class='va'>cycle_length</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>left_join: added 3 columns (last_menstrual_onset, next_menstrual_onset, lh_surge_date)</code></pre>
<pre><code>           &gt; rows only in x     201</code></pre>
<pre><code>           &gt; rows only in y  (  744)</code></pre>
<pre><code>           &gt; matched rows     1,861</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       2,062</code></pre>
<pre><code>select: dropped 4 variables (LH_peak, last_menstrual_onset, next_menstrual_onset, lh_surge_date)</code></pre>
<pre><code>left_join: added 2 columns (cycle, cycle_length)</code></pre>
<pre><code>           &gt; rows only in x       0</code></pre>
<pre><code>           &gt; rows only in y  (    0)</code></pre>
<pre><code>           &gt; matched rows     2,062</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       2,062</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>marc</span> <span class='op'>&lt;-</span> <span class='va'>marc</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&gt;</span> <span class='st'>"2015-02-12"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>
    bc_day <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>-</span> <span class='va'>next_menstrual_onset</span><span class='op'>)</span>,
    fc_day <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>-</span> <span class='va'>last_menstrual_onset</span><span class='op'>)</span>,
    lh_day <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>-</span> <span class='va'>lh_surge_date</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: no rows removed</code></pre>
<pre><code>group_by: one grouping variable (ID)</code></pre>
<pre><code>mutate (grouped): new variable &#39;bc_day&#39; (double) with 34 unique values and 10% NA</code></pre>
<pre><code>                  new variable &#39;fc_day&#39; (double) with 37 unique values and 10% NA</code></pre>
<pre><code>                  new variable &#39;lh_day&#39; (double) with 36 unique values and 41% NA</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>marc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>fc_day</span> <span class='op'>&lt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>date</span>, <span class='va'>fc_day</span>,<span class='va'>last_menstrual_onset</span>, <span class='va'>next_menstrual_onset</span>, <span class='va'>bc_day</span>, <span class='va'>estradiol</span>, <span class='va'>progesterone</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter (grouped): removed all rows (100%)</code></pre>
<pre><code>select: dropped 22 variables (data.x, Pom1, Pom2, Avrg, St.Dev., …)</code></pre>
<pre><code># A tibble: 0 × 8
# Groups:   ID [0]
# … with 8 variables: ID &lt;dbl&gt;, date &lt;date&gt;, fc_day &lt;dbl&gt;,
#   last_menstrual_onset &lt;date&gt;, next_menstrual_onset &lt;date&gt;,
#   bc_day &lt;dbl&gt;, estradiol &lt;dbl&gt;, progesterone &lt;dbl&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>marc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>bc_day</span> <span class='op'>&gt;</span> <span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>date</span>, <span class='va'>fc_day</span>, <span class='va'>bc_day</span>, <span class='va'>estradiol</span>, <span class='va'>progesterone</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter (grouped): removed all rows (100%)</code></pre>
<pre><code>select: dropped 24 variables (data.x, Pom1, Pom2, Avrg, St.Dev., …)</code></pre>
<pre><code># A tibble: 0 × 6
# Groups:   ID [0]
# … with 6 variables: ID &lt;dbl&gt;, date &lt;date&gt;, fc_day &lt;dbl&gt;,
#   bc_day &lt;dbl&gt;, estradiol &lt;dbl&gt;, progesterone &lt;dbl&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>qplot</span><span class='op'>(</span><span class='va'>marc</span><span class='op'>$</span><span class='va'>date</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<img src="1_marcinkowska_import_files/figure-html5/unnamed-chunk-8-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>marc</span><span class='op'>$</span><span class='va'>fc_day</span>, na.rm <span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  0 35</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>marc</span><span class='op'>$</span><span class='va'>bc_day</span>, na.rm <span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -36  -1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>marc</span><span class='op'>$</span><span class='va'>lh_day</span>, na.rm <span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -17  17</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>marc</span> <span class='op'>&lt;-</span> <span class='va'>marc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>
    lh_surge_date_2 <span class='op'>=</span> <span class='fu'>first</span><span class='op'>(</span><span class='va'>date</span><span class='op'>[</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>Meetings.x</span>, <span class='st'>"O"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>]</span><span class='op'>)</span>
    <span class='op'>)</span>
</code></pre>
</div>
<pre><code>group_by: one grouping variable (ID)</code></pre>
<pre><code>mutate (grouped): new variable &#39;lh_surge_date_2&#39; (Date) with 28 unique values and 67% NA</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>marc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>&lt;</span> <span class='va'>last_menstrual_onset</span> <span class='op'>|</span> <span class='va'>date</span> <span class='op'>&gt;</span> <span class='va'>next_menstrual_onset</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter (grouped): removed all rows (100%)</code></pre>
<pre><code># A tibble: 0 × 31
# Groups:   ID [0]
# … with 31 variables: ID &lt;dbl&gt;, data.x &lt;chr&gt;, Pom1 &lt;chr&gt;,
#   Pom2 &lt;dbl&gt;, Avrg &lt;dbl&gt;, St.Dev. &lt;dbl&gt;, %CV &lt;dbl&gt;,
#   estradiol &lt;dbl&gt;, Meetings.x &lt;chr&gt;, Ovul &lt;chr&gt;, For &lt;dbl&gt;,
#   Back &lt;dbl&gt;, Batch &lt;dbl&gt;, Notes &lt;chr&gt;, date &lt;date&gt;, batch &lt;chr&gt;,
#   data.y &lt;chr&gt;, progesterone &lt;dbl&gt;, Meetings.y &lt;chr&gt;,
#   estradiol_cens &lt;chr&gt;, progesterone_cens &lt;chr&gt;, KP &lt;chr&gt;,
#   last_menstrual_onset &lt;date&gt;, next_menstrual_onset &lt;date&gt;, …</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>marc_without_cycle_phase</span> <span class='op'>&lt;-</span> <span class='va'>marc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>last_menstrual_onset</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter (grouped): removed 1,861 rows (90%), 201 rows remaining</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>marc_with_cycle_phase</span> <span class='op'>&lt;-</span> <span class='va'>marc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>last_menstrual_onset</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter (grouped): removed 201 rows (10%), 1,861 rows remaining</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>marc_without_cycle_phase</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning: Unknown or uninitialised column: `id`.</code></pre>
<pre><code>[1] 0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>marc_with_cycle_phase</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning: Unknown or uninitialised column: `id`.</code></pre>
<pre><code>[1] 0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='va'>marc_without_cycle_phase</span><span class='op'>$</span><span class='va'>id</span>, <span class='va'>marc_with_cycle_phase</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>sort</span>
</code></pre>
</div>
<pre><code>Warning: Unknown or uninitialised column: `id`.

Warning: Unknown or uninitialised column: `id`.</code></pre>
<pre><code>NULL</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fl'>102</span><span class='op'>-</span><span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>marc_with_cycle_phase</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning: Unknown or uninitialised column: `id`.</code></pre>
<pre><code>[1] 102</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># n_nonmissing(marc$lh_surge_date)</span>
<span class='co'># n_nonmissing(marc$lh_surge_date_2)</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>marc</span><span class='op'>$</span><span class='va'>lh_surge_date</span> <span class='op'>==</span> <span class='va'>marc</span><span class='op'>$</span><span class='va'>lh_surge_date_2</span>, exclude<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
FALSE  TRUE  &lt;NA&gt; 
  114   451  1497 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>marc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>lh_surge_date</span> <span class='op'>!=</span> <span class='va'>lh_surge_date_2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>lh_surge_date</span>, <span class='va'>lh_surge_date_2</span>, <span class='va'>date</span>, <span class='va'>Meetings.x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter (grouped): removed 1,948 rows (94%), 114 rows remaining</code></pre>
<pre><code>select: dropped 26 variables (data.x, Pom1, Pom2, Avrg, St.Dev., …)</code></pre>
<pre><code># A tibble: 114 × 5
# Groups:   ID [5]
      ID lh_surge_date lh_surge_date_2 date       Meetings.x
   &lt;dbl&gt; &lt;date&gt;        &lt;date&gt;          &lt;date&gt;     &lt;chr&gt;     
 1     7 2015-10-16    2015-10-15      2015-10-05 S1        
 2     7 2015-10-16    2015-10-15      2015-10-08 &lt;NA&gt;      
 3     7 2015-10-16    2015-10-15      2015-10-09 &lt;NA&gt;      
 4     7 2015-10-16    2015-10-15      2015-10-10 &lt;NA&gt;      
 5     7 2015-10-16    2015-10-15      2015-10-11 &lt;NA&gt;      
 6     7 2015-10-16    2015-10-15      2015-10-12 &lt;NA&gt;      
 7     7 2015-10-16    2015-10-15      2015-10-13 &lt;NA&gt;      
 8     7 2015-10-16    2015-10-15      2015-10-14 &lt;NA&gt;      
 9     7 2015-10-16    2015-10-15      2015-10-15 O         
10     7 2015-10-16    2015-10-15      2015-10-16 S2        
# … with 104 more rows</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>marc</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>fc_day</span>, <span class='va'>progesterone</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_pointrange</span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>'summary'</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>30</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 1285 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 1285 rows containing non-finite values
(stat_summary).</code></pre>
<pre><code>No summary function supplied, defaulting to `mean_se()`</code></pre>
<pre><code>Warning: Removed 1 rows containing missing values (geom_segment).</code></pre>
<img src="1_marcinkowska_import_files/figure-html5/unnamed-chunk-8-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>marc</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>bc_day</span>, <span class='va'>progesterone</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_pointrange</span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>'summary'</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>30</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 1264 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 1264 rows containing non-finite values
(stat_summary).</code></pre>
<pre><code>No summary function supplied, defaulting to `mean_se()`</code></pre>
<pre><code>Warning: Removed 2 rows containing missing values (geom_segment).</code></pre>
<img src="1_marcinkowska_import_files/figure-html5/unnamed-chunk-8-3.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>marc</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>lh_day</span>, <span class='va'>progesterone</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_pointrange</span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>'summary'</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>15</span>, <span class='fl'>14</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 1547 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 1547 rows containing non-finite values
(stat_summary).</code></pre>
<pre><code>No summary function supplied, defaulting to `mean_se()`</code></pre>
<pre><code>Warning: Removed 1 rows containing missing values (geom_segment).</code></pre>
<img src="1_marcinkowska_import_files/figure-html5/unnamed-chunk-8-4.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>marc</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>fc_day</span>, <span class='va'>estradiol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_pointrange</span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>'summary'</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>30</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 550 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 550 rows containing non-finite values (stat_summary).</code></pre>
<pre><code>No summary function supplied, defaulting to `mean_se()`</code></pre>
<img src="1_marcinkowska_import_files/figure-html5/unnamed-chunk-8-5.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>marc</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>bc_day</span>, <span class='va'>estradiol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_pointrange</span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>'summary'</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>30</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 556 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 556 rows containing non-finite values (stat_summary).</code></pre>
<pre><code>No summary function supplied, defaulting to `mean_se()`</code></pre>
<img src="1_marcinkowska_import_files/figure-html5/unnamed-chunk-8-6.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>marc</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>lh_day</span>, <span class='va'>estradiol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_pointrange</span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>'summary'</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>15</span>, <span class='fl'>14</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 1068 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 1068 rows containing non-finite values
(stat_summary).</code></pre>
<pre><code>No summary function supplied, defaulting to `mean_se()`</code></pre>
<img src="1_marcinkowska_import_files/figure-html5/unnamed-chunk-8-7.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>marc</span> <span class='op'>&lt;-</span> <span class='va'>marc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/rename.html'>rename</a></span><span class='op'>(</span>id<span class='op'>=</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>rename: renamed one variable (id)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>marc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/summarise.html'>summarise</a></span><span class='op'>(</span>
    prog <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>progesterone</span><span class='op'>)</span><span class='op'>)</span>,
    estr <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>estradiol</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>prog</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>estr</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>summarise: now 102 rows and 3 columns, ungrouped</code></pre>
<pre><code>summarise: now one row and 2 columns, ungrouped</code></pre>
<pre><code># A tibble: 1 × 2
  `sum(prog)` `sum(estr)`
        &lt;int&gt;       &lt;int&gt;
1          57         102</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>marc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Meetings.x</span> <span class='op'>!=</span> <span class='va'>Meetings.y</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>Meetings.x</span>, <span class='va'>Meetings.y</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter (grouped): removed 2,054 rows (&gt;99%), 8 rows remaining</code></pre>
<pre><code>Adding missing grouping variables: `id`</code></pre>
<pre><code>select: dropped 28 variables (data.x, Pom1, Pom2, Avrg, St.Dev., …)</code></pre>
<pre><code># A tibble: 8 × 3
# Groups:   id [6]
     id Meetings.x Meetings.y
  &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;     
1    38 O          S2        
2    52 s1         S1        
3    52 S2         s2        
4    16 O S2       S2        
5    26 O S2       S2        
6    55 O          S2        
7     1 S1         Spotk1    
8     1 Spotk3     SPotk3    </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>marc</span><span class='op'>$</span><span class='va'>Meetings.x</span><span class='op'>==</span><span class='va'>marc</span><span class='op'>$</span><span class='va'>Meetings.y</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
FALSE  TRUE 
    8   157 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>marc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='fu'>contains</span><span class='op'>(</span><span class='st'>"date"</span><span class='op'>)</span>, <span class='va'>bc_day</span>, <span class='va'>fc_day</span>, <span class='va'>lh_day</span>, <span class='va'>estradiol</span>, <span class='va'>estradiol_cens</span>, <span class='va'>progesterone</span>, <span class='va'>progesterone_cens</span>, <span class='va'>cycle_length</span>, Meetings_E2 <span class='op'>=</span> <span class='va'>Meetings.x</span>, Meetings_P4 <span class='op'>=</span> <span class='va'>Meetings.y</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
<span class='fu'>rio</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rio/man/export.html'>export</a></span><span class='op'>(</span><span class='st'>"data/marcinkowska/manual_clean/ula_merged.xlsx"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: renamed 2 variables (Meetings_E2, Meetings_P4) and dropped 16 variables</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>marc_check</span> <span class='op'>&lt;-</span> <span class='va'>marc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>date</span>, <span class='va'>cycle</span>, <span class='va'>last_menstrual_onset</span>, <span class='va'>next_menstrual_onset</span>, <span class='va'>lh_surge_date</span>, <span class='va'>bc_day</span>, <span class='va'>fc_day</span>, <span class='va'>lh_day</span>, <span class='va'>progesterone</span>, <span class='va'>estradiol</span>, <span class='va'>cycle_length</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: dropped 19 variables (data.x, Pom1, Pom2, Avrg, St.Dev., …)</code></pre>
</div>
<h2 id="summarize">Summarize</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/source.html'>source</a></span><span class='op'>(</span><span class='st'>"0_summary_functions.R"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Loading required package: Rcpp</code></pre>
<pre><code>Loading &#39;brms&#39; package (version 2.16.2). Useful instructions
can be found by typing help(&#39;brms&#39;). A more detailed introduction
to the package is available through vignette(&#39;brms_overview&#39;).</code></pre>
<pre><code>
Attaching package: &#39;brms&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:stats&#39;:

    ar</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>mc.cores <span class='op'>=</span> <span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/detectCores.html'>detectCores</a></span><span class='op'>(</span><span class='op'>)</span>, 
        brms.backend <span class='op'>=</span> <span class='st'>"rstan"</span>,
        brms.file_refit <span class='op'>=</span> <span class='st'>"on_change"</span><span class='op'>)</span>

<span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>marc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>bc_day</span>, <span class='va'>fc_day</span>, <span class='va'>lh_day</span>, hormone <span class='op'>=</span> <span class='va'>progesterone</span>, hormone_cens <span class='op'>=</span> <span class='va'>progesterone_cens</span>, <span class='va'>cycle_length</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: renamed 2 variables (hormone, hormone_cens) and dropped 23 variables</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>summarise_hormone</span><span class='op'>(</span>df <span class='op'>=</span> <span class='va'>df</span>, Dataset <span class='op'>=</span> <span class='st'>"Marcinkowska 2020"</span>, Hormone <span class='op'>=</span> <span class='st'>"Progesterone"</span>, 
                  Method <span class='op'>=</span> <span class='st'>"Salivary immunoassay (DRG)"</span>, 
                  Citation <span class='op'>=</span> <span class='st'>[1191 chars quoted with '"']</span>, 
      LOD <span class='op'>=</span> <span class='fl'>2.5</span>,
      LOQ <span class='op'>=</span> <span class='fl'>10</span>,
      CV_intra <span class='op'>=</span> <span class='st'>"4.9%"</span>,
      CV_inter <span class='op'>=</span> <span class='st'>"14.1%"</span>,
      Procedure <span class='op'>=</span> <span class='st'>[1587 chars quoted with '"']</span>,
      Scheduling <span class='op'>=</span> <span class='st'>"Whole cycle 'Participants were asked to collect saliva samples each morning starting from the first day of menstrual bleeding, until the end of the menstrual cycle (i.e., the day before the onset of the next menstrual bleeding). Due to financial restrictions on average 15 hormonal measurements were done per participant. For E centred around ovulation, for P last 15 days of the cycle.'"</span>,
        LH_test <span class='op'>=</span> <span class='st'>"All participants received LH kits. Each kit consisted of sterilized urine cups and 10 LH tests. Women were instructed to conduct the tests from the 10th until the 20th day of the cycle or until a positive result was obtained."</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: dropped 6 variables (bc_day, fc_day, lh_day, hormone, hormone_cens, …)</code></pre>
<pre><code>group_by: 2 grouping variables (id, cycle)</code></pre>
<pre><code>summarise: now 102 rows and 3 columns, one group variable remaining (id)</code></pre>
<pre><code>ungroup: no grouping variables</code></pre>
<pre><code>filter (grouped): removed 1,260 rows (61%), 802 rows remaining</code></pre>
<pre><code>group_by: 2 grouping variables (id, cycle)</code></pre>
<pre><code>mutate (grouped): new variable &#39;hormone_diff&#39; (double) with 798 unique values and 0% NA</code></pre>
<pre><code>                  new variable &#39;log_hormone_diff&#39; (double) with 798 unique values and 0% NA</code></pre>
<pre><code>ungroup: no grouping variables</code></pre>
<pre><code>Joining, by = &quot;bc_day&quot;</code></pre>
<pre><code>left_join: added 26 columns (prc_stirn_bc, prc_wcx_bc, est_estradiol_bc, est_estradiol_bc_se, est_estradiol_bc_low, …)</code></pre>
<pre><code>           &gt; rows only in x    30</code></pre>
<pre><code>           &gt; rows only in y  ( 10)</code></pre>
<pre><code>           &gt; matched rows     772</code></pre>
<pre><code>           &gt;                 =====</code></pre>
<pre><code>           &gt; rows total       802</code></pre>
<pre><code>Warning in summarise_hormone(df = df, Dataset = &quot;Marcinkowska 2020&quot;,
Hormone = &quot;Progesterone&quot;, : Check FC day range 1;34</code></pre>
<pre><code>left_join: added 26 columns (prc_stirn_fc, prc_wcx_fc, est_estradiol_fc, est_estradiol_fc_se, est_estradiol_fc_low, …)</code></pre>
<pre><code>           &gt; rows only in x    30</code></pre>
<pre><code>           &gt; rows only in y  (  6)</code></pre>
<pre><code>           &gt; matched rows     772</code></pre>
<pre><code>           &gt;                 =====</code></pre>
<pre><code>           &gt; rows total       802</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed 30 rows (4%), 772 rows remaining</code></pre>
<pre><code>summarise: now 54 rows and 2 columns, ungrouped</code></pre>
<pre><code>summarise: now one row and 3 columns, ungrouped</code></pre>
<pre><code>group_by: 2 grouping variables (id, cycle)</code></pre>
<pre><code>filter (grouped): removed 30 rows (4%), 772 rows remaining</code></pre>
<pre><code>summarise: now 54 rows and 3 columns, one group variable remaining (id)</code></pre>
<pre><code>ungroup: no grouping variables</code></pre>
<pre><code>summarise: now one row and 3 columns, ungrouped</code></pre>
<pre><code>left_join: added 22 columns (conception_risk_lh, fertile_lh, est_estradiol_lh, est_estradiol_lh_se, est_estradiol_lh_low, …)</code></pre>
<pre><code>           &gt; rows only in x   280</code></pre>
<pre><code>           &gt; rows only in y  (  0)</code></pre>
<pre><code>           &gt; matched rows     522</code></pre>
<pre><code>           &gt;                 =====</code></pre>
<pre><code>           &gt; rows total       802</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed all rows (100%)</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): no rows removed</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.

Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>filter: removed 280 rows (35%), 522 rows remaining</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>$Dataset
[1] &quot;Marcinkowska 2020&quot;

$Citation
[1] &quot;Marcinkowska, U. M. (2020). Importance of Daily Sex Hormone Measurements Within the Menstrual Cycle for Fertility Estimates in Cyclical Shifts Studies. Evolutionary Psychology: An International Journal of Evolutionary Approaches to Psychology and Behavior, 18(1), 1474704919897913. https://doi.org/10.1177/1474704919897913\n\nMarcinkowska, U. M., Ellison, P. T., Galbarczyk, A., Milkowska, K., Pawlowski, B., Thune, I., &amp; Jasienska, G. (2016). Lack of support for relation between woman’s masculinity preference, estradiol level and mating context. Hormones and Behavior, 78, 1–7. https://doi.org/10.1016/j.yhbeh.2015.10.012\n\nMarcinkowska, U. M., Galbarczyk, A., &amp; Jasienska, G. (2018). La donna è mobile? Lack of cyclical shifts in facial symmetry, and facial and body masculinity preferences-A hormone based study. Psychoneuroendocrinology, 88, 47–53. https://doi.org/10.1016/j.psyneuen.2017.11.007\n\nMarcinkowska, U. M., Kaminski, G., Little, A. C., &amp; Jasienska, G. (2018). Average ovarian hormone levels, rather than daily values and their fluctuations, are related to facial preferences among women. Hormones and Behavior, 102, 114–119. https://doi.org/10.1016/j.yhbeh.2018.05.013&quot;

$Hormone
[1] &quot;Progesterone&quot;

$Method
[1] &quot;Salivary immunoassay (DRG)&quot;

$`Limit of detection`
[1] 2.5

$LOQ
[1] 10

$`Intraassay CV`
[1] &quot;4.9%&quot;

$`Interassay CV`
[1] &quot;14.1%&quot;

$Procedure
[1] &quot;Participants were asked to collect saliva samples each morning starting from the first day of menstrual bleeding, until the end of the menstrual cycle (i.e., the day before the onset of the next menstrual bleeding). Women were verbally instructed by the principal investigator concerning collecting and storing the saliva and were given a set of 2-ml centrifuge tubes with the minimum amount of required saliva marked on a tube together with written instructions. Saliva samples were collected in the morning, preferably before eating, drinking, or smoking, or not earlier than 30 min after eating, drinking, or smoking. Immediately after collec- tion, samples were frozen in the participant’s home freezer. After the end of the cycle, samples were transported in portable freezers to the laboratory where hormonal assays for measure- ments of 17-b-estradiol (E2) and 17-a-hydroxy-progesterone (P) were conducted. Hormonal measurements were conducted using commercially available hormonal assays of DRG Inter- national, Inc. ELISA plates SLV4188 (sensitivity: 0.4 pg/ml, standard range: 1–100 pg/ml) for E2 and SLV3140 for P (sen- sitivity: 2.5 pg/ml, standard range: 10–5,000 pg/ml). All sam- ples were assayed in duplicates. The quality of hormonal measurements was monitored for each plate separately by including samples of known concentrations with low and high E2 and P levels. Inter-assay variability was 10.1%, intra-assay variability was 7.5% for E2 and 14.1% and 4.9% for P, which is within acceptable values for steroid sex hormones assays (Schultheiss &amp; Stanton, 2009).&quot;

$Scheduling
[1] &quot;Whole cycle &#39;Participants were asked to collect saliva samples each morning starting from the first day of menstrual bleeding, until the end of the menstrual cycle (i.e., the day before the onset of the next menstrual bleeding). Due to financial restrictions on average 15 hormonal measurements were done per participant. For E centred around ovulation, for P last 15 days of the cycle.&#39;&quot;

$LH_test
[1] &quot;All participants received LH kits. Each kit consisted of sterilized urine cups and 10 LH tests. Women were instructed to conduct the tests from the 10th until the 20th day of the cycle or until a positive result was obtained.&quot;

$distribution</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 1231 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_marcinkowska_import_files/figure-html5/unnamed-chunk-11-1.png" width="624" /></p>
<pre><code>
$mean
[1] 81.15628

$logmean
[1] 3.969

$logsd
[1] 1.045365

$median
[1] 61.76177

$sd
[1] 70.30813

$mad
[1] 56.6807

$range
[1] &quot;2.50, 408.49&quot;

$missing
[1] 1231

$outliers
[1] 0

$censored
[1] 10

$n_women
[1] 102

$n_cycles
[1] 102

$n_days
[1] 2062

$age
[1] NA

$in_relationship
[1] NA

$cycle_length
[1] &quot;28.2±2.96&quot;

$usable_n
[1] 802

$usable_n_women
[1] 55

$no_lh_surge_woman
[1] &quot;18/54 (33%)&quot;

$no_lh_surge_cycle
[1] &quot;18/54 (33%)&quot;

$var_id_loo
[1] &quot;0.39 [0.34;0.44]&quot;

$var_id
[1] &quot;0.70 [0.57;0.87] (44%)&quot;

$var_resid
[1] &quot;0.77 [0.73;0.81] (56%)&quot;

$bc_day_model
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(bc_day) + (1 | id) 
   Data: df (Number of observations: 772) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sbc_day_1)     2.51      0.80     1.34     4.43 1.00     1807
               Tail_ESS
sds(sbc_day_1)     2670

Group-Level Effects: 
~id (Number of levels: 54) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.70      0.07     0.57     0.86 1.00      762
              Tail_ESS
sd(Intercept)     1299

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     3.99      0.10     3.80     4.18 1.01      392      752
sbc_day_1    -4.15      2.56    -9.29     0.76 1.00     2000     2674

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.67      0.02     0.64     0.71 1.00     5209     3259

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_bc
[1] &quot;0.36 [0.32;0.40]&quot;

$rmse_bc
[1] &quot;1.16 [1.11;1.21]&quot;

$r_loo_bc
[1] &quot;0.26 [0.14;0.34]&quot;

$r_bc_stirn
[1] &quot;-0.18 [-0.24;-0.11]&quot;

$r_log_bc_stirn
[1] &quot;-0.18 [-0.25;-0.11]&quot;

$r_diff_bc_stirn
[1] &quot;-0.25 [-0.32;-0.19]&quot;

$r_log_diff_bc_stirn
[1] &quot;-0.26 [-0.32;-0.19]&quot;

$r_bc_imputed
[1] &quot; 0.35 [ 0.29; 0.41]&quot;

$r_diff_bc_imputed
[1] &quot; 0.47 [ 0.41; 0.52]&quot;

$sd_bc_imputed
[1] &quot;0.93 (55%)&quot;

$r_diff_bc_imputed_rr
[1] &quot; 0.58 [ 0.52; 0.64]&quot;

$imputed_bc_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 32 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 32 rows containing missing values (geom_point).</code></pre>
<p><img src="1_marcinkowska_import_files/figure-html5/unnamed-chunk-11-2.png" width="624" /></p>
<pre><code>
$rmse_bc_imputed
[1] &quot; 1.18&quot;

$fc_day_model
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(fc_day) + (1 | id) 
   Data: df (Number of observations: 772) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sfc_day_1)     1.92      0.78     0.84     3.79 1.00     1392
               Tail_ESS
sds(sfc_day_1)     2027

Group-Level Effects: 
~id (Number of levels: 54) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.69      0.07     0.57     0.86 1.01      647
              Tail_ESS
sd(Intercept)      973

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     3.98      0.10     3.79     4.18 1.01      378      693
sfc_day_1     1.23      2.82    -4.55     7.12 1.00     1491     1719

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.71      0.02     0.68     0.75 1.00     4728     3449

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_fc
[1] &quot;0.28 [0.23;0.32]&quot;

$rmse_fc
[1] &quot;1.21 [1.16;1.26]&quot;

$r_loo_fc
[1] &quot;0.15 [NaN;0.25]&quot;

$r_fc_stirn
[1] &quot;-0.14 [-0.21;-0.07]&quot;

$r_log_fc_stirn
[1] &quot;-0.11 [-0.18;-0.04]&quot;

$r_diff_fc_stirn
[1] &quot;-0.17 [-0.23;-0.10]&quot;

$r_log_diff_fc_stirn
[1] &quot;-0.16 [-0.23;-0.09]&quot;

$r_fc_imputed
[1] &quot; 0.25 [ 0.19; 0.32]&quot;

$r_diff_fc_imputed
[1] &quot; 0.34 [ 0.27; 0.40]&quot;

$sd_fc_imputed
[1] &quot;0.87 (55%)&quot;

$r_diff_fc_imputed_rr
[1] &quot; 0.43 [ 0.36; 0.50]&quot;

$imputed_fc_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 46 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 46 rows containing missing values (geom_point).</code></pre>
<p><img src="1_marcinkowska_import_files/figure-html5/unnamed-chunk-11-3.png" width="624" /></p>
<pre><code>
$rmse_fc_imputed
[1] &quot; 1.23&quot;

$lh_day_model
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(lh_day) + (1 | id) 
   Data: df %&gt;% filter(between(lh_day, -15, 15)) (Number of observations: 522) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(slh_day_1)     2.89      1.13     1.33     5.67 1.01     1076
               Tail_ESS
sds(slh_day_1)     1685

Group-Level Effects: 
~id (Number of levels: 36) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.67      0.09     0.52     0.87 1.00      662
              Tail_ESS
sd(Intercept)      967

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     4.02      0.11     3.80     4.24 1.01      403      954
slh_day_1    -5.85      3.62   -13.53     1.01 1.00     1372     2186

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.68      0.02     0.64     0.72 1.00     3343     2734

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_lh
[1] &quot;0.35 [0.29;0.40]&quot;

$rmse_lh
[1] &quot;1.14 [1.09;1.21]&quot;

$r_loo_lh
[1] &quot;0.23 [NaN;0.33]&quot;

$r_prob_lh
[1] &quot;-0.14 [-0.23;-0.06]&quot;

$r_log_prob_lh
[1] &quot;-0.17 [-0.25;-0.08]&quot;

$r_diff_prob_lh
[1] &quot;-0.12 [-0.21;-0.04]&quot;

$r_log_diff_prob_lh
[1] &quot;-0.17 [-0.25;-0.09]&quot;

$r_lh_imputed
[1] &quot; 0.35 [ 0.28; 0.43]&quot;

$r_diff_lh_imputed
[1] &quot; 0.41 [ 0.34; 0.48]&quot;

$sd_lh_imputed
[1] &quot;1.06 (63%)&quot;

$r_diff_lh_imputed_rr
[1] &quot; 0.49 [ 0.41; 0.57]&quot;

$imputed_lh_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 280 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 280 rows containing missing values (geom_point).</code></pre>
<p><img src="1_marcinkowska_import_files/figure-html5/unnamed-chunk-11-4.png" width="624" /></p>
<pre><code>
$rmse_lh_imputed
[1] &quot; 1.28&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>marc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>bc_day</span>, <span class='va'>fc_day</span>, <span class='va'>lh_day</span>, hormone <span class='op'>=</span> <span class='va'>estradiol</span>, hormone_cens <span class='op'>=</span> <span class='va'>estradiol_cens</span>, <span class='va'>cycle_length</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: renamed 2 variables (hormone, hormone_cens) and dropped 23 variables</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>summarise_hormone</span><span class='op'>(</span>df <span class='op'>=</span> <span class='va'>df</span>, Dataset <span class='op'>=</span> <span class='st'>"Marcinkowska 2020"</span>, Hormone <span class='op'>=</span> <span class='st'>"Estradiol"</span>, Method <span class='op'>=</span> <span class='st'>"Salivary immunoassay (DRG)"</span>,       
                  Citation <span class='op'>=</span> <span class='st'>[1191 chars quoted with '"']</span>, 
      LOD <span class='op'>=</span> <span class='fl'>0.4</span>,
      LOQ <span class='op'>=</span> <span class='fl'>1</span>,
      CV_intra <span class='op'>=</span> <span class='st'>"7.5%"</span>,
      CV_inter <span class='op'>=</span> <span class='st'>"10.1%"</span>,
      Procedure <span class='op'>=</span> <span class='st'>[1587 chars quoted with '"']</span>,
      Scheduling <span class='op'>=</span> <span class='st'>"Whole cycle 'Participants were asked to collect saliva samples each morning starting from the first day of menstrual bleeding, until the end of the menstrual cycle (i.e., the day before the onset of the next menstrual bleeding). Due to financial restrictions on average 15 hormonal measurements were done per participant. For E centred around ovulation, for P last 15 days of the cycle.'"</span>,
        LH_test <span class='op'>=</span> <span class='st'>"All participants received LH kits. Each kit consisted of sterilized urine cups and 10 LH tests. Women were instructed to conduct the tests from the 10th until the 20th day of the cycle or until a positive result was obtained."</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: dropped 6 variables (bc_day, fc_day, lh_day, hormone, hormone_cens, …)</code></pre>
<pre><code>group_by: 2 grouping variables (id, cycle)</code></pre>
<pre><code>summarise: now 102 rows and 3 columns, one group variable remaining (id)</code></pre>
<pre><code>ungroup: no grouping variables</code></pre>
<pre><code>filter (grouped): removed 415 rows (20%), 1,647 rows remaining</code></pre>
<pre><code>group_by: 2 grouping variables (id, cycle)</code></pre>
<pre><code>mutate (grouped): new variable &#39;hormone_diff&#39; (double) with 1,644 unique values and 0% NA</code></pre>
<pre><code>                  new variable &#39;log_hormone_diff&#39; (double) with 1,644 unique values and 0% NA</code></pre>
<pre><code>ungroup: no grouping variables</code></pre>
<pre><code>Joining, by = &quot;bc_day&quot;</code></pre>
<pre><code>left_join: added 26 columns (prc_stirn_bc, prc_wcx_bc, est_estradiol_bc, est_estradiol_bc_se, est_estradiol_bc_low, …)</code></pre>
<pre><code>           &gt; rows only in x     168</code></pre>
<pre><code>           &gt; rows only in y  (    9)</code></pre>
<pre><code>           &gt; matched rows     1,479</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,647</code></pre>
<pre><code>left_join: added 26 columns (prc_stirn_fc, prc_wcx_fc, est_estradiol_fc, est_estradiol_fc_se, est_estradiol_fc_low, …)</code></pre>
<pre><code>           &gt; rows only in x     168</code></pre>
<pre><code>           &gt; rows only in y  (    9)</code></pre>
<pre><code>           &gt; matched rows     1,479</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,647</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed 168 rows (10%), 1,479 rows remaining</code></pre>
<pre><code>summarise: now 90 rows and 2 columns, ungrouped</code></pre>
<pre><code>summarise: now one row and 3 columns, ungrouped</code></pre>
<pre><code>group_by: 2 grouping variables (id, cycle)</code></pre>
<pre><code>filter (grouped): removed 168 rows (10%), 1,479 rows remaining</code></pre>
<pre><code>summarise: now 90 rows and 3 columns, one group variable remaining (id)</code></pre>
<pre><code>ungroup: no grouping variables</code></pre>
<pre><code>summarise: now one row and 3 columns, ungrouped</code></pre>
<pre><code>left_join: added 22 columns (conception_risk_lh, fertile_lh, est_estradiol_lh, est_estradiol_lh_se, est_estradiol_lh_low, …)</code></pre>
<pre><code>           &gt; rows only in x     652</code></pre>
<pre><code>           &gt; rows only in y  (    0)</code></pre>
<pre><code>           &gt; matched rows       995</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,647</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed all rows (100%)</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): no rows removed</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Some Pareto k diagnostic values are slightly high. See help(&#39;pareto-k-diagnostic&#39;) for details.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.

Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>filter: removed 652 rows (40%), 995 rows remaining</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Estimate&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q97.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Estimate&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q97.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Estimate&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q97.5&quot;]): NaNs produced</code></pre>
<pre><code>$Dataset
[1] &quot;Marcinkowska 2020&quot;

$Citation
[1] &quot;Marcinkowska, U. M. (2020). Importance of Daily Sex Hormone Measurements Within the Menstrual Cycle for Fertility Estimates in Cyclical Shifts Studies. Evolutionary Psychology: An International Journal of Evolutionary Approaches to Psychology and Behavior, 18(1), 1474704919897913. https://doi.org/10.1177/1474704919897913\n\nMarcinkowska, U. M., Ellison, P. T., Galbarczyk, A., Milkowska, K., Pawlowski, B., Thune, I., &amp; Jasienska, G. (2016). Lack of support for relation between woman’s masculinity preference, estradiol level and mating context. Hormones and Behavior, 78, 1–7. https://doi.org/10.1016/j.yhbeh.2015.10.012\n\nMarcinkowska, U. M., Galbarczyk, A., &amp; Jasienska, G. (2018). La donna è mobile? Lack of cyclical shifts in facial symmetry, and facial and body masculinity preferences-A hormone based study. Psychoneuroendocrinology, 88, 47–53. https://doi.org/10.1016/j.psyneuen.2017.11.007\n\nMarcinkowska, U. M., Kaminski, G., Little, A. C., &amp; Jasienska, G. (2018). Average ovarian hormone levels, rather than daily values and their fluctuations, are related to facial preferences among women. Hormones and Behavior, 102, 114–119. https://doi.org/10.1016/j.yhbeh.2018.05.013&quot;

$Hormone
[1] &quot;Estradiol&quot;

$Method
[1] &quot;Salivary immunoassay (DRG)&quot;

$`Limit of detection`
[1] 0.4

$LOQ
[1] 1

$`Intraassay CV`
[1] &quot;7.5%&quot;

$`Interassay CV`
[1] &quot;10.1%&quot;

$Procedure
[1] &quot;Participants were asked to collect saliva samples each morning starting from the first day of menstrual bleeding, until the end of the menstrual cycle (i.e., the day before the onset of the next menstrual bleeding). Women were verbally instructed by the principal investigator concerning collecting and storing the saliva and were given a set of 2-ml centrifuge tubes with the minimum amount of required saliva marked on a tube together with written instructions. Saliva samples were collected in the morning, preferably before eating, drinking, or smoking, or not earlier than 30 min after eating, drinking, or smoking. Immediately after collec- tion, samples were frozen in the participant’s home freezer. After the end of the cycle, samples were transported in portable freezers to the laboratory where hormonal assays for measure- ments of 17-b-estradiol (E2) and 17-a-hydroxy-progesterone (P) were conducted. Hormonal measurements were conducted using commercially available hormonal assays of DRG Inter- national, Inc. ELISA plates SLV4188 (sensitivity: 0.4 pg/ml, standard range: 1–100 pg/ml) for E2 and SLV3140 for P (sen- sitivity: 2.5 pg/ml, standard range: 10–5,000 pg/ml). All sam- ples were assayed in duplicates. The quality of hormonal measurements was monitored for each plate separately by including samples of known concentrations with low and high E2 and P levels. Inter-assay variability was 10.1%, intra-assay variability was 7.5% for E2 and 14.1% and 4.9% for P, which is within acceptable values for steroid sex hormones assays (Schultheiss &amp; Stanton, 2009).&quot;

$Scheduling
[1] &quot;Whole cycle &#39;Participants were asked to collect saliva samples each morning starting from the first day of menstrual bleeding, until the end of the menstrual cycle (i.e., the day before the onset of the next menstrual bleeding). Due to financial restrictions on average 15 hormonal measurements were done per participant. For E centred around ovulation, for P last 15 days of the cycle.&#39;&quot;

$LH_test
[1] &quot;All participants received LH kits. Each kit consisted of sterilized urine cups and 10 LH tests. Women were instructed to conduct the tests from the 10th until the 20th day of the cycle or until a positive result was obtained.&quot;

$distribution</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 382 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>
$mean
[1] 7.614164

$logmean
[1] 1.70602

$logsd
[1] 0.853981

$median
[1] 5.960774

$sd
[1] 6.396447

$mad
[1] 4.362036

$range
[1] &quot;0.40, 46.52&quot;

$missing
[1] 382

$outliers
[1] 0

$censored
[1] 10

$n_women
[1] 102

$n_cycles
[1] 102

$n_days
[1] 2062

$age
[1] NA

$in_relationship
[1] NA

$cycle_length
[1] &quot;28.2±2.96&quot;

$usable_n
[1] 1647

$usable_n_women
[1] 100

$no_lh_surge_woman
[1] &quot;29/90 (32%)&quot;

$no_lh_surge_cycle
[1] &quot;29/90 (32%)&quot;

$var_id_loo
[1] &quot;0.52 [0.48;0.56]&quot;

$var_id
[1] &quot;0.66 [0.57;0.76] (55%)&quot;

$var_resid
[1] &quot;0.58 [0.56;0.60] (45%)&quot;

$bc_day_model</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup. Increasing
adapt_delta above 0.99 may help. See http://mc-stan.org/misc/
warnings.html#divergent-transitions-after-warmup</code></pre>
<p><img src="1_marcinkowska_import_files/figure-html5/unnamed-chunk-11-5.png" width="624" /></p>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(bc_day) + (1 | id) 
   Data: df (Number of observations: 1479) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sbc_day_1)     1.40      0.69     0.47     3.16 1.00      819
               Tail_ESS
sds(sbc_day_1)     1202

Group-Level Effects: 
~id (Number of levels: 90) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.66      0.05     0.57     0.77 1.01      362
              Tail_ESS
sd(Intercept)      938

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     1.71      0.07     1.58     1.85 1.01      224      420
sbc_day_1    -0.34      1.75    -3.63     3.47 1.00     1188     1530

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.55      0.01     0.53     0.57 1.00     3565     2926

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_bc
[1] &quot;0.14 [0.10;0.17]&quot;

$rmse_bc
[1] &quot;1.00 [0.98;1.04]&quot;

$r_loo_bc
[1] &quot;NaN [NaN;NaN]&quot;

$r_bc_stirn
[1] &quot; 0.07 [ 0.02; 0.12]&quot;

$r_log_bc_stirn
[1] &quot; 0.07 [ 0.02; 0.12]&quot;

$r_diff_bc_stirn
[1] &quot; 0.07 [ 0.02; 0.12]&quot;

$r_log_diff_bc_stirn
[1] &quot; 0.07 [ 0.02; 0.12]&quot;

$r_bc_imputed
[1] &quot; 0.13 [ 0.08; 0.18]&quot;

$r_diff_bc_imputed
[1] &quot; 0.18 [ 0.13; 0.22]&quot;

$sd_bc_imputed
[1] &quot;0.48 (59%)&quot;

$r_diff_bc_imputed_rr
[1] &quot; 0.23 [ 0.16; 0.29]&quot;

$imputed_bc_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 172 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 172 rows containing missing values (geom_point).</code></pre>
<p><img src="1_marcinkowska_import_files/figure-html5/unnamed-chunk-11-6.png" width="624" /></p>
<pre><code>
$rmse_bc_imputed
[1] &quot; 0.92&quot;

$fc_day_model
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(fc_day) + (1 | id) 
   Data: df (Number of observations: 1479) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sfc_day_1)     0.49      0.32     0.16     1.35 1.00     1275
               Tail_ESS
sds(sfc_day_1)     1909

Group-Level Effects: 
~id (Number of levels: 90) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.66      0.05     0.57     0.77 1.01      457
              Tail_ESS
sd(Intercept)      810

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     1.72      0.07     1.57     1.85 1.02      285      608
sfc_day_1     0.17      0.95    -2.01     1.85 1.00     1679     1531

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.55      0.01     0.53     0.58 1.00     4859     2507

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_fc
[1] &quot;0.11 [0.07;0.14]&quot;

$rmse_fc
[1] &quot;1.01 [0.98;1.04]&quot;

$r_loo_fc
[1] &quot;NaN [NaN;NaN]&quot;

$r_fc_stirn
[1] &quot; 0.05 [ 0.00; 0.11]&quot;

$r_log_fc_stirn
[1] &quot; 0.05 [ 0.00; 0.11]&quot;

$r_diff_fc_stirn
[1] &quot; 0.03 [-0.02; 0.08]&quot;

$r_log_diff_fc_stirn
[1] &quot; 0.03 [-0.02; 0.08]&quot;

$r_fc_imputed
[1] &quot; 0.08 [ 0.03; 0.14]&quot;

$r_diff_fc_imputed
[1] &quot; 0.16 [ 0.11; 0.20]&quot;

$sd_fc_imputed
[1] &quot;0.40 (61%)&quot;

$r_diff_fc_imputed_rr
[1] &quot; 0.20 [ 0.13; 0.26]&quot;

$imputed_fc_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 168 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 168 rows containing missing values (geom_point).</code></pre>
<p><img src="1_marcinkowska_import_files/figure-html5/unnamed-chunk-11-7.png" width="624" /></p>
<pre><code>
$rmse_fc_imputed
[1] &quot; 0.91&quot;

$lh_day_model
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(lh_day) + (1 | id) 
   Data: df %&gt;% filter(between(lh_day, -15, 15)) (Number of observations: 995) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(slh_day_1)     1.31      0.68     0.41     3.02 1.00     1100
               Tail_ESS
sds(slh_day_1)     1562

Group-Level Effects: 
~id (Number of levels: 61) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.68      0.06     0.56     0.81 1.01      401
              Tail_ESS
sd(Intercept)      796

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     1.75      0.09     1.57     1.93 1.02      167      479
slh_day_1    -2.04      2.10    -6.55     1.88 1.00     1371     1555

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.55      0.01     0.52     0.57 1.00     4217     3029

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_lh
[1] &quot;0.14 [0.10;0.18]&quot;

$rmse_lh
[1] &quot;1.02 [0.98;1.06]&quot;

$r_loo_lh
[1] &quot;NaN [NaN;NaN]&quot;

$r_prob_lh
[1] &quot; 0.08 [ 0.01; 0.14]&quot;

$r_log_prob_lh
[1] &quot; 0.11 [ 0.04; 0.17]&quot;

$r_diff_prob_lh
[1] &quot; 0.10 [ 0.04; 0.16]&quot;

$r_log_diff_prob_lh
[1] &quot; 0.15 [ 0.08; 0.21]&quot;

$r_lh_imputed
[1] &quot; 0.10 [ 0.04; 0.16]&quot;

$r_diff_lh_imputed
[1] &quot; 0.16 [ 0.10; 0.22]&quot;

$sd_lh_imputed
[1] &quot;0.54 (67%)&quot;

$r_diff_lh_imputed_rr
[1] &quot; 0.19 [ 0.12; 0.27]&quot;

$imputed_lh_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 652 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 652 rows containing missing values (geom_point).</code></pre>
<p><img src="1_marcinkowska_import_files/figure-html5/unnamed-chunk-11-8.png" width="624" /></p>
<pre><code>
$rmse_lh_imputed
[1] &quot; 0.98&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>marc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>bc_day</span>, <span class='va'>fc_day</span>, <span class='va'>lh_day</span>, <span class='va'>estradiol</span>, <span class='va'>progesterone</span>, <span class='va'>cycle_length</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>hormone_cens <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: dropped 23 variables (data.x, Pom1, Pom2, Avrg, St.Dev., …)</code></pre>
<pre><code>mutate (grouped): new variable &#39;hormone_cens&#39; (character) with one unique value and 0% NA</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>summarise_hormones</span><span class='op'>(</span>df <span class='op'>=</span> <span class='va'>df</span>, Dataset <span class='op'>=</span> <span class='st'>"Marcinkowska 2020"</span>, Method <span class='op'>=</span> <span class='st'>"Salivary immunoassay (DRG)"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter (grouped): removed 1,539 rows (75%), 523 rows remaining</code></pre>
<pre><code>select: dropped 25 variables (prc_wcx_bc, est_estradiol_bc, est_estradiol_bc_se, est_estradiol_bc_low, est_estradiol_bc_high, …)</code></pre>
<pre><code>Joining, by = &quot;bc_day&quot;</code></pre>
<pre><code>left_join: added one column (prc_stirn_bc)</code></pre>
<pre><code>           &gt; rows only in x    12</code></pre>
<pre><code>           &gt; rows only in y  ( 10)</code></pre>
<pre><code>           &gt; matched rows     511</code></pre>
<pre><code>           &gt;                 =====</code></pre>
<pre><code>           &gt; rows total       523</code></pre>
<pre><code>select: dropped 25 variables (prc_wcx_fc, est_estradiol_fc, est_estradiol_fc_se, est_estradiol_fc_low, est_estradiol_fc_high, …)</code></pre>
<pre><code>left_join: added one column (prc_stirn_fc)</code></pre>
<pre><code>           &gt; rows only in x    12</code></pre>
<pre><code>           &gt; rows only in y  ( 11)</code></pre>
<pre><code>           &gt; matched rows     511</code></pre>
<pre><code>           &gt;                 =====</code></pre>
<pre><code>           &gt; rows total       523</code></pre>
<pre><code>left_join: added 22 columns (conception_risk_lh, fertile_lh, est_estradiol_lh, est_estradiol_lh_se, est_estradiol_lh_low, …)</code></pre>
<pre><code>           &gt; rows only in x   168</code></pre>
<pre><code>           &gt; rows only in y  (  2)</code></pre>
<pre><code>           &gt; matched rows     355</code></pre>
<pre><code>           &gt;                 =====</code></pre>
<pre><code>           &gt; rows total       523</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed all rows (100%)</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): no rows removed</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.

Warning: Rows containing NAs were excluded from the model.

Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.

Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>$Dataset
[1] &quot;Marcinkowska 2020&quot;

$Hormone
[1] &quot;Estradiol &amp; Progesterone&quot;

$Method
[1] &quot;Salivary immunoassay (DRG)&quot;

$scatterplot</code></pre>
<pre><code>Warning: Removed 1519 rows containing missing values (geom_point).</code></pre>
<p><img src="1_marcinkowska_import_files/figure-html5/unnamed-chunk-11-9.png" width="624" /></p>
<pre><code>
$n_women
[1] 102

$n_cycles
[1] 102

$n_days
[1] 2062

$r_ep
[1] &quot; 0.33 [ 0.25; 0.40]&quot;

$r_log_ep
[1] &quot; 0.30 [ 0.22; 0.37]&quot;

$r_e_ratio
[1] &quot; 0.21 [ 0.13; 0.29]&quot;

$r_log_e_ratio
[1] &quot; 0.52 [ 0.45; 0.58]&quot;

$r_p_ratio
[1] &quot;-0.30 [-0.37;-0.22]&quot;

$r_log_p_ratio
[1] &quot;-0.66 [-0.71;-0.61]&quot;

$usable_n
[1] 523

$r_bc_ratio
[1] &quot; 0.19 [ 0.10; 0.27]&quot;

$r_bc_log_ratio
[1] &quot; 0.26 [ 0.17; 0.34]&quot;

$m_bc_prob_rat
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: prc_stirn_bc ~ log(estradiol) + log(ratio) 
   Data: df (Number of observations: 511) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept        0.27      0.02     0.22     0.32 1.00     2072
logestradiol    -0.01      0.01    -0.03     0.00 1.00     2274
logratio         0.04      0.01     0.02     0.05 1.00     2621
             Tail_ESS
Intercept        2441
logestradiol     2879
logratio         2856

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.14      0.00     0.13     0.15 1.00     2544     2580

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_erat_bc
[1] &quot;0.25 [0.14;0.32]&quot;

$m_bc_prob
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: prc_stirn_bc ~ s(log(estradiol), log(progesterone)) 
   Data: df (Number of observations: 511) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
                                    Estimate Est.Error l-95% CI
sds(slogestradiollogprogesterone_1)     0.16      0.05     0.08
                                    u-95% CI Rhat Bulk_ESS Tail_ESS
sds(slogestradiollogprogesterone_1)     0.27 1.00     1233     2119

Population-Level Effects: 
                               Estimate Est.Error l-95% CI u-95% CI
Intercept                          0.16      0.01     0.15     0.18
slogestradiollogprogesterone_1     0.13      0.26    -0.39     0.64
slogestradiollogprogesterone_2    -0.71      0.25    -1.23    -0.27
                               Rhat Bulk_ESS Tail_ESS
Intercept                      1.00     6963     2743
slogestradiollogprogesterone_1 1.00     2454     2791
slogestradiollogprogesterone_2 1.00     1980     2625

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.14      0.00     0.13     0.15 1.00     5116     2485

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_loo_bc
[1] &quot;0.32 [0.24;0.38]&quot;

$r_fc_ratio
[1] &quot; 0.09 [ 0.00; 0.17]&quot;

$r_fc_log_ratio
[1] &quot; 0.14 [ 0.05; 0.22]&quot;

$m_fc_prob_rat
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: prc_stirn_fc ~ log(estradiol) + log(ratio) 
   Data: df (Number of observations: 511) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept        0.23      0.03     0.17     0.28 1.00     2381
logestradiol    -0.01      0.01    -0.02     0.01 1.00     2658
logratio         0.02      0.01     0.01     0.04 1.00     2634
             Tail_ESS
Intercept        2046
logestradiol     2233
logratio         2202

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.16      0.01     0.15     0.17 1.00     2627     2764

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_erat_fc
[1] &quot;0.10 [NaN;0.18]&quot;

$m_fc_prob
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: prc_stirn_fc ~ s(log(estradiol), log(progesterone)) 
   Data: df (Number of observations: 511) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
                                    Estimate Est.Error l-95% CI
sds(slogestradiollogprogesterone_1)     0.18      0.05     0.09
                                    u-95% CI Rhat Bulk_ESS Tail_ESS
sds(slogestradiollogprogesterone_1)     0.29 1.00     1377     2258

Population-Level Effects: 
                               Estimate Est.Error l-95% CI u-95% CI
Intercept                          0.16      0.01     0.15     0.18
slogestradiollogprogesterone_1     0.21      0.29    -0.36     0.80
slogestradiollogprogesterone_2    -0.48      0.27    -1.02     0.05
                               Rhat Bulk_ESS Tail_ESS
Intercept                      1.00     7421     2851
slogestradiollogprogesterone_1 1.00     2361     2495
slogestradiollogprogesterone_2 1.00     2394     2871

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.15      0.00     0.14     0.16 1.00     7459     2449

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_loo_fc
[1] &quot;0.26 [0.15;0.33]&quot;

$r_lh_ratio
[1] &quot; 0.15 [ 0.04; 0.25]&quot;

$r_lh_log_ratio
[1] &quot; 0.26 [ 0.16; 0.35]&quot;

$m_lh_prob_rat
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: fertile_lh ~ log(estradiol) + log(ratio) 
   Data: df (Number of observations: 355) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept        0.34      0.06     0.22     0.45 1.00     2698
logestradiol    -0.01      0.02    -0.05     0.02 1.00     2922
logratio         0.07      0.01     0.04     0.09 1.00     2960
             Tail_ESS
Intercept        2459
logestradiol     2880
logratio         2780

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.26      0.01     0.24     0.28 1.00     2926     2351

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_erat_lh
[1] &quot;0.24 [0.07;0.33]&quot;

$m_lh_prob
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: fertile_lh ~ s(log(estradiol), log(progesterone)) 
   Data: df (Number of observations: 355) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
                                    Estimate Est.Error l-95% CI
sds(slogestradiollogprogesterone_1)     0.10      0.07     0.00
                                    u-95% CI Rhat Bulk_ESS Tail_ESS
sds(slogestradiollogprogesterone_1)     0.27 1.00     1331     1914

Population-Level Effects: 
                               Estimate Est.Error l-95% CI u-95% CI
Intercept                          0.16      0.01     0.14     0.19
slogestradiollogprogesterone_1     0.61      0.32     0.02     1.33
slogestradiollogprogesterone_2    -0.74      0.31    -1.32    -0.06
                               Rhat Bulk_ESS Tail_ESS
Intercept                      1.00     8108     2961
slogestradiollogprogesterone_1 1.00     3092     2060
slogestradiollogprogesterone_2 1.00     3279     2477

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.26      0.01     0.24     0.28 1.00     7158     3277

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_loo_lh
[1] &quot;0.23 [0.04;0.32]&quot;</code></pre>
</div>
<div class="sourceCode" id="cb783"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
