<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Salivary and serum immunoassay comparison: Göttingen Lab Study 2</title>



  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-10-02"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-10-02"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Salivary and serum immunoassay comparison: Göttingen Lab Study 2"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Salivary and serum immunoassay comparison"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Salivary and serum immunoassay comparison: Göttingen Lab Study 2"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Göttingen Lab Study 2"]},{"type":"character","attributes":{},"value":["10/02/2021"]},{"type":"character","attributes":{},"value":["html_document"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
  <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Göttingen Lab Study 2","authors":[],"publishedDate":"2021-10-02T00:00:00.000+00:00"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Göttingen Lab Study 2</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>


<div class="d-article">
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gol</span> <span class='op'>&lt;-</span> <span class='fu'>rio</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rio/man/import.html'>import</a></span><span class='op'>(</span><span class='st'>"https://osf.io/69jrk/download"</span>, format <span class='op'>=</span> <span class='st'>"csv"</span><span class='op'>)</span>
<span class='va'>gol_otherhormones</span> <span class='op'>&lt;-</span> <span class='fu'>rio</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rio/man/import.html'>import</a></span><span class='op'>(</span><span class='st'>"data/gol2/Hormonwerte.xlsx"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>as_tibble</span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>gol_otherhormones</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>gol_otherhormones</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='st'>"\\s+"</span>, <span class='st'>" "</span><span class='op'>)</span>
<span class='va'>gol_dates</span> <span class='op'>&lt;-</span> <span class='fu'>rio</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rio/man/import.html'>import</a></span><span class='op'>(</span><span class='st'>"data/gol2/DatenZyklus2_Ruben.xlsx"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>as_tibble</span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>mons</span> <span class='op'>&lt;-</span> <span class='va'>gol_dates</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>Person</span>, <span class='va'>Date_session</span>, <span class='va'>Date_next_menstrual_onset</span>, <span class='va'>Date_last_menstrual_onset</span><span class='op'>)</span>
<span class='va'>mons</span> <span class='op'>&lt;-</span> <span class='fu'>bind_rows</span><span class='op'>(</span><span class='va'>mons</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>Person</span>, <span class='va'>Date_session</span>, Menstrual_onset <span class='op'>=</span> <span class='va'>Date_next_menstrual_onset</span><span class='op'>)</span>, 
                  <span class='va'>mons</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>Person</span>, <span class='va'>Date_session</span>, Menstrual_onset <span class='op'>=</span> <span class='va'>Date_last_menstrual_onset</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>Date_session <span class='op'>=</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='https://lubridate.tidyverse.org/reference/ymd.html'>dmy</a></span><span class='op'>(</span><span class='va'>Date_session</span><span class='op'>)</span>, 
         Menstrual_onset <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='va'>Menstrual_onset</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>drop_na</span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>menstrual_days</span> <span class='op'>=</span> <span class='va'>mons</span> <span class='op'>%&gt;%</span> <span class='fu'>distinct</span><span class='op'>(</span><span class='va'>Person</span>, <span class='va'>Date_session</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>Person</span>, <span class='va'>Date_session</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='co'># step 2 expand into time-series for participant</span>
  <span class='fu'>full_join</span><span class='op'>(</span><span class='va'>mons</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Date_session <span class='op'>=</span> <span class='va'>Menstrual_onset</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Person"</span>, <span class='st'>"Date_session"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>origin <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>Date_session</span> <span class='op'>!=</span> <span class='va'>Menstrual_onset</span>, <span class='st'>"lab"</span>, <span class='st'>"onset"</span>, <span class='st'>"lab"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Person</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>complete</span><span class='op'>(</span><span class='va'>Person</span>, Date_session <span class='op'>=</span> <span class='fu'>full_seq</span><span class='op'>(</span><span class='va'>Date_session</span>, period <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>origin <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>origin</span><span class='op'>)</span>, <span class='st'>"interpolated"</span>, <span class='va'>origin</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>menstrual_days</span> <span class='op'>=</span> <span class='va'>menstrual_days</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>Person</span>, <span class='va'>Date_session</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Person</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>
    <span class='co'># carry the last observation (the last observed menstrual onset) backward/forward (within person), but we don't do this if we'd bridge more than 40 days this way</span>
    <span class='co'># first we carry it backward (because reporting is retrospective)</span>
    next_menstrual_onset <span class='op'>=</span> <span class='fu'>rcamisc</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rcamisc/man/repeat_last.html'>repeat_last</a></span><span class='op'>(</span><span class='va'>Menstrual_onset</span>, forward <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>,
    <span class='co'># then we carry it forward</span>
    last_menstrual_onset <span class='op'>=</span> <span class='fu'>rcamisc</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rcamisc/man/repeat_last.html'>repeat_last</a></span><span class='op'>(</span><span class='va'>Menstrual_onset</span><span class='op'>)</span>,
    <span class='co'># in the next cycle, count to the next onset, not the last</span>
    next_menstrual_onset <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>next_menstrual_onset</span> <span class='op'>==</span> <span class='va'>last_menstrual_onset</span>,
                                   <span class='fu'>lead</span><span class='op'>(</span><span class='va'>next_menstrual_onset</span><span class='op'>)</span>,
                                   <span class='va'>next_menstrual_onset</span><span class='op'>)</span>,
    <span class='co'># calculate the diff to current date</span>
    menstrual_onset_days_until <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>Date_session</span> <span class='op'>-</span> <span class='va'>next_menstrual_onset</span><span class='op'>)</span>,
    menstrual_onset_days_since <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>Date_session</span> <span class='op'>-</span> <span class='va'>last_menstrual_onset</span><span class='op'>)</span>
    <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Person</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>cycle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>last_menstrual_onset</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>menstrual_days</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Person</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>origin</span> <span class='op'>==</span> <span class='st'>"lab"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>summarise</span><span class='op'>(</span>cycles <span class='op'>=</span> <span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>last_menstrual_onset</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>summarise</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>cycles</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1 × 1
  `mean(cycles)`
           &lt;dbl&gt;
1           1.74</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># menstrual_days %&gt;% filter(cycle == 5)</span>
<span class='co'># menstrual_days %&gt;% filter(Person == 486) %&gt;% filter(origin == "lab") %&gt;% View</span>

<span class='va'>gol_dates</span> <span class='op'>&lt;-</span> <span class='va'>gol_dates</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>
    Date_session <span class='op'>=</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='https://lubridate.tidyverse.org/reference/ymd.html'>dmy</a></span><span class='op'>(</span><span class='va'>Date_session</span><span class='op'>)</span>,
    lh_day <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>Date_session</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='va'>Date_LH_surge</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>menstrual_days</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Person"</span>, <span class='st'>"Date_session"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>cycle_length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>next_menstrual_onset</span><span class='op'>-</span><span class='va'>last_menstrual_onset</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>bc_day <span class='op'>=</span> <span class='va'>menstrual_onset_days_until</span>,
         fc_day <span class='op'>=</span> <span class='va'>menstrual_onset_days_since</span><span class='op'>)</span>


<span class='va'>gol</span> <span class='op'>&lt;-</span> <span class='va'>gol</span> <span class='op'>%&gt;%</span> <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>gol_dates</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Person"</span>, <span class='st'>"Session"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># gol %&gt;% filter(bc_day &gt; -1) %&gt;% select(bc_day, Date_session, Date_LH_surge, Date_next_menstrual_onset, Date_last_menstrual_onset) %&gt;% View</span>

<span class='va'>gol</span> <span class='op'>&lt;-</span> <span class='va'>gol</span> <span class='op'>%&gt;%</span> <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>gol_otherhormones</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Person"</span>, <span class='st'>"Session"</span> <span class='op'>=</span> <span class='st'>"SessionNr"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>gol</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>logE <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>`estradiol pg/ml`</span><span class='op'>)</span>, 
         logP <span class='op'>=</span>  <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>`progesterone pg/ml`</span><span class='op'>)</span>, logE_P <span class='op'>=</span> <span class='va'>logE</span><span class='op'>-</span><span class='va'>logP</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Person</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>conception_risk</span>, <span class='va'>logE</span>, <span class='va'>logP</span>, <span class='va'>logE_P</span>, 
         estradiol <span class='op'>=</span> <span class='va'>`estradiol pg/ml`</span>, 
         progesterone <span class='op'>=</span> <span class='va'>`progesterone pg/ml`</span>, 
         <span class='va'>E_P</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span>use <span class='op'>=</span> <span class='st'>"pairwise"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                conception_risk logE  logP logE_P estradiol
conception_risk            1.00 0.05 -0.38   0.38      0.04
logE                       0.05 1.00  0.04   0.24      0.94
logP                      -0.38 0.04  1.00  -0.96      0.02
logE_P                     0.38 0.24 -0.96   1.00      0.24
estradiol                  0.04 0.94  0.02   0.24      1.00
progesterone              -0.28 0.03  0.71  -0.68      0.02
E_P                        0.23 0.25 -0.66   0.71      0.29
                progesterone   E_P
conception_risk        -0.28  0.23
logE                    0.03  0.25
logP                    0.71 -0.66
logE_P                 -0.68  0.71
estradiol               0.02  0.29
progesterone            1.00 -0.30
E_P                    -0.30  1.00</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>gol</span><span class='op'>$</span><span class='va'>lh_day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -34  18</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>gol</span><span class='op'>$</span><span class='va'>bc_day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -63  -1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>gol</span><span class='op'>$</span><span class='va'>fc_day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  0 35</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>gol</span><span class='op'>$</span><span class='va'>`estradiol pg/ml`</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 1027</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>gol</span><span class='op'>$</span><span class='va'>`progesterone pg/ml`</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 868</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>gol</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>lh_day</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>progesterone</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>15</span>,<span class='fl'>15</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 453 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 453 rows containing missing values (geom_point).</code></pre>
<img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-1-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>gol</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>lh_day</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>estradiol</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>15</span>,<span class='fl'>15</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 347 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 347 rows containing missing values (geom_point).</code></pre>
<img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-1-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>gol</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>bc_day</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>progesterone</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>29</span>,<span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 195 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 195 rows containing missing values (geom_point).</code></pre>
<img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-1-3.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>gol</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>bc_day</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>estradiol</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>29</span>,<span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 45 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 45 rows containing missing values (geom_point).</code></pre>
<img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-1-4.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>gol</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>lh_day</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>`testosterone pg/ml`</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>15</span>,<span class='fl'>15</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 614 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 614 rows containing missing values (geom_point).</code></pre>
<img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-1-5.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>gol</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>lh_day</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>`DHEAs pg/ml`</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>15</span>,<span class='fl'>15</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 347 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 347 rows containing missing values (geom_point).</code></pre>
<img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-1-6.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>gol</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>lh_day</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>`corticosterone pg/ml`</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>15</span>,<span class='fl'>15</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 936 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 936 rows containing missing values (geom_point).</code></pre>
<img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-1-7.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>gol</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>lh_day</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>`cortisone ng/ml`</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>15</span>,<span class='fl'>15</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 347 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 347 rows containing missing values (geom_point).</code></pre>
<img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-1-8.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>gol</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>lh_day</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>`cortisol nmol/L`</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>15</span>,<span class='fl'>15</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 347 rows containing non-finite values (stat_smooth).

Warning: Removed 347 rows containing missing values (geom_point).</code></pre>
<img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-1-9.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>gol</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>bc_day</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>`testosterone pg/ml`</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>30</span>,<span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 454 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 454 rows containing missing values (geom_point).</code></pre>
<img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-1-10.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>gol</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>bc_day</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>`DHEAs pg/ml`</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>30</span>,<span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 39 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 39 rows containing missing values (geom_point).</code></pre>
<img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-1-11.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>gol</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>bc_day</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>`corticosterone pg/ml`</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>30</span>,<span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 898 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 898 rows containing missing values (geom_point).</code></pre>
<img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-1-12.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>gol</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>bc_day</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>`cortisone ng/ml`</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>30</span>,<span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 39 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 39 rows containing missing values (geom_point).</code></pre>
<img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-1-13.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>gol</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>bc_day</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>`cortisol nmol/L`</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>30</span>,<span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>Warning: Removed 39 rows containing non-finite values (stat_smooth).

Warning: Removed 39 rows containing missing values (geom_point).</code></pre>
<img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-1-14.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/icc.html'>icc</a></span><span class='op'>(</span><span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='va'>`testosterone pg/ml`</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>Person</span><span class='op'>)</span>, <span class='va'>gol</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.386
  Conditional ICC: 0.386</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># between-subject mean cors</span>
<span class='va'>gol</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>Person</span>, <span class='fu'>contains</span><span class='op'>(</span><span class='st'>"/"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Person</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>summarise_all</span><span class='op'>(</span><span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>.</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>Person</span><span class='op'>)</span> <span class='op'>%&gt;%</span>  <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span>use<span class='op'>=</span><span class='st'>'p'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                     cortisol nmol/L cortisone ng/ml
cortisol nmol/L                 1.00            0.10
cortisone ng/ml                 0.10            1.00
testosterone pg/ml              0.04            0.16
progesterone pg/ml             -0.06           -0.15
DHEAs pg/ml                     0.00            0.08
corticosterone pg/ml            0.21            0.36
estradiol pg/ml                -0.02            0.16
                     testosterone pg/ml progesterone pg/ml
cortisol nmol/L                    0.04              -0.06
cortisone ng/ml                    0.16              -0.15
testosterone pg/ml                 1.00              -0.03
progesterone pg/ml                -0.03               1.00
DHEAs pg/ml                        0.13               0.02
corticosterone pg/ml               0.30              -0.09
estradiol pg/ml                    0.05               0.06
                     DHEAs pg/ml corticosterone pg/ml estradiol pg/ml
cortisol nmol/L             0.00                 0.21           -0.02
cortisone ng/ml             0.08                 0.36            0.16
testosterone pg/ml          0.13                 0.30            0.05
progesterone pg/ml          0.02                -0.09            0.06
DHEAs pg/ml                 1.00                 0.07            0.01
corticosterone pg/ml        0.07                 1.00            0.01
estradiol pg/ml             0.01                 0.01            1.00</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># within-sub diff cors</span>
<span class='va'>gol</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>Person</span>, <span class='fu'>contains</span><span class='op'>(</span><span class='st'>"/"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Person</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate_all</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>.</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>.</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>Person</span><span class='op'>)</span> <span class='op'>%&gt;%</span>  <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span>use<span class='op'>=</span><span class='st'>'p'</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`mutate_all()` ignored the following grouping variables:
Column `Person`
Use `mutate_at(df, vars(-group_cols()), myoperation)` to silence the message.</code></pre>
<pre><code>                     cortisol nmol/L cortisone ng/ml
cortisol nmol/L                 1.00            0.02
cortisone ng/ml                 0.02            1.00
testosterone pg/ml              0.03            0.19
progesterone pg/ml              0.00           -0.07
DHEAs pg/ml                     0.01            0.17
corticosterone pg/ml            0.04            0.37
estradiol pg/ml                -0.01            0.03
                     testosterone pg/ml progesterone pg/ml
cortisol nmol/L                    0.03               0.00
cortisone ng/ml                    0.19              -0.07
testosterone pg/ml                 1.00              -0.07
progesterone pg/ml                -0.07               1.00
DHEAs pg/ml                        0.11               0.06
corticosterone pg/ml               0.28              -0.08
estradiol pg/ml                   -0.02               0.01
                     DHEAs pg/ml corticosterone pg/ml estradiol pg/ml
cortisol nmol/L             0.01                 0.04           -0.01
cortisone ng/ml             0.17                 0.37            0.03
testosterone pg/ml          0.11                 0.28           -0.02
progesterone pg/ml          0.06                -0.08            0.01
DHEAs pg/ml                 1.00                 0.10           -0.02
corticosterone pg/ml        0.10                 1.00            0.13
estradiol pg/ml            -0.02                 0.13            1.00</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gol</span> <span class='op'>&lt;-</span> <span class='va'>gol</span> <span class='op'>%&gt;%</span> <span class='fu'>rename</span><span class='op'>(</span>id <span class='op'>=</span> <span class='va'>Person</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>cycle_length</span>, <span class='va'>bc_day</span>, <span class='va'>fc_day</span>, <span class='va'>lh_day</span>, <span class='va'>estradiol</span>, <span class='va'>progesterone</span>, <span class='fu'>everything</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>as_tibble</span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='va'>gol</span><span class='op'>$</span><span class='va'>estradiol</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   [1]  1.01  1.05  1.07  1.14  1.15  1.17  1.24  1.25  1.28  1.31
  [11]  1.31  1.32  1.34  1.40  1.43  1.43  1.43  1.44  1.47  1.48
  [21]  1.48  1.49  1.50  1.50  1.50  1.50  1.50  1.53  1.54  1.55
  [31]  1.58  1.58  1.59  1.60  1.61  1.62  1.62  1.64  1.64  1.66
  [41]  1.66  1.66  1.69  1.69  1.69  1.69  1.70  1.70  1.71  1.71
  [51]  1.73  1.74  1.74  1.74  1.75  1.75  1.75  1.76  1.76  1.76
  [61]  1.76  1.77  1.77  1.78  1.78  1.79  1.79  1.79  1.80  1.81
  [71]  1.81  1.81  1.81  1.82  1.82  1.83  1.84  1.85  1.85  1.85
  [81]  1.85  1.86  1.86  1.86  1.87  1.88  1.88  1.88  1.90  1.91
  [91]  1.91  1.91  1.92  1.92  1.92  1.93  1.93  1.93  1.94  1.95
 [101]  1.96  1.97  1.98  1.98  1.98  1.99  2.00  2.00  2.01  2.01
 [111]  2.02  2.03  2.04  2.04  2.04  2.04  2.05  2.06  2.06  2.08
 [121]  2.08  2.08  2.09  2.10  2.11  2.11  2.12  2.12  2.13  2.13
 [131]  2.13  2.14  2.14  2.15  2.16  2.16  2.17  2.18  2.18  2.19
 [141]  2.19  2.19  2.19  2.20  2.21  2.22  2.22  2.23  2.23  2.23
 [151]  2.24  2.24  2.25  2.25  2.26  2.27  2.27  2.28  2.28  2.29
 [161]  2.29  2.32  2.32  2.32  2.32  2.33  2.34  2.35  2.35  2.35
 [171]  2.36  2.36  2.37  2.37  2.37  2.38  2.38  2.39  2.40  2.40
 [181]  2.40  2.42  2.42  2.43  2.43  2.43  2.43  2.44  2.44  2.44
 [191]  2.44  2.44  2.44  2.45  2.45  2.45  2.45  2.46  2.46  2.47
 [201]  2.47  2.48  2.48  2.49  2.49  2.50  2.51  2.51  2.51  2.51
 [211]  2.52  2.52  2.54  2.54  2.54  2.54  2.54  2.55  2.55  2.55
 [221]  2.55  2.56  2.56  2.56  2.57  2.57  2.57  2.58  2.58  2.59
 [231]  2.60  2.60  2.61  2.61  2.62  2.62  2.62  2.63  2.63  2.64
 [241]  2.65  2.65  2.65  2.66  2.66  2.67  2.67  2.68  2.69  2.69
 [251]  2.69  2.69  2.70  2.70  2.70  2.70  2.70  2.71  2.71  2.72
 [261]  2.72  2.72  2.73  2.73  2.73  2.73  2.75  2.75  2.76  2.77
 [271]  2.77  2.79  2.79  2.80  2.80  2.82  2.82  2.82  2.82  2.83
 [281]  2.84  2.84  2.84  2.84  2.86  2.86  2.87  2.87  2.88  2.88
 [291]  2.89  2.89  2.89  2.90  2.92  2.92  2.93  2.93  2.93  2.93
 [301]  2.94  2.94  2.95  2.95  2.96  2.96  2.97  2.97  2.97  2.98
 [311]  2.98  2.98  2.99  3.00  3.00  3.00  3.01  3.01  3.01  3.02
 [321]  3.02  3.02  3.03  3.03  3.03  3.04  3.04  3.05  3.05  3.05
 [331]  3.06  3.07  3.07  3.08  3.09  3.09  3.09  3.09  3.10  3.12
 [341]  3.13  3.14  3.14  3.14  3.15  3.15  3.16  3.16  3.16  3.16
 [351]  3.17  3.18  3.19  3.19  3.20  3.20  3.21  3.21  3.22  3.23
 [361]  3.23  3.23  3.24  3.24  3.24  3.24  3.24  3.24  3.25  3.25
 [371]  3.25  3.25  3.26  3.26  3.26  3.27  3.27  3.27  3.28  3.29
 [381]  3.30  3.30  3.30  3.31  3.31  3.31  3.32  3.33  3.34  3.34
 [391]  3.34  3.34  3.34  3.34  3.35  3.35  3.35  3.36  3.36  3.37
 [401]  3.37  3.37  3.37  3.37  3.37  3.38  3.38  3.38  3.38  3.38
 [411]  3.38  3.38  3.38  3.38  3.39  3.40  3.40  3.40  3.40  3.41
 [421]  3.41  3.41  3.42  3.42  3.43  3.43  3.43  3.44  3.44  3.44
 [431]  3.44  3.45  3.45  3.45  3.45  3.45  3.45  3.45  3.45  3.46
 [441]  3.46  3.47  3.47  3.47  3.47  3.48  3.48  3.48  3.48  3.48
 [451]  3.49  3.49  3.49  3.50  3.50  3.50  3.51  3.51  3.51  3.51
 [461]  3.52  3.53  3.54  3.54  3.54  3.54  3.55  3.55  3.57  3.57
 [471]  3.58  3.58  3.59  3.59  3.60  3.60  3.60  3.60  3.60  3.61
 [481]  3.61  3.61  3.61  3.61  3.62  3.62  3.63  3.64  3.64  3.64
 [491]  3.64  3.64  3.64  3.64  3.66  3.66  3.67  3.67  3.67  3.67
 [501]  3.68  3.68  3.68  3.68  3.68  3.69  3.69  3.69  3.70  3.70
 [511]  3.70  3.71  3.71  3.71  3.71  3.72  3.72  3.72  3.73  3.73
 [521]  3.73  3.74  3.74  3.75  3.75  3.75  3.75  3.75  3.76  3.76
 [531]  3.77  3.77  3.78  3.78  3.78  3.79  3.79  3.79  3.80  3.80
 [541]  3.81  3.81  3.81  3.81  3.81  3.82  3.82  3.83  3.83  3.83
 [551]  3.83  3.84  3.84  3.84  3.85  3.86  3.87  3.87  3.88  3.88
 [561]  3.89  3.89  3.89  3.90  3.90  3.91  3.91  3.91  3.91  3.91
 [571]  3.93  3.93  3.94  3.94  3.94  3.94  3.95  3.95  3.95  3.95
 [581]  3.95  3.95  3.96  3.96  3.96  3.97  3.98  3.98  3.98  3.99
 [591]  3.99  3.99  3.99  4.00  4.00  4.01  4.01  4.01  4.01  4.01
 [601]  4.02  4.02  4.03  4.04  4.04  4.04  4.04  4.06  4.06  4.06
 [611]  4.07  4.07  4.07  4.07  4.08  4.08  4.08  4.09  4.09  4.09
 [621]  4.10  4.11  4.11  4.11  4.11  4.11  4.11  4.12  4.12  4.14
 [631]  4.14  4.15  4.15  4.15  4.15  4.16  4.16  4.16  4.17  4.18
 [641]  4.18  4.18  4.18  4.19  4.19  4.19  4.20  4.20  4.23  4.23
 [651]  4.24  4.24  4.25  4.25  4.25  4.25  4.25  4.25  4.26  4.26
 [661]  4.27  4.27  4.27  4.27  4.28  4.28  4.29  4.29  4.29  4.29
 [671]  4.29  4.29  4.31  4.33  4.33  4.33  4.34  4.35  4.36  4.36
 [681]  4.37  4.38  4.39  4.39  4.39  4.39  4.40  4.40  4.40  4.41
 [691]  4.42  4.42  4.42  4.42  4.42  4.43  4.43  4.43  4.44  4.44
 [701]  4.44  4.45  4.45  4.45  4.46  4.46  4.46  4.47  4.49  4.49
 [711]  4.49  4.49  4.50  4.50  4.51  4.51  4.52  4.52  4.52  4.52
 [721]  4.53  4.53  4.53  4.54  4.54  4.54  4.55  4.56  4.56  4.56
 [731]  4.57  4.58  4.58  4.59  4.59  4.59  4.59  4.59  4.60  4.62
 [741]  4.63  4.63  4.63  4.64  4.65  4.67  4.68  4.68  4.69  4.70
 [751]  4.71  4.71  4.72  4.72  4.72  4.73  4.74  4.74  4.75  4.75
 [761]  4.77  4.78  4.78  4.78  4.79  4.80  4.81  4.83  4.83  4.84
 [771]  4.85  4.86  4.86  4.87  4.87  4.88  4.89  4.90  4.91  4.92
 [781]  4.93  4.94  4.95  4.95  4.96  4.97  4.97  4.97  4.98  4.99
 [791]  5.00  5.00  5.03  5.03  5.04  5.04  5.05  5.05  5.06  5.06
 [801]  5.06  5.07  5.07  5.07  5.08  5.08  5.08  5.09  5.09  5.10
 [811]  5.11  5.13  5.13  5.13  5.14  5.14  5.14  5.15  5.16  5.16
 [821]  5.17  5.17  5.17  5.18  5.19  5.20  5.20  5.21  5.22  5.23
 [831]  5.25  5.25  5.25  5.25  5.25  5.25  5.26  5.27  5.28  5.28
 [841]  5.30  5.32  5.32  5.32  5.33  5.33  5.34  5.35  5.35  5.35
 [851]  5.35  5.36  5.37  5.40  5.40  5.41  5.42  5.43  5.44  5.45
 [861]  5.46  5.47  5.47  5.47  5.48  5.50  5.50  5.50  5.52  5.55
 [871]  5.55  5.59  5.59  5.60  5.60  5.61  5.62  5.64  5.65  5.66
 [881]  5.66  5.67  5.67  5.68  5.68  5.69  5.69  5.69  5.71  5.71
 [891]  5.75  5.76  5.76  5.78  5.80  5.81  5.81  5.82  5.84  5.85
 [901]  5.85  5.85  5.85  5.86  5.87  5.88  5.88  5.91  5.91  5.91
 [911]  5.92  5.92  5.92  5.95  5.99  6.00  6.00  6.00  6.02  6.02
 [921]  6.03  6.04  6.05  6.06  6.06  6.07  6.08  6.08  6.08  6.10
 [931]  6.12  6.12  6.13  6.17  6.17  6.19  6.19  6.19  6.21  6.22
 [941]  6.23  6.25  6.28  6.29  6.33  6.35  6.36  6.37  6.38  6.38
 [951]  6.44  6.49  6.51  6.52  6.54  6.55  6.56  6.57  6.60  6.62
 [961]  6.63  6.65  6.72  6.75  6.77  6.77  6.81  6.85  6.87  6.89
 [971]  6.89  6.97  7.00  7.07  7.10  7.12  7.13  7.15  7.15  7.16
 [981]  7.20  7.34  7.34  7.34  7.37  7.49  7.50  7.55  7.56  7.61
 [991]  7.67  7.73  7.76  7.80  7.84  7.96  7.98  8.24  8.36  8.43
[1001]  8.45  8.53  8.74  8.86  8.99  9.03  9.25  9.27  9.43  9.55
[1011]  9.62  9.68  9.85  9.86  9.92 10.19 10.48 11.65 11.73 12.10
[1021] 12.10 12.21 12.43 15.42 15.63 16.66 19.05</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gol</span> <span class='op'>&lt;-</span> <span class='va'>gol</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>estradiol_cens <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>estradiol</span> <span class='op'>&lt;=</span> <span class='fl'>2.1</span>, <span class='st'>"left"</span>, <span class='st'>"none"</span><span class='op'>)</span>
<span class='co'>#    estradiol = if_else(estradiol_cens == "left", 0.6, estradiol)</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>
    progesterone_cens <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>progesterone</span> <span class='op'>&lt;=</span> <span class='fl'>0</span>, <span class='st'>"left"</span>, <span class='st'>"none"</span><span class='op'>)</span>,
    progesterone <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>progesterone_cens</span> <span class='op'>==</span> <span class='st'>"left"</span>, <span class='fl'>0</span>, <span class='va'>progesterone</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='va'>gol</span> <span class='op'>&lt;-</span> <span class='va'>gol</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>partner <span class='op'>=</span> <span class='fu'>recode</span><span class='op'>(</span><span class='va'>relationship_status</span>, `-1` <span class='op'>=</span> <span class='fl'>0L</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>gol</span>, <span class='st'>"gol2.rds"</span><span class='op'>)</span>

<span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>gol</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 257</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gol_cycles</span> <span class='op'>&lt;-</span> <span class='va'>gol</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>cycle_length</span><span class='op'>)</span> <span class='op'>|</span> <span class='fu'>between</span><span class='op'>(</span><span class='va'>cycle_length</span>, <span class='fl'>20</span>, <span class='fl'>35</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>gol_cycles</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 243</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gol_cycles_e</span> <span class='op'>&lt;-</span> <span class='va'>gol_cycles</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>estradiol</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>gol_cycles_e</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 243</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gol_cycles_p</span> <span class='op'>&lt;-</span> <span class='va'>gol_cycles</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>progesterone</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>gol_cycles_p</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 238</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gol</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>progesterone</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 2 × 1
# Groups:   id [2]
     id
  &lt;dbl&gt;
1   377
2   457</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gol</span> <span class='op'>%&gt;%</span> <span class='fu'>summarise</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>estradiol</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>progesterone</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1 × 2
  `sum(is.na(estradiol))` `sum(is.na(progesterone))`
                    &lt;int&gt;                      &lt;int&gt;
1                       1                        160</code></pre>
</div>
<h2 id="export">Export</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/source.html'>source</a></span><span class='op'>(</span><span class='st'>"0_summary_functions.R"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Loading required package: Rcpp</code></pre>
<pre><code>Loading &#39;brms&#39; package (version 2.16.2). Useful instructions
can be found by typing help(&#39;brms&#39;). A more detailed introduction
to the package is available through vignette(&#39;brms_overview&#39;).</code></pre>
<pre><code>
Attaching package: &#39;brms&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:stats&#39;:

    ar</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>export_anon</span><span class='op'>(</span><span class='st'>"stern2020"</span>, <span class='va'>gol</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="summarize">Summarize</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gol2</span> <span class='op'>&lt;-</span> <span class='fu'>rio</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rio/man/import.html'>import</a></span><span class='op'>(</span><span class='st'>"gol2.rds"</span><span class='op'>)</span>
<span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>gol2</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>bc_day</span>, <span class='va'>fc_day</span>, <span class='va'>lh_day</span>, hormone <span class='op'>=</span> <span class='va'>progesterone</span>, <span class='va'>cycle_length</span>, hormone_cens <span class='op'>=</span> <span class='va'>progesterone_cens</span>, <span class='va'>age</span>, <span class='va'>partner</span><span class='op'>)</span>

<span class='fu'>summarise_hormone</span><span class='op'>(</span>df <span class='op'>=</span> <span class='va'>df</span>, Dataset <span class='op'>=</span> <span class='st'>"GOL2"</span>, 
                  Hormone <span class='op'>=</span> <span class='st'>"Progesterone"</span>, 
                  Method <span class='op'>=</span> <span class='st'>"Salivary liquid chromatography–mass spectrometry"</span>,
                  Citation <span class='op'>=</span> <span class='st'>"Stern, J., Kordsmeyer, T. L., &amp; Penke, L. (2021). A longitudinal evaluation of ovulatory cycle shifts in women’s mate attraction and preferences. Hormones and Behavior, 128, 104916. https://doi.org/10.1016/j.yhbeh.2020.104916"</span>,
                  LOQ <span class='op'>=</span> <span class='fl'>5</span>,
                  CV_intra <span class='op'>=</span> <span class='fl'>10.8</span>,
                  CV_inter <span class='op'>=</span> <span class='fl'>9.7</span>,
                  Procedure <span class='op'>=</span> <span class='st'>[1329 chars quoted with '"']</span>,
                  Scheduling <span class='op'>=</span> <span class='st'>[1073 chars quoted with '"']</span>, 
                  LH_test <span class='op'>=</span> <span class='st'>"highly sensitive (10mIU) LH urine ovulation test strips from MedNet GmbH. Participants started LH-testing after menstruation (around reverse cycle day 21) and continued until a rise of LH (positive tests) was observed and a minimum of two days after the tests were negative again (as suggested by Roney, 2018b). Participants were provided with a minimum of ten LH tests each and provided daily pictures of the tests to the investigators for confir- mation. LH results were used to allow flexible scheduling in case LH test results differed from the scheduling based on counting (see supplementary material for details)."</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`summarise()` has grouped output by &#39;id&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>Joining, by = &quot;bc_day&quot;</code></pre>
<pre><code>`summarise()` has grouped output by &#39;id&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.

Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.

Warning: Results may not be meaningful for censored models.

Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>$Dataset
[1] &quot;GOL2&quot;

$Citation
[1] &quot;Stern, J., Kordsmeyer, T. L., &amp; Penke, L. (2021). A longitudinal evaluation of ovulatory cycle shifts in women’s mate attraction and preferences. Hormones and Behavior, 128, 104916. https://doi.org/10.1016/j.yhbeh.2020.104916&quot;

$Hormone
[1] &quot;Progesterone&quot;

$Method
[1] &quot;Salivary liquid chromatography–mass spectrometry&quot;

$`Limit of detection`
[1] NA

$LOQ
[1] 5

$`Intraassay CV`
[1] 10.8

$`Interassay CV`
[1] 9.7

$Procedure
[1] &quot;For hormone assays, we collected four saliva samples from each participant (one per testing session). Contamination of saliva samples was minimized by asking participants to abstain from eating, drinking (except plain water), smoking, chewing gum, or brushing teeth for at least one hour before each session. The samples were stored at − 80 ◦C directly after collection until shipment on dry ice to the Kirschbaum Lab at Technical University of Dresden, Germany (one freeze-thaw cycle), where progesterone was assessed via liquid chromatography mass spectrometry (LCMS, Gao et al., 2015). Liquid to liquid extraction was carried out by adding 20 μL internal stan- dard and 1 mL ethyl acetate to 400 μL saliva in a 2 mL polypropylene tube. The resulting mixture was subsequently rotated for 1 min on the vortex and then centrifuged for 10 min at 12000 r/min with centrifuge (Hettich, MIKRO 22 R). The ethyl acetate layer was transported to a new glass tube and evaporated to dryness under nitrogen. The residue was resuspended in 120 μL methanol/ water in a ratio of 50:50 (v/v), 50 μL of which was injected into the LC-MS/MS system. The LC-MS/MS system consisted of Shimadzu HPLC system, and AB Sciex Triple Quad 6500+ System equipped with the electrospray ionization (ESI) source. See Gao et al. (2015) for more details.&quot;

$Scheduling
[1] &quot;peri-ovulatory (2x), mid-luteal und premenstrual &#39;Sessions two to five were computer-based testing sessions and took place across different phases of the ovulatory cycle, scheduled based on backward counting and the observed LH test surge. Suitable testing days were computed with the help of an Excel sheet created for that purpose (see open material). All participants completed two sessions in their expected fertile phase (mid to late follicular phase, approx. 5–6 days before ovulation) and two sessions in their expected luteal phase (one session in the mid luteal phase, one session in the premenstrual phase). Scheduling was validated via LH test results and via following up to the day of the next menstrual onset. Details can be found in the supple- mentary material. The starting session for each participant depended on their current cycle phase at the introductory session and their personal schedule. Of all participants who finished all sessions, 134 participants started with the first session in their fertile phase, and 123 started in the luteal phase.&#39;&quot;

$LH_test
[1] &quot;highly sensitive (10mIU) LH urine ovulation test strips from MedNet GmbH. Participants started LH-testing after menstruation (around reverse cycle day 21) and continued until a rise of LH (positive tests) was observed and a minimum of two days after the tests were negative again (as suggested by Roney, 2018b). Participants were provided with a minimum of ten LH tests each and provided daily pictures of the tests to the investigators for confir- mation. LH results were used to allow flexible scheduling in case LH test results differed from the scheduling based on counting (see supplementary material for details).&quot;

$distribution</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 160 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-3-1.png" width="624" /></p>
<pre><code>
$mean
[1] 27.97099

$logmean
[1] 2.255996

$logsd
[1] 1.488396

$median
[1] 7.45

$sd
[1] 52.66759

$mad
[1] 8.554602

$range
[1] &quot;0.22, 671.77&quot;

$missing
[1] 160

$outliers
[1] 0

$censored
[1] 0

$n_women
[1] 257

$n_cycles
[1] 454

$n_days
[1] 1028

$age
[1] &quot;23.1±3.28&quot;

$in_relationship
[1] &quot;47%&quot;

$cycle_length
[1] &quot;30.0±4.75&quot;

$usable_n
[1] 778

$usable_n_women
[1] 238

$no_lh_surge_woman
[1] &quot;50/238 (21%)&quot;

$no_lh_surge_cycle
[1] &quot;134/377 (36%)&quot;

$var_id_loo
[1] &quot;-0.00 [-0.01;-0.00]&quot;

$var_cycle_loo
[1] &quot;-0.00 [-0.01;0.00]&quot;

$var_id
[1] &quot;0.10 [0.00;0.27] (1%)&quot;

$var_cycle
[1] &quot;0.27 [0.02;0.53] (4%)&quot;

$var_resid
[1] &quot;1.46 [1.38;1.55] (95%)&quot;

$bc_day_model
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(bc_day) + (1 | id) + (1 | id:cycle) 
   Data: df (Number of observations: 763) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sbc_day_1)     5.93      1.59     3.64     9.80 1.00     1717
               Tail_ESS
sds(sbc_day_1)     2263

Group-Level Effects: 
~id (Number of levels: 238) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.42      0.11     0.18     0.60 1.01      308
              Tail_ESS
sd(Intercept)      529

~id:cycle (Number of levels: 362) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.38      0.13     0.07     0.60 1.02      233
              Tail_ESS
sd(Intercept)      359

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     2.32      0.05     2.22     2.42 1.00     3341     2898
sbc_day_1   -12.46      5.56   -23.44    -1.87 1.00     2383     2547

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.94      0.04     0.88     1.02 1.01      745     1834

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_bc
[1] &quot;0.68 [0.66;0.71]&quot;

$rmse_bc
[1] &quot;1.45 [1.38;1.53]&quot;

$r_loo_bc
[1] &quot;0.67 [0.62;0.71]&quot;

$r_bc_stirn
[1] &quot;-0.30 [-0.36;-0.23]&quot;

$r_log_bc_stirn
[1] &quot;-0.51 [-0.56;-0.45]&quot;

$r_diff_bc_stirn
[1] &quot;-0.30 [-0.36;-0.23]&quot;

$r_log_diff_bc_stirn
[1] &quot;-0.43 [-0.49;-0.37]&quot;

$r_bc_imputed
[1] &quot; 0.67 [ 0.63; 0.71]&quot;

$r_diff_bc_imputed
[1] &quot; 0.55 [ 0.50; 0.60]&quot;

$sd_bc_imputed
[1] &quot;1.26 (101%)&quot;

$r_diff_bc_imputed_rr
[1] &quot; 0.55 [ 0.50; 0.60]&quot;

$imputed_bc_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 22 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 22 rows containing missing values (geom_point).</code></pre>
<p><img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-3-2.png" width="624" /></p>
<pre><code>
$rmse_bc_imputed
[1] &quot; 1.14&quot;

$fc_day_model
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(fc_day) + (1 | id) + (1 | id:cycle) 
   Data: df (Number of observations: 778) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sfc_day_1)     4.54      1.45     2.52     8.18 1.00     2034
               Tail_ESS
sds(sfc_day_1)     2411

Group-Level Effects: 
~id (Number of levels: 238) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.35      0.11     0.07     0.52 1.01      333
              Tail_ESS
sd(Intercept)      382

~id:cycle (Number of levels: 377) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.26      0.14     0.02     0.51 1.03      279
              Tail_ESS
sd(Intercept)      696

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     2.30      0.05     2.20     2.40 1.00     4977     2937
sfc_day_1     0.14      5.54   -10.05    12.33 1.00     2554     2580

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     1.07      0.04     1.00     1.14 1.00     1517     2175

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_fc
[1] &quot;0.63 [0.60;0.66]&quot;

$rmse_fc
[1] &quot;1.58 [1.50;1.66]&quot;

$r_loo_fc
[1] &quot;0.62 [0.57;0.66]&quot;

$r_fc_stirn
[1] &quot;-0.32 [-0.38;-0.25]&quot;

$r_log_fc_stirn
[1] &quot;-0.52 [-0.57;-0.47]&quot;

$r_diff_fc_stirn
[1] &quot;-0.27 [-0.33;-0.20]&quot;

$r_log_diff_fc_stirn
[1] &quot;-0.41 [-0.47;-0.35]&quot;

$r_fc_imputed
[1] &quot; 0.62 [ 0.57; 0.66]&quot;

$r_diff_fc_imputed
[1] &quot; 0.44 [ 0.39; 0.50]&quot;

$sd_fc_imputed
[1] &quot;1.11 (89%)&quot;

$r_diff_fc_imputed_rr
[1] &quot; 0.47 [ 0.41; 0.52]&quot;

$imputed_fc_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 8 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 8 rows containing missing values (geom_point).</code></pre>
<p><img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-3-3.png" width="624" /></p>
<pre><code>
$rmse_fc_imputed
[1] &quot; 1.19&quot;

$lh_day_model
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(lh_day) + (1 | id) + (1 | id:cycle) 
   Data: df %&gt;% filter(between(lh_day, -15, 15)) (Number of observations: 545) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(slh_day_1)     3.90      1.16     2.29     6.69 1.00     3204
               Tail_ESS
sds(slh_day_1)     2702

Group-Level Effects: 
~id (Number of levels: 188) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.37      0.12     0.08     0.55 1.03      170
              Tail_ESS
sd(Intercept)      339

~id:cycle (Number of levels: 241) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.22      0.14     0.01     0.49 1.02      162
              Tail_ESS
sd(Intercept)      559

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     2.15      0.05     2.05     2.25 1.00     5707     3304
slh_day_1    -8.88      4.79   -18.31     0.62 1.00     4336     2941

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.95      0.04     0.88     1.03 1.00     2729     2600

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_lh
[1] &quot;0.69 [0.65;0.71]&quot;

$rmse_lh
[1] &quot;1.42 [1.33;1.51]&quot;

$r_loo_lh
[1] &quot;0.68 [0.62;0.73]&quot;

$r_prob_lh
[1] &quot;-0.30 [-0.37;-0.22]&quot;

$r_log_prob_lh
[1] &quot;-0.37 [-0.44;-0.30]&quot;

$r_diff_prob_lh
[1] &quot;-0.28 [-0.36;-0.21]&quot;

$r_log_diff_prob_lh
[1] &quot;-0.37 [-0.44;-0.29]&quot;

$r_lh_imputed
[1] &quot; 0.68 [ 0.63; 0.72]&quot;

$r_diff_lh_imputed
[1] &quot; 0.61 [ 0.55; 0.66]&quot;

$sd_lh_imputed
[1] &quot;1.34 (100%)&quot;

$r_diff_lh_imputed_rr
[1] &quot; 0.61 [ 0.55; 0.66]&quot;

$imputed_lh_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 233 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 233 rows containing missing values (geom_point).</code></pre>
<p><img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-3-4.png" width="624" /></p>
<pre><code>
$rmse_lh_imputed
[1] &quot; 1.13&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>gol2</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>bc_day</span>, <span class='va'>fc_day</span>, <span class='va'>lh_day</span>, hormone <span class='op'>=</span> <span class='va'>estradiol</span>, hormone_cens <span class='op'>=</span> <span class='va'>estradiol_cens</span>, <span class='va'>cycle_length</span>, <span class='va'>age</span>, <span class='va'>partner</span><span class='op'>)</span>

<span class='fu'>summarise_hormone</span><span class='op'>(</span>df <span class='op'>=</span> <span class='va'>df</span>, Dataset <span class='op'>=</span> <span class='st'>"GOL2"</span>, 
                  Hormone <span class='op'>=</span> <span class='st'>"Estradiol"</span>, 
                  Method <span class='op'>=</span> <span class='st'>"Salivary immunoassay (IBL)"</span>,
                  Citation <span class='op'>=</span> <span class='st'>"Stern, J., Kordsmeyer, T. L., &amp; Penke, L. (2021). A longitudinal evaluation of ovulatory cycle shifts in women’s mate attraction and preferences. Hormones and Behavior, 128, 104916. https://doi.org/10.1016/j.yhbeh.2020.104916"</span>,
                  LOD <span class='op'>=</span> <span class='fl'>2.1</span>,
                  LOQ <span class='op'>=</span> <span class='fl'>2.1</span>,
                  CV_intra <span class='op'>=</span> <span class='fl'>8.8</span>,
                  CV_inter <span class='op'>=</span> <span class='fl'>11.8</span>,
                  Procedure <span class='op'>=</span> <span class='st'>"For hormone assays, we collected four saliva samples from each participant (one per testing session). Contamination of saliva samples was minimized by asking participants to abstain from eating, drinking (except plain water), smoking, chewing gum, or brushing teeth for at least one hour before each session. The samples were stored at − 80 ◦C directly after collection until shipment on dry ice to the Kirschbaum Lab at Technical University of Dresden, Germany (one freeze-thaw cycle). The samples were reanalyzed for estradiol using the highly sensitive 17β-estradiol enzyme immunoassay kit (IBL International, Hamburg, Germany). Samples were analyzed in singlets, however, the lab reported that their procedure yields CVs &lt; 11%."</span>,
                  Scheduling <span class='op'>=</span> <span class='st'>[1073 chars quoted with '"']</span>, 
                  LH_test <span class='op'>=</span> <span class='st'>"highly sensitive (10mIU) LH urine ovulation test strips from MedNet GmbH. Participants started LH-testing after menstruation (around reverse cycle day 21) and continued until a rise of LH (positive tests) was observed and a minimum of two days after the tests were negative again (as suggested by Roney, 2018b). Participants were provided with a minimum of ten LH tests each and provided daily pictures of the tests to the investigators for confir- mation. LH results were used to allow flexible scheduling in case LH test results differed from the scheduling based on counting (see supplementary material for details)."</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`summarise()` has grouped output by &#39;id&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>Joining, by = &quot;bc_day&quot;</code></pre>
<pre><code>`summarise()` has grouped output by &#39;id&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a66f2b0f7.stan&#39;, line 7, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a66f2b0f7.stan&#39;, line 11, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a66f2b0f7.stan&#39;, line 22, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Running MCMC with 4 chains, at most 8 in parallel...

Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 finished in 5.4 seconds.
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 6.0 seconds.
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 1 finished in 6.0 seconds.
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 finished in 6.3 seconds.

All 4 chains finished successfully.
Mean chain execution time: 5.9 seconds.
Total execution time: 6.8 seconds.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Some Pareto k diagnostic values are too high. See help(&#39;pareto-k-diagnostic&#39;) for details.</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a42a73b47.stan&#39;, line 7, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a42a73b47.stan&#39;, line 11, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a42a73b47.stan&#39;, line 17, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a42a73b47.stan&#39;, line 28, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a42a73b47.stan&#39;, line 30, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc

Start sampling</code></pre>
<pre><code>Running MCMC with 4 chains, at most 8 in parallel...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 finished in 13.2 seconds.
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 13.5 seconds.
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 15.9 seconds.
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 finished in 17.7 seconds.

All 4 chains finished successfully.
Mean chain execution time: 15.1 seconds.
Total execution time: 18.0 seconds.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Some Pareto k diagnostic values are too high. See help(&#39;pareto-k-diagnostic&#39;) for details.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Some Pareto k diagnostic values are too high. See help(&#39;pareto-k-diagnostic&#39;) for details.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Some Pareto k diagnostic values are too high. See help(&#39;pareto-k-diagnostic&#39;) for details.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.

Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a1a471756.stan&#39;, line 7, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a1a471756.stan&#39;, line 13, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a1a471756.stan&#39;, line 19, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a1a471756.stan&#39;, line 25, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a1a471756.stan&#39;, line 41, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a1a471756.stan&#39;, line 43, column 2: Declaration
    of arrays by placing brackets after a variable name is</code></pre>
<pre><code> deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Running MCMC with 4 chains, at most 8 in parallel...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 30.0 seconds.
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 31.0 seconds.
Chain 3 finished in 31.0 seconds.
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 finished in 34.1 seconds.

All 4 chains finished successfully.
Mean chain execution time: 31.5 seconds.
Total execution time: 34.5 seconds.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a4f844a45.stan&#39;, line 7, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a4f844a45.stan&#39;, line 13, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a4f844a45.stan&#39;, line 19, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a4f844a45.stan&#39;, line 25, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a4f844a45.stan&#39;, line 41, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a4f844a45.stan&#39;, line 43, column 2: Declaration
    of arrays by placing brackets after a variable name is</code></pre>
<pre><code> deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Running MCMC with 4 chains, at most 8 in parallel...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 finished in 36.6 seconds.
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 finished in 36.9 seconds.
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 38.0 seconds.
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 40.7 seconds.

All 4 chains finished successfully.
Mean chain execution time: 38.1 seconds.
Total execution time: 41.0 seconds.</code></pre>
<pre><code>
Warning: 4 of 4000 (0.0%) transitions ended with a divergence.
This may indicate insufficient exploration of the posterior distribution.
Possible remedies include: 
  * Increasing adapt_delta closer to 1 (default is 0.8) 
  * Reparameterizing the model (e.g. using a non-centered parameterization)
  * Using informative or weakly informative prior distributions </code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a2c052739.stan&#39;, line 7, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a2c052739.stan&#39;, line 13, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a2c052739.stan&#39;, line 19, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a2c052739.stan&#39;, line 25, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a2c052739.stan&#39;, line 41, column 2: Declaration
    of arrays by placing brackets after a variable name is deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc
Warning in &#39;/var/folders/tr/lgwjmdgd72bckr1hj5gd_7640000gq/T/RtmpSwxdmJ/model-e4a2c052739.stan&#39;, line 43, column 2: Declaration
    of arrays by placing brackets after a variable name is</code></pre>
<pre><code> deprecated and
    will be removed in Stan 2.32.0. Instead use the array keyword before the
    type. This can be changed automatically using the auto-format flag to
    stanc</code></pre>
<pre><code>Start sampling</code></pre>
<pre><code>Running MCMC with 4 chains, at most 8 in parallel...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup) 
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup) 
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup) 
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup) 
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup) 
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup) 
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup) 
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup) 
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup) 
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling) 
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling) 
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling) 
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling) 
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 28.4 seconds.
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling) 
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling) 
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling) 
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling) 
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling) 
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 38.6 seconds.
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 finished in 39.9 seconds.
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 finished in 40.0 seconds.

All 4 chains finished successfully.
Mean chain execution time: 36.7 seconds.
Total execution time: 40.4 seconds.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Some Pareto k diagnostic values are slightly high. See help(&#39;pareto-k-diagnostic&#39;) for details.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.

Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Estimate&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q97.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Estimate&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q97.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Estimate&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>$Dataset
[1] &quot;GOL2&quot;

$Citation
[1] &quot;Stern, J., Kordsmeyer, T. L., &amp; Penke, L. (2021). A longitudinal evaluation of ovulatory cycle shifts in women’s mate attraction and preferences. Hormones and Behavior, 128, 104916. https://doi.org/10.1016/j.yhbeh.2020.104916&quot;

$Hormone
[1] &quot;Estradiol&quot;

$Method
[1] &quot;Salivary immunoassay (IBL)&quot;

$`Limit of detection`
[1] 2.1

$LOQ
[1] 2.1

$`Intraassay CV`
[1] 8.8

$`Interassay CV`
[1] 11.8

$Procedure
[1] &quot;For hormone assays, we collected four saliva samples from each participant (one per testing session). Contamination of saliva samples was minimized by asking participants to abstain from eating, drinking (except plain water), smoking, chewing gum, or brushing teeth for at least one hour before each session. The samples were stored at − 80 ◦C directly after collection until shipment on dry ice to the Kirschbaum Lab at Technical University of Dresden, Germany (one freeze-thaw cycle). The samples were reanalyzed for estradiol using the highly sensitive 17β-estradiol enzyme immunoassay kit (IBL International, Hamburg, Germany). Samples were analyzed in singlets, however, the lab reported that their procedure yields CVs &lt; 11%.&quot;

$Scheduling
[1] &quot;peri-ovulatory (2x), mid-luteal und premenstrual &#39;Sessions two to five were computer-based testing sessions and took place across different phases of the ovulatory cycle, scheduled based on backward counting and the observed LH test surge. Suitable testing days were computed with the help of an Excel sheet created for that purpose (see open material). All participants completed two sessions in their expected fertile phase (mid to late follicular phase, approx. 5–6 days before ovulation) and two sessions in their expected luteal phase (one session in the mid luteal phase, one session in the premenstrual phase). Scheduling was validated via LH test results and via following up to the day of the next menstrual onset. Details can be found in the supple- mentary material. The starting session for each participant depended on their current cycle phase at the introductory session and their personal schedule. Of all participants who finished all sessions, 134 participants started with the first session in their fertile phase, and 123 started in the luteal phase.&#39;&quot;

$LH_test
[1] &quot;highly sensitive (10mIU) LH urine ovulation test strips from MedNet GmbH. Participants started LH-testing after menstruation (around reverse cycle day 21) and continued until a rise of LH (positive tests) was observed and a minimum of two days after the tests were negative again (as suggested by Roney, 2018b). Participants were provided with a minimum of ten LH tests each and provided daily pictures of the tests to the investigators for confir- mation. LH results were used to allow flexible scheduling in case LH test results differed from the scheduling based on counting (see supplementary material for details).&quot;

$distribution</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 1 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-3-5.png" width="624" /></p>
<pre><code>
$mean
[1] 3.995871

$logmean
[1] 1.28891

$logsd
[1] 0.4380145

$median
[1] 3.71

$sd
[1] 1.893096

$mad
[1] 1.541904

$range
[1] &quot;1.01, 19.05&quot;

$missing
[1] 1

$outliers
[1] 4

$censored
[1] 124

$n_women
[1] 257

$n_cycles
[1] 454

$n_days
[1] 1028

$age
[1] &quot;23.1±3.28&quot;

$in_relationship
[1] &quot;47%&quot;

$cycle_length
[1] &quot;30.0±4.75&quot;

$usable_n
[1] 914

$usable_n_women
[1] 243

$no_lh_surge_woman
[1] &quot;47/243 (19%)&quot;

$no_lh_surge_cycle
[1] &quot;145/406 (36%)&quot;

$var_id_loo
[1] &quot;0.16 [0.10;0.22]&quot;

$var_cycle_loo
[1] &quot;0.16 [0.10;0.22]&quot;

$var_id
[1] &quot;0.27 [0.22;0.31] (34%)&quot;

$var_cycle
[1] &quot;0.07 [0.00;0.17] (4%)&quot;

$var_resid
[1] &quot;0.40 [0.37;0.42] (62%)&quot;

$bc_day_model
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(bc_day) + (1 | id) + (1 | id:cycle) 
   Data: df (Number of observations: 895) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sbc_day_1)     0.17      0.17     0.01     0.63 1.00     1624
               Tail_ESS
sds(sbc_day_1)     2280

Group-Level Effects: 
~id (Number of levels: 242) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.27      0.02     0.22     0.31 1.00      974
              Tail_ESS
sd(Intercept)     1374

~id:cycle (Number of levels: 388) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.06      0.04     0.00     0.15 1.01      330
              Tail_ESS
sd(Intercept)      595

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     1.26      0.02     1.22     1.31 1.00     2034     2639
sbc_day_1     0.22      0.44    -0.55     1.29 1.00     2582     2049

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.40      0.01     0.37     0.42 1.00     2747     3070

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_bc
[1] &quot;0.06 [0.01;0.12]&quot;

$rmse_bc
[1] &quot;0.59 [0.56;0.62]&quot;

$r_loo_bc
[1] &quot;NaN [NaN;NaN]&quot;

$r_bc_stirn
[1] &quot; 0.01 [-0.06; 0.07]&quot;

$r_log_bc_stirn
[1] &quot; 0.01 [-0.05; 0.08]&quot;

$r_diff_bc_stirn
[1] &quot; 0.01 [-0.06; 0.08]&quot;

$r_log_diff_bc_stirn
[1] &quot; 0.00 [-0.06; 0.07]&quot;

$r_bc_imputed
[1] &quot; 0.03 [-0.03; 0.10]&quot;

$r_diff_bc_imputed
[1] &quot; 0.04 [-0.03; 0.10]&quot;

$sd_bc_imputed
[1] &quot;0.50 (63%)&quot;

$r_diff_bc_imputed_rr
[1] &quot; 0.05 [-0.03; 0.13]&quot;

$imputed_bc_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 27 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 27 rows containing missing values (geom_point).</code></pre>
<pre><code>
$rmse_bc_imputed
[1] &quot; 0.66&quot;

$fc_day_model</code></pre>
<pre><code>Warning: There were 4 divergent transitions after warmup.
Increasing adapt_delta above may help. See http://mc-stan.org/misc/
warnings.html#divergent-transitions-after-warmup</code></pre>
<p><img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-3-6.png" width="624" /></p>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(fc_day) + (1 | id) + (1 | id:cycle) 
   Data: df (Number of observations: 913) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sfc_day_1)     0.32      0.27     0.02     1.02 1.00     1150
               Tail_ESS
sds(sfc_day_1)     1616

Group-Level Effects: 
~id (Number of levels: 243) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.26      0.02     0.22     0.31 1.00      788
              Tail_ESS
sd(Intercept)     1076

~id:cycle (Number of levels: 406) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.07      0.04     0.00     0.16 1.01      267
              Tail_ESS
sd(Intercept)      613

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     1.26      0.02     1.21     1.30 1.00     1613     2833
sfc_day_1     0.72      0.78    -0.47     2.57 1.00     1567     1641

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.40      0.01     0.37     0.42 1.00     2057     2954

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_fc
[1] &quot;0.09 [0.02;0.15]&quot;

$rmse_fc
[1] &quot;0.59 [0.56;0.62]&quot;

$r_loo_fc
[1] &quot;NaN [NaN;NaN]&quot;

$r_fc_stirn
[1] &quot; 0.00 [-0.06; 0.06]&quot;

$r_log_fc_stirn
[1] &quot; 0.00 [-0.06; 0.07]&quot;

$r_diff_fc_stirn
[1] &quot; 0.04 [-0.03; 0.10]&quot;

$r_log_diff_fc_stirn
[1] &quot; 0.03 [-0.03; 0.10]&quot;

$r_fc_imputed
[1] &quot; 0.04 [-0.02; 0.11]&quot;

$r_diff_fc_imputed
[1] &quot; 0.02 [-0.04; 0.09]&quot;

$sd_fc_imputed
[1] &quot;0.37 (51%)&quot;

$r_diff_fc_imputed_rr
[1] &quot; 0.03 [-0.06; 0.12]&quot;

$imputed_fc_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 9 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 9 rows containing missing values (geom_point).</code></pre>
<p><img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-3-7.png" width="624" /></p>
<pre><code>
$rmse_fc_imputed
[1] &quot; 0.57&quot;

$lh_day_model
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(lh_day) + (1 | id) + (1 | id:cycle) 
   Data: df %&gt;% filter(between(lh_day, -15, 15)) (Number of observations: 647) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(slh_day_1)     0.50      0.35     0.10     1.43 1.00     1592
               Tail_ESS
sds(slh_day_1)     1882

Group-Level Effects: 
~id (Number of levels: 196) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.22      0.04     0.13     0.29 1.01      306
              Tail_ESS
sd(Intercept)      442

~id:cycle (Number of levels: 259) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.13      0.06     0.01     0.24 1.02      192
              Tail_ESS
sd(Intercept)      537

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     1.27      0.02     1.23     1.32 1.00     3683     3216
slh_day_1     0.36      1.03    -1.74     2.45 1.00     2733     2127

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.39      0.01     0.36     0.42 1.00     2175     2869

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_lh
[1] &quot;0.14 [0.05;0.22]&quot;

$rmse_lh
[1] &quot;0.58 [0.55;0.61]&quot;

$r_loo_lh
[1] &quot;NaN [NaN;0.10]&quot;

$r_prob_lh
[1] &quot; 0.05 [-0.03; 0.13]&quot;

$r_log_prob_lh
[1] &quot; 0.06 [-0.02; 0.14]&quot;

$r_diff_prob_lh
[1] &quot; 0.05 [-0.03; 0.12]&quot;

$r_log_diff_prob_lh
[1] &quot; 0.05 [-0.03; 0.13]&quot;

$r_lh_imputed
[1] &quot; 0.10 [ 0.03; 0.18]&quot;

$r_diff_lh_imputed
[1] &quot; 0.08 [ 0.00; 0.15]&quot;

$sd_lh_imputed
[1] &quot;0.51 (60%)&quot;

$r_diff_lh_imputed_rr
[1] &quot; 0.10 [ 0.00; 0.20]&quot;

$imputed_lh_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 267 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 267 rows containing missing values (geom_point).</code></pre>
<p><img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-3-8.png" width="624" /></p>
<pre><code>
$rmse_lh_imputed
[1] &quot; 0.63&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>gol2</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>bc_day</span>, <span class='va'>fc_day</span>, <span class='va'>lh_day</span>, <span class='va'>estradiol</span>, <span class='va'>progesterone</span>, <span class='va'>cycle_length</span><span class='op'>)</span>

<span class='fu'>summarise_hormones</span><span class='op'>(</span>df <span class='op'>=</span> <span class='va'>df</span>, Dataset <span class='op'>=</span> <span class='st'>"GOL2"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Joining, by = &quot;bc_day&quot;</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Automatically saving the model object in &#39;models/m_GOL2_Er_bc.rds&#39;</code></pre>
<pre><code>Automatically saving the model object in &#39;models/m_GOL2_Er_bc.rds&#39;</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Automatically saving the model object in &#39;models/m_GOL2_ExP_bc.rds&#39;</code></pre>
<pre><code>Automatically saving the model object in &#39;models/m_GOL2_ExP_bc.rds&#39;</code></pre>
<pre><code>Automatically saving the model object in &#39;models/m_GOL2_Er_fc.rds&#39;
Automatically saving the model object in &#39;models/m_GOL2_Er_fc.rds&#39;</code></pre>
<pre><code>Automatically saving the model object in &#39;models/m_GOL2_ExP_fc.rds&#39;
Automatically saving the model object in &#39;models/m_GOL2_ExP_fc.rds&#39;</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Automatically saving the model object in &#39;models/m_GOL2_Er_lh.rds&#39;</code></pre>
<pre><code>Automatically saving the model object in &#39;models/m_GOL2_Er_lh.rds&#39;</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Automatically saving the model object in &#39;models/m_GOL2_ExP_lh.rds&#39;</code></pre>
<pre><code>Automatically saving the model object in &#39;models/m_GOL2_ExP_lh.rds&#39;</code></pre>
<pre><code>$Dataset
[1] &quot;GOL2&quot;

$Hormone
[1] &quot;Estradiol &amp; Progesterone&quot;

$Method
[1] &quot;Salivary Immunoassay&quot;

$scatterplot</code></pre>
<pre><code>Warning: Removed 161 rows containing missing values (geom_point).</code></pre>
<p><img src="1_goettingen_lab2_import_files/figure-html5/unnamed-chunk-3-9.png" width="624" /></p>
<pre><code>
$n_women
[1] 257

$n_cycles
[1] 454

$n_days
[1] 1028

$r_ep
[1] &quot; 0.02 [-0.05; 0.09]&quot;

$r_log_ep
[1] &quot; 0.04 [-0.02; 0.11]&quot;

$r_e_ratio
[1] &quot; 0.29 [ 0.23; 0.35]&quot;

$r_log_e_ratio
[1] &quot; 0.24 [ 0.17; 0.30]&quot;

$r_p_ratio
[1] &quot;-0.30 [-0.36;-0.24]&quot;

$r_log_p_ratio
[1] &quot;-0.96 [-0.96;-0.95]&quot;

$usable_n
[1] 777

$r_bc_ratio
[1] &quot; 0.33 [ 0.26; 0.39]&quot;

$r_bc_log_ratio
[1] &quot; 0.50 [ 0.45; 0.55]&quot;

$m_bc_prob_rat
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: prc_stirn_bc ~ log(estradiol) + log(ratio) 
   Data: df (Number of observations: 762) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept        0.35      0.02     0.30     0.40 1.00     2912
logestradiol    -0.05      0.02    -0.08    -0.01 1.00     2928
logratio         0.07      0.00     0.06     0.08 1.00     3839
             Tail_ESS
Intercept        2383
logestradiol     2593
logratio         2944

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.18      0.00     0.18     0.19 1.00     3050     2623

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_erat_bc
[1] &quot;0.50 [0.45;0.55]&quot;

$m_bc_prob
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: prc_stirn_bc ~ s(log(estradiol), log(progesterone)) 
   Data: df (Number of observations: 762) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
                                    Estimate Est.Error l-95% CI
sds(slogestradiollogprogesterone_1)     0.12      0.05     0.04
                                    u-95% CI Rhat Bulk_ESS Tail_ESS
sds(slogestradiollogprogesterone_1)     0.23 1.00     1075     1169

Population-Level Effects: 
                               Estimate Est.Error l-95% CI u-95% CI
Intercept                          0.21      0.01     0.20     0.23
slogestradiollogprogesterone_1    -0.49      0.30    -1.04     0.16
slogestradiollogprogesterone_2     0.22      0.19    -0.17     0.57
                               Rhat Bulk_ESS Tail_ESS
Intercept                      1.00     6266     2702
slogestradiollogprogesterone_1 1.00     1438     1724
slogestradiollogprogesterone_2 1.00     1587     2235

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.18      0.00     0.17     0.19 1.00     5418     2960

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_loo_bc
[1] &quot;0.51 [0.46;0.56]&quot;

$r_fc_ratio
[1] &quot; 0.36 [ 0.30; 0.42]&quot;

$r_fc_log_ratio
[1] &quot; 0.51 [ 0.46; 0.56]&quot;

$m_fc_prob_rat
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: prc_stirn_fc ~ log(estradiol) + log(ratio) 
   Data: df (Number of observations: 777) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept        0.36      0.02     0.31     0.40 1.00     3061
logestradiol    -0.05      0.02    -0.09    -0.02 1.00     3129
logratio         0.08      0.00     0.07     0.09 1.00     4034
             Tail_ESS
Intercept        2773
logestradiol     2325
logratio         2711

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.19      0.00     0.18     0.20 1.00     3501     2531

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_erat_fc
[1] &quot;0.52 [0.47;0.56]&quot;

$m_fc_prob
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: prc_stirn_fc ~ s(log(estradiol), log(progesterone)) 
   Data: df (Number of observations: 777) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
                                    Estimate Est.Error l-95% CI
sds(slogestradiollogprogesterone_1)     0.09      0.04     0.02
                                    u-95% CI Rhat Bulk_ESS Tail_ESS
sds(slogestradiollogprogesterone_1)     0.17 1.00     1280     1252

Population-Level Effects: 
                               Estimate Est.Error l-95% CI u-95% CI
Intercept                          0.21      0.01     0.20     0.22
slogestradiollogprogesterone_1    -0.04      0.10    -0.25     0.16
slogestradiollogprogesterone_2    -0.81      0.26    -1.28    -0.27
                               Rhat Bulk_ESS Tail_ESS
Intercept                      1.00     6748     2942
slogestradiollogprogesterone_1 1.00     2564     2565
slogestradiollogprogesterone_2 1.00     1690     2304

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.19      0.00     0.18     0.20 1.00     5238     2739

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_loo_fc
[1] &quot;0.53 [0.47;0.57]&quot;

$r_lh_ratio
[1] &quot; 0.22 [ 0.14; 0.30]&quot;

$r_lh_log_ratio
[1] &quot; 0.38 [ 0.31; 0.45]&quot;

$m_lh_prob_rat
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: fertile_lh ~ log(estradiol) + log(ratio) 
   Data: df (Number of observations: 544) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept        0.31      0.04     0.22     0.39 1.00     3304
logestradiol    -0.02      0.03    -0.07     0.04 1.00     3458
logratio         0.08      0.01     0.06     0.09 1.00     3738
             Tail_ESS
Intercept        2593
logestradiol     2782
logratio         2564

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.28      0.01     0.27     0.30 1.00     3562     2524

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_erat_lh
[1] &quot;0.37 [0.31;0.43]&quot;

$m_lh_prob
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: fertile_lh ~ s(log(estradiol), log(progesterone)) 
   Data: df (Number of observations: 544) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
                                    Estimate Est.Error l-95% CI
sds(slogestradiollogprogesterone_1)     0.19      0.08     0.06
                                    u-95% CI Rhat Bulk_ESS Tail_ESS
sds(slogestradiollogprogesterone_1)     0.38 1.00     1762     1814

Population-Level Effects: 
                               Estimate Est.Error l-95% CI u-95% CI
Intercept                          0.22      0.01     0.20     0.24
slogestradiollogprogesterone_1    -1.12      0.59    -2.26     0.12
slogestradiollogprogesterone_2    -0.49      0.27    -0.99     0.08
                               Rhat Bulk_ESS Tail_ESS
Intercept                      1.00     6300     2998
slogestradiollogprogesterone_1 1.00     2004     2430
slogestradiollogprogesterone_2 1.00     2544     2634

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.28      0.01     0.26     0.29 1.00     5343     2756

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_loo_lh
[1] &quot;0.39 [0.32;0.44]&quot;</code></pre>
</div>
<div class="sourceCode" id="cb165"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
