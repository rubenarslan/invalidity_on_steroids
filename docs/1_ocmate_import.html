<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Salivary and serum immunoassay comparison: Cycle Quest Data</title>



  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-10-02"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-10-02"/>
  <meta name="article:author" content="Lisa DeBruine &amp; Ruben Arslan"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Salivary and serum immunoassay comparison: Cycle Quest Data"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Salivary and serum immunoassay comparison"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Salivary and serum immunoassay comparison: Cycle Quest Data"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Cycle Quest Data"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Lisa DeBruine & Ruben Arslan"]}]}]},{"type":"character","attributes":{},"value":["10/02/2021"]},{"type":"character","attributes":{},"value":["html_document"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
  <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Cycle Quest Data","authors":[{"author":"Lisa DeBruine & Ruben Arslan","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-10-02T00:00:00.000+00:00","citationText":"Arslan, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Cycle Quest Data</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  
  Lisa DeBruine &amp; Ruben Arslan
  
<br/>10/02/2021
</div>

<div class="d-article">
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># get hormone data from Jones et al 2018 Psych Sci </span>
<span class='co'># doi: 10.1177/0956797618760197</span>
<span class='va'>hormones</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/ocmate/OCMATE_facepref_anon.csv"</span>,
                     col_types <span class='op'>=</span> <span class='st'>"--cddccDn--cnc--dddd---"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span>

<span class='co'># anonymised cycle questionnaire data for only subjects above</span>
<span class='va'>cycle</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/ocmate/OCMATE_cycle_anon.csv"</span><span class='op'>)</span>

<span class='va'>whitespace</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>str_trim</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"\\s+"</span>, <span class='st'>" "</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>notes</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/ocmate/OCMATE hormone notes.csv"</span><span class='op'>)</span>
<span class='va'>notes</span> <span class='op'>&lt;-</span> <span class='va'>notes</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>
  e_LOQ <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='fu'>whitespace</span><span class='op'>(</span><span class='va'>labnotes</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"The concentration of estradiol is below the lowest calibration standard but above the low limit of sensitivity. Data are acceptable for analysis."</span> <span class='op'>~</span> <span class='cn'>T</span>,
    <span class='fu'>whitespace</span><span class='op'>(</span><span class='va'>labnotes</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"Cortisol = 27.62, The concentration of estradiol is below the lowest calibration standard but above the low limit of sensitivity. Data are acceptable for analysis. Low level of saliva. Possible solid particulate present from when the samples were centrifu"</span> <span class='op'>~</span> <span class='cn'>T</span>,
    <span class='fu'>whitespace</span><span class='op'>(</span><span class='va'>labnotes</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"The concentration of progesterone &amp; estradiol is below the lowest calibration standard but above the low limit of sensitivity. Data are acceptable for analysis."</span> <span class='op'>~</span> <span class='cn'>T</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>F</span><span class='op'>)</span>,
  p_LOQ <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='fu'>whitespace</span><span class='op'>(</span><span class='va'>labnotes</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"The concentration of progesterone is below the lowest calibration standard but above the low limit of sensitivity. Data are acceptable for analysis."</span> <span class='op'>~</span> <span class='cn'>T</span>,
    <span class='fu'>whitespace</span><span class='op'>(</span><span class='va'>labnotes</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"The concentration of progesterone &amp; estradiol is below the lowest calibration standard but above the low limit of sensitivity. Data are acceptable for analysis."</span> <span class='op'>~</span> <span class='cn'>T</span>,
    <span class='fu'>whitespace</span><span class='op'>(</span><span class='va'>labnotes</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"The concentration of progesterone &amp; cortisol is below the lowest calibration standard but above the low limit of sensitivity. Data are acceptable for analysis."</span> <span class='op'>~</span> <span class='cn'>T</span>,
    <span class='fu'>whitespace</span><span class='op'>(</span><span class='va'>labnotes</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"Concentration of progesterone is below the lowest calibration standard but above the low limit of sensitivity. Data are acceptable for analysis."</span> <span class='op'>~</span> <span class='cn'>T</span>,
    <span class='fu'>whitespace</span><span class='op'>(</span><span class='va'>labnotes</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"Progesterone concentration below lowest calibration standard but above low limit of sensitivity. Data acceptable for analysis. Cortisol is &lt;.007, concentration is below the low limit of sensitivity for the assay, data may NOT be acceptable for analysis."</span> <span class='op'>~</span> <span class='cn'>T</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>F</span><span class='op'>)</span>,
  p_LOD <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='fu'>whitespace</span><span class='op'>(</span><span class='va'>labnotes</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"Progesterone is &lt;5, concentration is below the low limit of sensitivity for the assay, data may NOT be acceptable for analysis"</span> <span class='op'>~</span> <span class='cn'>T</span>,
    <span class='fu'>whitespace</span><span class='op'>(</span><span class='va'>labnotes</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"Progesterone is &lt;5, concentration is below the low limit of sensitivity for the assay"</span> <span class='op'>~</span> <span class='cn'>T</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>F</span>,
    <span class='op'>)</span>,
  e_LOD <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='fu'>whitespace</span><span class='op'>(</span><span class='va'>labnotes</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"Estradiol is &lt;0.1, concentration is below the low limit of sensitivity for the assay"</span> <span class='op'>~</span> <span class='cn'>T</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>F</span>
  <span class='op'>)</span>
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>notes</span><span class='op'>$</span><span class='va'>e_LOD</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
FALSE  TRUE 
 4892     1 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>notes</span><span class='op'>$</span><span class='va'>e_LOQ</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
FALSE  TRUE 
 4835    58 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>notes</span><span class='op'>$</span><span class='va'>p_LOD</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
FALSE  TRUE 
 4888     5 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>notes</span><span class='op'>$</span><span class='va'>p_LOQ</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
FALSE  TRUE 
 4864    29 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>notes</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>e_LOD</span> <span class='op'>|</span> <span class='va'>e_LOQ</span> <span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>estradiol</span>, <span class='va'>e_LOQ</span>, <span class='va'>e_LOD</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>estradiol</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">estradiol</th>
<th style="text-align: left;">e_LOQ</th>
<th style="text-align: left;">e_LOD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.1000</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.4800</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5046</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5192</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5511</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.6000</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.6143</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.6200</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.6360</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.6399</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.6614</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.6700</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.6701</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.6721</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.6800</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.6800</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.6870</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.6964</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.7155</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.7172</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.7252</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.7521</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.7700</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.7852</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.8100</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.8100</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.8171</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.8238</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.8390</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.8522</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.8536</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.8542</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.8545</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.8596</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.8657</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.8800</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.8863</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.8867</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.8901</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.8931</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9000</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.9066</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9081</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.9200</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9200</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.9210</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9299</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.9300</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9300</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.9300</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9388</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.9428</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9500</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.9551</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9567</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.9600</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9885</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.9887</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9900</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
</tbody>
</table>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>notes</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>p_LOD</span> <span class='op'>|</span> <span class='va'>p_LOQ</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>progesterone</span>, <span class='va'>p_LOQ</span>, <span class='va'>p_LOD</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>progesterone</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">progesterone</th>
<th style="text-align: left;">p_LOQ</th>
<th style="text-align: left;">p_LOD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.2720</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.5239</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.1564</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.6196</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0000</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0000</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0000</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0000</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0000</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.4138</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.4178</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.6209</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.0152</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.0890</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.2723</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.3590</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.6911</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.8484</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.1316</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.5143</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.7214</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">8.4760</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8.5687</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">8.8089</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8.9171</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">9.0151</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9.1462</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">9.2260</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9.2300</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">9.3989</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9.5936</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">9.7803</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9.8555</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">9.9761</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
</tr>
</tbody>
</table>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='fu'>whitespace</span><span class='op'>(</span><span class='va'>notes</span><span class='op'>$</span><span class='va'>labnotes</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Cortisol = 27.62, The concentration of estradiol is below the lowest calibration standard but above the low limit of sensitivity. Data are acceptable for analysis. Low level of saliva. Possible solid particulate present from when the samples were centrifu 
                                                                                                                                                                                                                                                              1 
                                                                                                                                 Cortisol is &lt;.007, concentration is below the low limit of sensitivity for the assay, data may NOT be acceptable for analysis. 
                                                                                                                                                                                                                                                              1 
                                                                  Cortisol is &gt;30, concentration is above the high limit of sensitivity, interference likely, diluted 1/10 for Cortisol (values confirmed by salimetrics), data are NOT acceptable for analyses 
                                                                                                                                                                                                                                                              1 
                                                                                                                                                                                         Diluted 1/5 for Cortisol (value shown has been corrected for dilution) 
                                                                                                                                                                                                                                                              1 
Diluted 1/5 for Cortisol (values confirmed by salimetrics, could be used but an outlier). Salimetrics retested Cortisol in sample, new data with 5 dilution factor show &gt;15, original analysis showed &gt;3. Interference likely, data are NOT acceptable for anal 
                                                                                                                                                                                                                                                              1 
                                                                                                                                                                      Diluted 1/5 for Estradiol (values confirmed by salimetrics, could be used but an outlier) 
                                                                                                                                                                                                                                                              1 
                                                                                                                                                                           Estradiol is &lt;0.1, concentration is below the low limit of sensitivity for the assay 
                                                                                                                                                                                                                                                              1 
                                                                        Had to spit twice to get required volume. First spitting was 11:07-11:08. Second was 11:11-11:12. Second start time changed to reflect this additional minute without altering endtime. 
                                                                                                                                                                                                                                                              1 
                                                                          Had to spit twice to get required volume. First spitting was 11:36-11:45. Second was 11:47-11:51. Second start time changed to reflect this additional time without altering endtime. 
                                                                                                                                                                                                                                                              1 
                                                                        Had to spit twice to get required volume. First spitting was 14:32-14:33. Second was 14:39-14:44. Second start time changed to reflect this additional minute without altering endtime. 
                                                                                                                                                                                                                                                              1 
                                                                        Had to spit twice to get required volume. First spitting was 15:14-15:18. Second was 15:22-15:23. Second start time changed to reflect this additional minute without altering endtime. 
                                                                                                                                                                                                                                                              1 
                                                                        Had to spit twice to get required volume. First spitting was 16:40-16:43. Second was 16:47-17:01. Second start time changed to reflect this additional minute without altering endtime. 
                                                                                                                                                                                                                                                              1 
Low level of saliva for Testosterone only. If the sample was picked up from the bottom of the tube there may have been a layer of solid particulate present from when the samples were centrifuged. If particulate was picked up this could alter the analyte l 
                                                                                                                                                                                                                                                              1 
                 Low level of saliva. If the sample was picked up from the bottom of the tube there may have been a layer of solid particulate present from when the samples were centrifuged. If particulate was picked up this could alter the analyte level. 
                                                                                                                                                                                                                                                              1 
                                                                                                              Low volume of saliva, salimetrics tested Estradiol &amp; Progesterone at 2x dilution. Results have been corrected for this and are okay to use as is. 
                                                                                                                                                                                                                                                              1 
                                                                                                                                                                                        No time recorded on saliva tube. Average time from other sessions used. 
                                                                                                                                                                                                                                                              1 
                                                                                                                                                                      Odd session numbers are correct, came in week 1 missed week 2 did week 3 then dropped out 
                                                                                                                                                                                                                                                              1 
                                                                                                                                           Only 1 time written on tube, cannot calculate average because she only has 1 session - used rounded precise sec time 
                                                                                                                                                                                                                                                              1 
  Progesterone concentration below lowest calibration standard but above low limit of sensitivity. Data acceptable for analysis. Cortisol is &lt;.007, concentration is below the low limit of sensitivity for the assay, data may NOT be acceptable for analysis. 
                                                                                                                                                                                                                                                              1 
                                                                                                                                                                          Progesterone is &lt;5, concentration is below the low limit of sensitivity for the assay 
                                                                                                                                                                                                                                                              1 
                                                                                                               The concentration of cortisol is below the lowest calibration standard but above the low limit of sensitivity. Data are acceptable for analysis. 
                                                                                                                                                                                                                                                              1 
                                                                                                The concentration of progesterone &amp; cortisol is below the lowest calibration standard but above the low limit of sensitivity. Data are acceptable for analysis. 
                                                                                                                                                                                                                                                              1 
                                                                                                        Cortisol is &gt;35, concentration is above the high limit of sensitivity, interference likely, diluted 1/10 for Cortisol (values confirmed by salimetrics) 
                                                                                                                                                                                                                                                              2 
                                                                                                                                                                      Diluted 1/10 for Cortisol (values confirmed by salimetrics, could be used but an outlier) 
                                                                                                                                                                                                                                                              2 
                                                 has 2x session 1 samples, on 28/10 she did all behavioral tests and provided a sample, on 30/10 she did the photo and voice recording and provided an additional sample, make sure to match on date in queries 
                                                                                                                                                                                                                                                              2 
                                                                                                                                                 No time written on tube, average of other times used and endtime for code questionnaire used as endtime approx 
                                                                                                                                                                                                                                                              2 
                                                                                                                                                                                                              Blood contamination, sample unable to be analysed 
                                                                                                                                                                                                                                                              3 
                                                                                                                                                                                  Salimetrics retested Testosterone at normal dilution factor, data okay to use 
                                                                                                                                                                                                                                                              3 
                                                                                                                                 Progesterone is &lt;5, concentration is below the low limit of sensitivity for the assay, data may NOT be acceptable for analysis 
                                                                                                                                                                                                                                                              4 
                                                                                                               Concentration of progesterone is below the lowest calibration standard but above the low limit of sensitivity. Data are acceptable for analysis. 
                                                                                                                                                                                                                                                              5 
                                                                                               The concentration of progesterone &amp; estradiol is below the lowest calibration standard but above the low limit of sensitivity. Data are acceptable for analysis. 
                                                                                                                                                                                                                                                              5 
                                                                                                                                                                                       Flow rate calculated using average saliva time (for remaning 4 sessions) 
                                                                                                                                                                                                                                                              7 
                                                                                                                                                                       Diluted 1/5 for Cortisol (values confirmed by salimetrics, could be used but an outlier) 
                                                                                                                                                                                                                                                             13 
                                                                                                                                                                                                       Only 1 time written on tube, average of other times used 
                                                                                                                                                                                                                                                             16 
                                                                                                           The concentration of progesterone is below the lowest calibration standard but above the low limit of sensitivity. Data are acceptable for analysis. 
                                                                                                                                                                                                                                                             17 
                                                                                                              The concentration of estradiol is below the lowest calibration standard but above the low limit of sensitivity. Data are acceptable for analysis. 
                                                                                                                                                                                                                                                             52 </code></pre>
</div>
<h3 id="hormones">Hormones</h3>
<p>Data is long with each row representing a face trial, so we selected just relevant data and removed duplicate rows.</p>
<ul>
<li><code>oc_id</code>: ID of the subject</li>
<li><code>block</code>: testing block (1, 2 or 3)</li>
<li><code>age</code>: age (in years) of subject on day of testing</li>
<li><code>ethnicity</code>: ethnic group of subject (all white)</li>
<li><code>sexpref</code>: sexual preference of subject (all heterosexual)</li>
<li><code>date</code>: date of testing session</li>
<li><code>pill</code>: is subject currently using OCP (0 = no hormonal contraception, 1 = using OCP)</li>
<li><code>partner</code>: does subject currently have a romantic partner? (0 = no partner, 1 = yes partner)</li>
<li><code>block_pill</code>: all unique pill column values in the block (0 if never used OCP, 1 if always used OCP, otherwise mixed: e.g., 1,0)</li>
<li><code>block_partner</code>: all unique partner column values in the block (0 if never had partner, 1 if always had partner, otherwised mixed: e.g., 1,0)</li>
<li><code>progesterone</code>: salivary progesterone for that session, pg/mL</li>
<li><code>estradiol</code>: salivary estradiol for that session, pg/mL</li>
<li><code>testosterone</code>: salivary testosterone for that session, pg/mL</li>
<li><code>cortisol</code>: salivary cortisol for that session, g/dL (1 ug/dL = 10000 pg/mL)</li>
</ul>
<p>Saliva samples were frozen immediately and stored at 32 C until being shipped on dry ice to the Salimet- rics Lab (Suffolk, United Kingdom) for analysis, where they were assayed using the Salivary 17-Estradiol Enzyme Immunoassay Kit 1-3702 (M = 3.30 pg/mL, SD = 1.27 pg/mL, sensitivity = 0.1 pg/mL, intra-assay coefficient of variability, or CV = 7.13%, inter-assay CV = 7.45%), Salivary Progesterone Enzyme Immunoassay Kit 1-1502 (M = 148.55 pg/mL, SD = 96.13 pg/mL, sen- sitivity = 5 pg/mL, intra-assay CV = 6.20%, inter-assay CV = 7.55%), Salivary Testosterone Enzyme Immunoas- say Kit 1-2402 (M = 87.66 pg/mL, SD = 27.19 pg/mL, sensitivity &lt; 1.0 pg/mL, intra-assay CV = 4.60%, inter- assay CV = 9.83%), and Salivary Cortisol Enzyme Immu- noassay Kit 1-3002 (M = 0.23 g/dL, SD = 0.16 g/dL, sensitivity &lt; 0.003 g/dL, intra-assay CV = 3.50%, inter- assay CV = 5.08%). Only hormone levels from women not using hormonal contraceptives were used in analy- ses (values given above are for these women only). Hormone levels more than 3 standard deviations from the sample mean for that hormone or where Sali- metrics indicated levels were outside their sensitivity range were excluded from the data set (~1% of hor- mone measures were excluded for these reasons). The descriptive statistics given above do not include these excluded values.</p>
<h3 id="cycle-questionnaire">Cycle Questionnaire</h3>
<ul>
<li><code>oc_id</code>: unique identifier for the subject</li>
<li><code>date</code>: date the questionnaire was completed</li>
<li><code>last_menst</code>: When was the first day of your last period? (If you have stopped menstruating for any reason skip to Question 6)
<ul>
<li>datemenu: -100y to +0y</li>
</ul></li>
<li><code>next_menst</code>: When do you expect to start your next period?
<ul>
<li>datemenu: +0y to +1y</li>
</ul></li>
<li><code>regular:</code>How regular is your menstrual cycle?
<ul>
<li>0: I dont know</li>
<li>1: Very Irregular (e.g.I can never really predict when my period will start)</li>
<li>2: Somewhat Irregular (e.g.my cyle is about the same length, but can vary by a few days)</li>
<li>3: Regular (e.g.my cycle is the same length every month)</li>
</ul></li>
<li><code>cycle_length</code>: Typically, how long is your menstrual cycle (i.e.how many days are there between the first day of your period and the start of your next period)?
<ul>
<li>selectnum: 14 to 56</li>
</ul></li>
</ul>
<h3 id="join-data">Join data</h3>
<p>Join by oc_id and date.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>hormones</span> <span class='op'>%&gt;%</span>
  <span class='fu'>full_join</span><span class='op'>(</span><span class='va'>cycle</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"oc_id"</span>, <span class='st'>"date"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>hormones</span><span class='op'>$</span><span class='va'>estradiol</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
FALSE  TRUE 
 3810   178 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>hormones</span><span class='op'>$</span><span class='va'>progesterone</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
FALSE  TRUE 
 3810   178 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>hormones</span><span class='op'>$</span><span class='va'>cortisol</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
FALSE  TRUE 
 3808   180 </code></pre>
</div>
<h2 id="menstrual-onsets">Menstrual onsets</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_onsets</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>oc_id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>oc_id</span>, <span class='va'>date</span>, menstrual_onset_date <span class='op'>=</span> <span class='va'>last_menst</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>menstrual_onset_date</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>menstrual_onsets</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>oc_id</span><span class='op'>==</span><span class='st'>"OC_0119e87d"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 5  3
# Groups:   oc_id [1]
  oc_id       date       menstrual_onset_date
  &lt;chr&gt;       &lt;date&gt;     &lt;date&gt;              
1 OC_0119e87d 2015-09-22 2015-09-03          
2 OC_0119e87d 2015-09-29 2015-09-28          
3 OC_0119e87d 2015-10-06 2015-09-28          
4 OC_0119e87d 2015-10-13 2015-09-24          
5 OC_0119e87d 2015-10-20 2015-10-01          </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>qplot</span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>date</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<img src="1_ocmate_import_files/figure-html5/unnamed-chunk-4-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># remove onsets long before study period</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/elbersb/tidylog/'>tidylog</a></span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Attaching package: &#39;tidylog&#39;</code></pre>
<pre><code>The following objects are masked from &#39;package:dplyr&#39;:

    add_count, add_tally, anti_join, count, distinct,
    distinct_all, distinct_at, distinct_if, filter,
    filter_all, filter_at, filter_if, full_join, group_by,
    group_by_all, group_by_at, group_by_if, inner_join,
    left_join, mutate, mutate_all, mutate_at, mutate_if,
    relocate, rename, rename_all, rename_at, rename_if,
    rename_with, right_join, sample_frac, sample_n, select,
    select_all, select_at, select_if, semi_join, slice,
    slice_head, slice_max, slice_min, slice_sample,
    slice_tail, summarise, summarise_all, summarise_at,
    summarise_if, summarize, summarize_all, summarize_at,
    summarize_if, tally, top_frac, top_n, transmute,
    transmute_all, transmute_at, transmute_if, ungroup</code></pre>
<pre><code>The following objects are masked from &#39;package:tidyr&#39;:

    drop_na, fill, gather, pivot_longer, pivot_wider,
    replace_na, spread, uncount</code></pre>
<pre><code>The following object is masked from &#39;package:stats&#39;:

    filter</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_onsets</span> <span class='op'>&lt;-</span> <span class='va'>menstrual_onsets</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>menstrual_onset_date <span class='op'>=</span>  <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>menstrual_onset_date</span> <span class='op'>&lt;</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='st'>"2012-08-01"</span><span class='op'>)</span> <span class='op'>|</span>
        <span class='va'>menstrual_onset_date</span> <span class='op'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='st'>"2016-12-14"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='cn'>NA_real_</span><span class='op'>)</span>, <span class='va'>menstrual_onset_date</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>mutate (grouped): changed 8 values (&lt;1%) of &#39;menstrual_onset_date&#39; (8 new NA)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_onsets</span> <span class='op'>&lt;-</span> <span class='va'>menstrual_onsets</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>menstrual_onset_date <span class='op'>=</span>  <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>menstrual_onset_date</span> <span class='op'>&gt;</span> <span class='va'>date</span>, <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='cn'>NA_real_</span><span class='op'>)</span>, <span class='va'>menstrual_onset_date</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>mutate (grouped): no changes</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_onsets</span> <span class='op'>&lt;-</span>  <span class='va'>menstrual_onsets</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/distinct.html'>distinct</a></span><span class='op'>(</span><span class='va'>oc_id</span>, <span class='va'>menstrual_onset_date</span>, .keep_all <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>distinct (grouped): removed 1,556 rows (41%), 2,278 rows remaining</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_onsets</span> <span class='op'>&lt;-</span>  <span class='va'>menstrual_onsets</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>oc_id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='co'># step 3: prefer reports closer to event if they conflict</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>
    report_diff <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>-</span> <span class='va'>menstrual_onset_date</span>, units <span class='op'>=</span> <span class='st'>"days"</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>report_diff</span> <span class='op'>&lt;</span> <span class='fl'>50</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>
    onset_diff <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/double.html'>as.double</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/stats/lag.html'>lag</a></span><span class='op'>(</span><span class='va'>menstrual_onset_date</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>menstrual_onset_date</span>, units <span class='op'>=</span> <span class='st'>"days"</span><span class='op'>)</span><span class='op'>)</span>, <span class='co'># was there a change compared to the last reported menstrual onset (first one gets NA)</span>
    menstrual_onset_date <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>onset_diff</span> <span class='op'>&lt;</span> <span class='fl'>7</span>, <span class='co'># if last date is known, but is slightly different from current date </span>
                 <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='cn'>NA</span><span class='op'>)</span>, <span class='co'># attribute it to memory, not extremely short cycle, use fresher date</span>
                 <span class='va'>menstrual_onset_date</span>, <span class='co'># if it's a big difference, use the current date </span>
                 <span class='va'>menstrual_onset_date</span> <span class='co'># use current date if last date not known/first onset</span>
                 <span class='op'>)</span> <span class='co'># if no date is assigned today, keep it like that</span>
  <span class='op'>)</span>
</code></pre>
</div>
<pre><code>group_by: one grouping variable (oc_id)</code></pre>
<pre><code>mutate (grouped): new variable &#39;report_diff&#39; (double) with 74 unique values and &lt;1% NA</code></pre>
<pre><code>filter (grouped): removed 34 rows (1%), 2,244 rows remaining</code></pre>
<pre><code>mutate (grouped): changed 574 values (26%) of &#39;menstrual_onset_date&#39; (574 new NA)</code></pre>
<pre><code>                  new variable &#39;onset_diff&#39; (double) with 240 unique values and 26% NA</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_onsets</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>oc_id</span><span class='op'>==</span><span class='st'>"OC_0119e87d"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter (grouped): removed 2,240 rows (&gt;99%), 4 rows remaining</code></pre>
<pre><code># A tibble: 4  5
# Groups:   oc_id [1]
  oc_id       date       menstrual_onset_date report_diff onset_diff
  &lt;chr&gt;       &lt;date&gt;     &lt;date&gt;                     &lt;dbl&gt;      &lt;dbl&gt;
1 OC_0119e87d 2015-09-22 2015-09-03                    19         NA
2 OC_0119e87d 2015-09-29 2015-09-28                     1         25
3 OC_0119e87d 2015-10-13 NA                            19          4
4 OC_0119e87d 2015-10-20 2015-10-01                    19          7</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_onsets_reduced</span> <span class='op'>&lt;-</span> <span class='va'>menstrual_onsets</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>menstrual_onset_date</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>date_origin <span class='op'>=</span> <span class='st'>"questionnaire"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter (grouped): removed 574 rows (26%), 1,670 rows remaining</code></pre>
<pre><code>mutate (grouped): new variable &#39;date_origin&#39; (character) with one unique value and 0% NA</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>### REPEAT</span>
<span class='va'>menstrual_onsets_reduced</span> <span class='op'>&lt;-</span>  <span class='va'>menstrual_onsets_reduced</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>oc_id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='co'># step 3: prefer reports closer to event if they conflict</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>
    onset_diff <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/double.html'>as.double</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/stats/lag.html'>lag</a></span><span class='op'>(</span><span class='va'>menstrual_onset_date</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>menstrual_onset_date</span>, units <span class='op'>=</span> <span class='st'>"days"</span><span class='op'>)</span><span class='op'>)</span>, <span class='co'># was there a change compared to the last reported menstrual onset (first one gets NA)</span>
    menstrual_onset_date <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>onset_diff</span> <span class='op'>&lt;</span> <span class='fl'>7</span>, <span class='co'># if last date is known, but is slightly different from current date </span>
                 <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='cn'>NA</span><span class='op'>)</span>, <span class='co'># attribute it to memory, not extremely short cycle, use fresher date</span>
                 <span class='va'>menstrual_onset_date</span>, <span class='co'># if it's a big difference, use the current date </span>
                 <span class='va'>menstrual_onset_date</span> <span class='co'># use current date if last date not known/first onset</span>
                 <span class='op'>)</span> <span class='co'># if no date is assigned today, keep it like that</span>
  <span class='op'>)</span>
</code></pre>
</div>
<pre><code>group_by: one grouping variable (oc_id)</code></pre>
<pre><code>mutate (grouped): changed 14 values (1%) of &#39;menstrual_onset_date&#39; (14 new NA)</code></pre>
<pre><code>                  changed 335 values (20%) of &#39;onset_diff&#39; (0 new NA)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_onsets_reduced</span> <span class='op'>&lt;-</span> <span class='va'>menstrual_onsets_reduced</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>menstrual_onset_date</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>date_origin <span class='op'>=</span> <span class='st'>"questionnaire"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter (grouped): removed 14 rows (1%), 1,656 rows remaining</code></pre>
<pre><code>mutate (grouped): no changes</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>### REPEAT AGAIN, THIS TIME ORDERED BY ONSET, NOT REPORTED DATE (catch those wildly out of order reports)</span>
<span class='va'>menstrual_onsets_reduced</span> <span class='op'>&lt;-</span>  <span class='va'>menstrual_onsets_reduced</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>oc_id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>menstrual_onset_date</span>, <span class='va'>date</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='co'># step 3: prefer reports closer to event if they conflict</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>
    onset_diff <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/double.html'>as.double</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/stats/lag.html'>lag</a></span><span class='op'>(</span><span class='va'>menstrual_onset_date</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>menstrual_onset_date</span>, units <span class='op'>=</span> <span class='st'>"days"</span><span class='op'>)</span><span class='op'>)</span>, <span class='co'># was there a change compared to the last reported menstrual onset (first one gets NA)</span>
    menstrual_onset_date <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>onset_diff</span> <span class='op'>&lt;</span> <span class='fl'>7</span>, <span class='co'># if last date is known, but is slightly different from current date </span>
                 <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='cn'>NA</span><span class='op'>)</span>, <span class='co'># attribute it to memory, not extremely short cycle, use fresher date</span>
                 <span class='va'>menstrual_onset_date</span>, <span class='co'># if it's a big difference, use the current date </span>
                 <span class='va'>menstrual_onset_date</span> <span class='co'># use current date if last date not known/first onset</span>
                 <span class='op'>)</span> <span class='co'># if no date is assigned today, keep it like that</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>date</span>, <span class='va'>menstrual_onset_date</span><span class='op'>)</span> 
</code></pre>
</div>
<pre><code>group_by: one grouping variable (oc_id)</code></pre>
<pre><code>mutate (grouped): changed 9 values (1%) of &#39;menstrual_onset_date&#39; (9 new NA)</code></pre>
<pre><code>                  changed 152 values (9%) of &#39;onset_diff&#39; (0 new NA)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_onsets_reduced</span> <span class='op'>&lt;-</span> <span class='va'>menstrual_onsets_reduced</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>menstrual_onset_date</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>date_origin <span class='op'>=</span> <span class='st'>"questionnaire"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter (grouped): removed 9 rows (1%), 1,647 rows remaining</code></pre>
<pre><code>mutate (grouped): no changes</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_onsets_reduced</span> <span class='op'>&lt;-</span>  <span class='va'>menstrual_onsets_reduced</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>oc_id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>
    onset_diff <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/double.html'>as.double</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/stats/lag.html'>lag</a></span><span class='op'>(</span><span class='va'>menstrual_onset_date</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>menstrual_onset_date</span>, units <span class='op'>=</span> <span class='st'>"days"</span><span class='op'>)</span><span class='op'>)</span>, <span class='co'># was there a change compared to the last reported menstrual onset (first one gets NA)</span>
    menstrual_onset_date <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>onset_diff</span> <span class='op'>&lt;</span> <span class='fl'>7</span>, <span class='co'># if last date is known, but is slightly different from current date </span>
                 <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='cn'>NA</span><span class='op'>)</span>, <span class='co'># attribute it to memory, not extremely short cycle, use fresher date</span>
                 <span class='va'>menstrual_onset_date</span>, <span class='co'># if it's a big difference, use the current date </span>
                 <span class='va'>menstrual_onset_date</span> <span class='co'># use current date if last date not known/first onset</span>
                 <span class='op'>)</span> <span class='co'># if no date is assigned today, keep it like that</span>
  <span class='op'>)</span>
</code></pre>
</div>
<pre><code>group_by: one grouping variable (oc_id)</code></pre>
<pre><code>mutate (grouped): changed 133 values (8%) of &#39;onset_diff&#39; (0 new NA)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_onsets_reduced</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>oc_id</span><span class='op'>==</span><span class='st'>"OC_0119e87d"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter (grouped): removed 1,645 rows (&gt;99%), 2 rows remaining</code></pre>
<pre><code># A tibble: 2  6
# Groups:   oc_id [1]
  oc_id       date       menstrual_onset report_diff onset_diff date_origin
  &lt;chr&gt;       &lt;date&gt;     &lt;date&gt;                 &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;      
1 OC_0119e87d 2015-09-22 2015-09-03                19         NA questionna
2 OC_0119e87d 2015-09-29 2015-09-28                 1         25 questionna</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_onsets_reduced</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>oc_id</span>, <span class='va'>date</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>group_by: 2 grouping variables (oc_id, date)</code></pre>
<pre><code>filter (grouped): removed all rows (100%)</code></pre>
<pre><code># A tibble: 0  6
# Groups:   oc_id, date [0]
#  with 6 variables: oc_id &lt;chr&gt;, date &lt;date&gt;,
#   menstrual_onset_date &lt;date&gt;, report_diff &lt;dbl&gt;, onset_diff &lt;dbl&gt;,
#   date_origin &lt;chr&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_onsets_reduced</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>oc_id</span><span class='op'>==</span><span class='st'>"OC_4f0197da"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter (grouped): removed 1,644 rows (&gt;99%), 3 rows remaining</code></pre>
<pre><code># A tibble: 3  6
# Groups:   oc_id [1]
  oc_id       date       menstrual_onset report_diff onset_diff date_origin
  &lt;chr&gt;       &lt;date&gt;     &lt;date&gt;                 &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;      
1 OC_4f0197da 2016-01-19 2015-12-27                23         NA questionna
2 OC_4f0197da 2016-01-26 2016-01-24                 2         28 questionna
3 OC_4f0197da 2016-02-09 2016-01-16                24          8 questionna</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mons</span> <span class='op'>&lt;-</span> <span class='va'>menstrual_onsets_reduced</span>
<span class='co'># now turn our dataset of menstrual onsets into full time series</span>

<span class='va'>menstrual_days</span> <span class='op'>=</span> <span class='va'>data</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>oc_id</span>, <span class='va'>date</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/distinct.html'>distinct</a></span><span class='op'>(</span><span class='va'>oc_id</span>, <span class='va'>date</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>oc_id</span>, <span class='va'>date</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/full_join.html'>full_join</a></span><span class='op'>(</span><span class='va'>mons</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>date <span class='op'>=</span> <span class='va'>menstrual_onset_date</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"oc_id"</span>, <span class='st'>"date"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>date_origin <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>date_origin</span><span class='op'>)</span>, <span class='st'>"not_onset"</span>, <span class='va'>date_origin</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>oc_id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>complete</span><span class='op'>(</span>date <span class='op'>=</span> <span class='fu'>full_seq</span><span class='op'>(</span><span class='va'>date</span>, period <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>date_origin <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>date_origin</span><span class='op'>)</span>, <span class='st'>"unobserved_day"</span>, <span class='va'>date_origin</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/distinct.html'>distinct</a></span><span class='op'>(</span><span class='va'>oc_id</span>, <span class='va'>date</span>, <span class='va'>menstrual_onset_date</span>, .keep_all <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>oc_id</span>, <span class='va'>date</span>, <span class='va'>menstrual_onset_date</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/distinct.html'>distinct</a></span><span class='op'>(</span><span class='va'>oc_id</span>, <span class='va'>date</span>, .keep_all <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: dropped 16 variables (block, age, ethnicity, sexpref, pill, )</code></pre>
<pre><code>distinct: removed 168 rows (4%), 4,052 rows remaining</code></pre>
<pre><code>mutate (grouped): changed 1,575 values (96%) of &#39;date&#39; (0 new NA)</code></pre>
<pre><code>full_join: added 4 columns (menstrual_onset_date, report_diff, onset_diff, date_origin)</code></pre>
<pre><code>           &gt; rows only in x   3,898</code></pre>
<pre><code>           &gt; rows only in y   1,493</code></pre>
<pre><code>           &gt; matched rows       154</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       5,545</code></pre>
<pre><code>mutate: changed 3,898 values (70%) of &#39;date_origin&#39; (3898 fewer NA)</code></pre>
<pre><code>group_by: one grouping variable (oc_id)</code></pre>
<pre><code>mutate (grouped): changed 94,856 values (94%) of &#39;date_origin&#39; (94856 fewer NA)</code></pre>
<pre><code>distinct (grouped): no rows removed
distinct (grouped): no rows removed</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_days</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>oc_id</span> <span class='op'>==</span> <span class='st'>"OC_5bfa454b"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter (grouped): removed 100,282 rows (&gt;99%), 119 rows remaining</code></pre>
<pre><code># A tibble: 119  6
# Groups:   oc_id [1]
   oc_id       date       menstrual_onset_date report_diff onset_diff
   &lt;chr&gt;       &lt;date&gt;     &lt;date&gt;                     &lt;dbl&gt;      &lt;dbl&gt;
 1 OC_5bfa454b 2013-10-01 2013-10-01                    43         25
 2 OC_5bfa454b 2013-10-02 NA                            NA         NA
 3 OC_5bfa454b 2013-10-03 NA                            NA         NA
 4 OC_5bfa454b 2013-10-04 NA                            NA         NA
 5 OC_5bfa454b 2013-10-05 NA                            NA         NA
 6 OC_5bfa454b 2013-10-06 NA                            NA         NA
 7 OC_5bfa454b 2013-10-07 NA                            NA         NA
 8 OC_5bfa454b 2013-10-08 NA                            NA         NA
 9 OC_5bfa454b 2013-10-09 2013-10-09                    15         NA
10 OC_5bfa454b 2013-10-10 NA                            NA         NA
#  with 109 more rows, and 1 more variable: date_origin &lt;chr&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>menstrual_days</span><span class='op'>$</span><span class='va'>date_origin</span>, exclude<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
     not_onset  questionnaire unobserved_day 
          3898           1647          94856 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_days</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>oc_id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/summarise.html'>summarise</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>pull</span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>qplot</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>group_by: one grouping variable (oc_id)</code></pre>
<pre><code>summarise: now 598 rows and 2 columns, ungrouped</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<img src="1_ocmate_import_files/figure-html5/unnamed-chunk-4-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_days</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>oc_id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/summarise.html'>summarise</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>&gt;</span> <span class='fl'>1000</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/left_join.html'>left_join</a></span><span class='op'>(</span><span class='va'>menstrual_days</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>group_by: one grouping variable (oc_id)</code></pre>
<pre><code>summarise: now 598 rows and 2 columns, ungrouped</code></pre>
<pre><code>filter: removed 587 rows (98%), 11 rows remaining</code></pre>
<pre><code>Joining, by = &quot;oc_id&quot;</code></pre>
<pre><code>left_join: added 5 columns (date, menstrual_onset_date, report_diff, onset_diff, date_origin)</code></pre>
<pre><code>           &gt; rows only in x        0</code></pre>
<pre><code>           &gt; rows only in y  (87,310)</code></pre>
<pre><code>           &gt; matched rows     13,091    (includes duplicates)</code></pre>
<pre><code>           &gt;                 ========</code></pre>
<pre><code>           &gt; rows total       13,091</code></pre>
<pre><code># A tibble: 13,091  7
   oc_id           n date       menstrual_onset report_diff onset_diff
   &lt;chr&gt;       &lt;int&gt; &lt;date&gt;     &lt;date&gt;                 &lt;dbl&gt;      &lt;dbl&gt;
 1 OC_0bf3ed42  1147 2013-10-24 NA                        NA         NA
 2 OC_0bf3ed42  1147 2013-10-25 NA                        NA         NA
 3 OC_0bf3ed42  1147 2013-10-26 NA                        NA         NA
 4 OC_0bf3ed42  1147 2013-10-27 NA                        NA         NA
 5 OC_0bf3ed42  1147 2013-10-28 NA                        NA         NA
 6 OC_0bf3ed42  1147 2013-10-29 NA                        NA         NA
 7 OC_0bf3ed42  1147 2013-10-30 NA                        NA         NA
 8 OC_0bf3ed42  1147 2013-10-31 NA                        NA         NA
 9 OC_0bf3ed42  1147 2013-11-01 NA                        NA         NA
10 OC_0bf3ed42  1147 2013-11-02 NA                        NA         NA
#  with 13,081 more rows, and 1 more variable: date_origin &lt;chr&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># menstrual_days %&gt;% group_by(oc_id) %&gt;% summarise(n = n()) %&gt;% filter(n&gt; 1000) %&gt;% left_join(cycle) %&gt;% View</span>
<span class='co'># str(data$last_menst)</span>

<span class='va'>menstrual_days</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/drop_na.html'>drop_na</a></span><span class='op'>(</span><span class='va'>oc_id</span>, <span class='va'>date</span><span class='op'>)</span> <span class='op'>%&gt;%</span>  
            <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>oc_id</span>, <span class='va'>date</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='op'>{</span> <span class='va'>.</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>}</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/stopifnot.html'>stopifnot</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>drop_na (grouped): no rows removed</code></pre>
<pre><code>group_by: 2 grouping variables (oc_id, date)</code></pre>
<pre><code>filter (grouped): removed all rows (100%)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>menstrual_days</span> <span class='op'>=</span> <span class='va'>menstrual_days</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>oc_id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>
    <span class='co'># carry the last observation (the last observed menstrual onset) backward/forward (within person), but we don't do this if we'd bridge more than 40 days this way</span>
    <span class='co'># first we carry it backward (because reporting is retrospective)</span>
    next_menstrual_onset <span class='op'>=</span> <span class='fu'>rcamisc</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rcamisc/man/repeat_last.html'>repeat_last</a></span><span class='op'>(</span><span class='va'>menstrual_onset_date</span>, forward <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>,
    <span class='co'># then we carry it forward</span>
    last_menstrual_onset <span class='op'>=</span> <span class='fu'>rcamisc</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rcamisc/man/repeat_last.html'>repeat_last</a></span><span class='op'>(</span><span class='va'>menstrual_onset_date</span><span class='op'>)</span>,
    <span class='co'># in the next cycle, count to the next onset, not the last</span>
    next_menstrual_onset <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>next_menstrual_onset</span> <span class='op'>==</span> <span class='va'>last_menstrual_onset</span>,
                                   <span class='fu'>lead</span><span class='op'>(</span><span class='va'>next_menstrual_onset</span><span class='op'>)</span>,
                                   <span class='va'>next_menstrual_onset</span><span class='op'>)</span>,
    <span class='co'># calculate the diff to current date</span>
    menstrual_onset_days_until <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>-</span> <span class='va'>next_menstrual_onset</span><span class='op'>)</span>,
    menstrual_onset_days_since <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>date</span> <span class='op'>-</span> <span class='va'>last_menstrual_onset</span><span class='op'>)</span>
    <span class='op'>)</span>
</code></pre>
</div>
<pre><code>group_by: one grouping variable (oc_id)</code></pre>
<pre><code>mutate (grouped): new variable &#39;next_menstrual_onset&#39; (Date) with 580 unique values and 17% NA</code></pre>
<pre><code>                  new variable &#39;last_menstrual_onset&#39; (Date) with 722 unique values and 3% NA</code></pre>
<pre><code>                  new variable &#39;menstrual_onset_days_until&#39; (double) with 1,086 unique values and 17% NA</code></pre>
<pre><code>                  new variable &#39;menstrual_onset_days_since&#39; (double) with 1,091 unique values and 3% NA</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>avg_cycle_lengths</span> <span class='op'>=</span> <span class='va'>menstrual_days</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>oc_id</span>, <span class='va'>last_menstrual_onset</span>, <span class='va'>next_menstrual_onset</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>next_menstrual_onset_if_no_last <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>last_menstrual_onset</span><span class='op'>)</span>, <span class='va'>next_menstrual_onset</span>, <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='cn'>NA_character_</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>oc_id</span>, <span class='va'>next_menstrual_onset_if_no_last</span>, <span class='va'>last_menstrual_onset</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>next_menstrual_onset</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/distinct.html'>distinct</a></span><span class='op'>(</span><span class='va'>oc_id</span>, <span class='va'>last_menstrual_onset</span>, <span class='va'>next_menstrual_onset_if_no_last</span>, .keep_all <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>oc_id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>
    number_of_cycles <span class='op'>=</span> <span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span>,
    cycle_nr <span class='op'>=</span> <span class='fu'>row_number</span><span class='op'>(</span><span class='op'>)</span>,
    cycle_length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/double.html'>as.double</a></span><span class='op'>(</span><span class='fu'>lead</span><span class='op'>(</span><span class='va'>last_menstrual_onset</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>last_menstrual_onset</span>, units <span class='op'>=</span> <span class='st'>"days"</span><span class='op'>)</span>,
    cycle_nr_fully_observed <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>cycle_length</span><span class='op'>)</span><span class='op'>)</span>,
    mean_cycle_length_diary <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>cycle_length</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
    median_cycle_length_diary <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>cycle_length</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>last_menstrual_onset</span><span class='op'>)</span> <span class='op'>|</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>next_menstrual_onset_if_no_last</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: dropped 7 variables (date, menstrual_onset_date, report_diff, onset_diff, date_origin, )</code></pre>
<pre><code>mutate (grouped): new variable &#39;next_menstrual_onset_if_no_last&#39; (Date) with one unique value and 100% NA</code></pre>
<pre><code>select: dropped one variable (next_menstrual_onset)</code></pre>
<pre><code>distinct (grouped): removed 98,713 rows (98%), 1,688 rows remaining</code></pre>
<pre><code>group_by: one grouping variable (oc_id)</code></pre>
<pre><code>mutate (grouped): new variable &#39;number_of_cycles&#39; (integer) with 9 unique values and 0% NA</code></pre>
<pre><code>                  new variable &#39;cycle_nr&#39; (integer) with 9 unique values and 0% NA</code></pre>
<pre><code>                  new variable &#39;cycle_length&#39; (double) with 236 unique values and 37% NA</code></pre>
<pre><code>                  new variable &#39;cycle_nr_fully_observed&#39; (integer) with 9 unique values and 0% NA</code></pre>
<pre><code>                  new variable &#39;mean_cycle_length_diary&#39; (double) with 238 unique values and 6% NA</code></pre>
<pre><code>                  new variable &#39;median_cycle_length_diary&#39; (double) with 116 unique values and 6% NA</code></pre>
<pre><code>filter (grouped): removed 41 rows (2%), 1,647 rows remaining</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>avg_cycle_lengths</span><span class='op'>$</span><span class='va'>cycle_length</span> <span class='op'>&lt;</span> <span class='fl'>7</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
FALSE 
 1060 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>avg_cycle_lengths</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>oc_id</span>,<span class='va'>last_menstrual_onset</span>, <span class='va'>cycle_length</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>cycle_length</span> <span class='op'>&lt;</span> <span class='fl'>7</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: dropped 6 variables (next_menstrual_onset_if_no_last, number_of_cycles, cycle_nr, cycle_nr_fully_observed, mean_cycle_length_diary, )</code></pre>
<pre><code>filter (grouped): removed all rows (100%)</code></pre>
<pre><code># A tibble: 0  3
# Groups:   oc_id [0]
#  with 3 variables: oc_id &lt;chr&gt;, last_menstrual_onset &lt;date&gt;,
#   cycle_length &lt;dbl&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># mons %&gt;% filter(oc_id ==  "OC_5bfa454b") %&gt;% View</span>
<span class='co'># menstrual_days %&gt;% filter(oc_id ==  "OC_5bfa454b") %&gt;% View</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>avg_cycle_lengths</span><span class='op'>$</span><span class='va'>cycle_length</span> <span class='op'>&gt;</span> <span class='fl'>7</span> <span class='op'>&amp;</span> <span class='va'>avg_cycle_lengths</span><span class='op'>$</span><span class='va'>cycle_length</span> <span class='op'>&lt;</span> <span class='fl'>40</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
FALSE  TRUE 
  351   709 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>avg_cycle_lengths</span><span class='op'>$</span><span class='va'>cycle_length</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
   7    8    9   10   11   12   13   14   15   16   17   18   19   20 
  50   20    4    4    5    8    3   11    8    1    4   12   13    9 
  21   22   23   24   25   26   27   28   29   30   31   32   33   34 
  16   21   26   25   40   49   57  106   59   45   30   26   20   26 
  35   36   37   38   39   40   41   42   43   44   45   46   47   48 
  21   19    7    6    8    3    6    4    3    4    1    1    4    1 
  49   50   51   52   53   54   55   56   57   58   59   60   61   62 
   7    3    4    4    2    2    3    3    3    6    3    3    1    1 
  63   64   65   66   67   68   69   71   75   76   77   78   80   81 
   1    2    2    2    1    2    1    1    1    3    2    3    2    3 
  82   83   85   86   88   89   90   92   93   96   97  102  105  107 
   2    2    3    1    1    1    1    1    3    1    2    2    2    1 
 108  109  112  113  117  118  119  122  123  124  128  136  138  140 
   2    1    3    2    2    1    1    1    1    1    1    1    1    1 
 143  144  145  146  154  155  158  160  161  163  166  168  169  170 
   1    1    1    1    1    1    1    1    1    1    1    1    2    1 
 175  177  179  180  184  185  187  188  190  191  192  193  194  195 
   5    1    1    2    1    1    1    1    1    2    1    2    1    2 
 196  197  201  202  203  204  205  207  210  211  212  213  215  216 
   1    1    1    1    1    1    1    1    1    1    2    2    2    1 
 217  219  221  223  224  225  226  235  240  243  245  246  249  251 
   2    1    2    1    3    1    1    1    1    2    1    2    1    1 
 252  255  257  262  265  267  270  271  272  276  279  287  291  293 
   2    1    1    1    1    1    1    1    1    2    1    1    1    2 
 294  300  301  303  304  309  311  314  317  322  327  328  335  336 
   1    1    1    1    1    1    2    1    1    1    1    1    1    1 
 339  341  344  345  346  347  355  356  357  359  362  364  368  371 
   1    1    1    1    1    1    1    1    1    1    1    1    1    1 
 378  382  386  406  422  425  427  431  436  459  469  484  518  522 
   1    1    1    1    1    2    1    1    1    1    1    1    1    1 
 556  589  596  603  611  615  626  634  649  652  661  673  686  693 
   1    1    1    1    1    1    1    1    1    1    1    1    1    1 
 695  697  698  701  729  732  734  951  957 1055 1085 
   2    1    1    1    1    1    1    1    1    1    1 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>qplot</span><span class='op'>(</span><span class='va'>avg_cycle_lengths</span><span class='op'>$</span><span class='va'>cycle_length</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>scale_x_sqrt</span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>7</span>, <span class='fl'>28</span>, <span class='fl'>50</span>, <span class='fl'>100</span>, <span class='fl'>200</span>, <span class='fl'>500</span><span class='op'>)</span> <span class='op'>)</span>
</code></pre>
</div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 587 rows containing non-finite values (stat_bin).</code></pre>
<img src="1_ocmate_import_files/figure-html5/unnamed-chunk-4-3.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>avg_cycle_lengths</span> <span class='op'>&lt;-</span> <span class='va'>avg_cycle_lengths</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/rename.html'>rename</a></span><span class='op'>(</span>
  obs_cycle_length <span class='op'>=</span> <span class='va'>cycle_length</span>
<span class='op'>)</span>
</code></pre>
</div>
<pre><code>rename: renamed one variable (obs_cycle_length)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ocmate</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/left_join.html'>left_join</a></span><span class='op'>(</span><span class='va'>menstrual_days</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"oc_id"</span>, <span class='st'>"date"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>next_menstrual_onset_if_no_last <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>last_menstrual_onset</span><span class='op'>)</span>, <span class='va'>next_menstrual_onset</span>, <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='cn'>NA_character_</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/left_join.html'>left_join</a></span><span class='op'>(</span><span class='va'>avg_cycle_lengths</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"oc_id"</span>, <span class='st'>"last_menstrual_onset"</span>, <span class='st'>"next_menstrual_onset_if_no_last"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>left_join: added 8 columns (menstrual_onset_date, report_diff, onset_diff, date_origin, next_menstrual_onset, )</code></pre>
<pre><code>           &gt; rows only in x        0</code></pre>
<pre><code>           &gt; rows only in y  (96,349)</code></pre>
<pre><code>           &gt; matched rows      4,220</code></pre>
<pre><code>           &gt;                 ========</code></pre>
<pre><code>           &gt; rows total        4,220</code></pre>
<pre><code>mutate: new variable &#39;next_menstrual_onset_if_no_last&#39; (Date) with one unique value and 100% NA</code></pre>
<pre><code>left_join: added 6 columns (number_of_cycles, cycle_nr, obs_cycle_length, cycle_nr_fully_observed, mean_cycle_length_diary, )</code></pre>
<pre><code>           &gt; rows only in x     127</code></pre>
<pre><code>           &gt; rows only in y  (   87)</code></pre>
<pre><code>           &gt; matched rows     4,093</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       4,220</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ocmate</span> <span class='op'>&lt;-</span> <span class='va'>ocmate</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>mens_pm_15 <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
    <span class='va'>menstrual_onset_days_until</span> <span class='op'>&gt;</span> <span class='op'>-</span><span class='fl'>16</span>  <span class='op'>~</span> <span class='va'>menstrual_onset_days_until</span>,
    <span class='va'>menstrual_onset_days_since</span> <span class='op'>&lt;</span> <span class='fl'>16</span> <span class='op'>~</span> 
      <span class='va'>menstrual_onset_days_since</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>NA_real_</span>
  <span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>mutate: new variable &#39;mens_pm_15&#39; (double) with 32 unique values and 24% NA</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ocmate</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>estradiol</span>, <span class='va'>progesterone</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/summarise_all.html'>summarise_all</a></span><span class='op'>(</span><span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>.</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: dropped 32 variables (oc_id, block, age, ethnicity, sexpref, )</code></pre>
<pre><code>summarise_all: now one row and 2 columns, ungrouped</code></pre>
<pre><code># A tibble: 1  2
  estradiol progesterone
      &lt;dbl&gt;        &lt;dbl&gt;
1       0.1        0.272</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ocmate</span> <span class='op'>&lt;-</span> <span class='va'>ocmate</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>
    estradiol_cens <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>estradiol</span> <span class='op'>&lt;=</span> <span class='fl'>0.1</span>,
                             <span class='st'>"left"</span>, <span class='st'>"none"</span><span class='op'>)</span>,
    estradiol <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>estradiol</span> <span class='op'>&lt;</span> <span class='fl'>0.1</span>,
                             <span class='fl'>0.1</span>, <span class='va'>estradiol</span><span class='op'>)</span>,
    progesterone_cens <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>progesterone</span> <span class='op'>&lt;=</span> <span class='fl'>5</span>,
                               <span class='st'>"left"</span>, <span class='st'>"none"</span><span class='op'>)</span>,
    progesterone <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>progesterone</span> <span class='op'>&lt;</span> <span class='fl'>5</span>,
                               <span class='fl'>5</span>, <span class='va'>progesterone</span><span class='op'>)</span>
  <span class='op'>)</span>
</code></pre>
</div>
<pre><code>mutate: changed 3 values (&lt;1%) of &#39;progesterone&#39; (0 new NA)</code></pre>
<pre><code>        new variable &#39;estradiol_cens&#39; (character) with 3 unique values and 9% NA</code></pre>
<pre><code>        new variable &#39;progesterone_cens&#39; (character) with 3 unique values and 9% NA</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>estradiol_cens</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
left none 
   1 3827 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>progesterone_cens</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
left none 
   5 3823 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ocmate</span> <span class='op'>&lt;-</span> <span class='va'>ocmate</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/rename.html'>rename</a></span><span class='op'>(</span>
  id <span class='op'>=</span> <span class='va'>oc_id</span>, 
  cycle <span class='op'>=</span> <span class='va'>cycle_nr</span>, 
  bc_day <span class='op'>=</span> <span class='va'>menstrual_onset_days_until</span>, 
  fc_day <span class='op'>=</span> <span class='va'>menstrual_onset_days_since</span>,
  reported_cycle_length <span class='op'>=</span> <span class='va'>cycle_length</span>,
  cycle_length <span class='op'>=</span> <span class='va'>obs_cycle_length</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>rename: renamed 5 variables (id, reported_cycle_length, bc_day, fc_day, cycle)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>cycle_length</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]    7 1085</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>fc_day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]    0 1089</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>bc_day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -1083    -1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># because of OCMATEs unique scheduling with repeated measures across long times, there are many cycles where it's likely that we have missed a menstrual onset</span>
<span class='va'>ocmate</span> <span class='op'>&lt;-</span> <span class='va'>ocmate</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>cycle_length <span class='op'>=</span> 
           <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>cycle_length</span> <span class='op'>&gt;</span> <span class='fl'>35</span>, 
                   true <span class='op'>=</span> <span class='fl'>36</span>, 
                   false <span class='op'>=</span> <span class='va'>cycle_length</span>,
                   missing <span class='op'>=</span> <span class='cn'>NA_real_</span><span class='op'>)</span>,
         fc_day <span class='op'>=</span> 
           <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>fc_day</span> <span class='op'>&gt;</span> <span class='fl'>34</span>, 
                   true <span class='op'>=</span> <span class='cn'>NA_real_</span>, 
                   false <span class='op'>=</span> <span class='va'>fc_day</span>,
                   missing <span class='op'>=</span> <span class='cn'>NA_real_</span><span class='op'>)</span>,
         bc_day <span class='op'>=</span> 
           <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>bc_day</span> <span class='op'>&lt;</span> <span class='op'>-</span><span class='fl'>35</span>, 
                   true <span class='op'>=</span> <span class='cn'>NA_real_</span>, 
                   false <span class='op'>=</span> <span class='va'>bc_day</span>,
                   missing <span class='op'>=</span> <span class='cn'>NA_real_</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>mutate: changed 708 values (17%) of &#39;bc_day&#39; (708 new NA)</code></pre>
<pre><code>        changed 230 values (5%) of &#39;fc_day&#39; (230 new NA)</code></pre>
<pre><code>        changed 895 values (21%) of &#39;cycle_length&#39; (0 new NA)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>cycle_length</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  7 36</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>fc_day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  0 34</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>bc_day</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -35  -1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>ocmate</span>, <span class='st'>"ocmate.rds"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="hormone-plot">Hormone plot</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ocmate_long</span> <span class='op'>&lt;-</span> <span class='va'>ocmate</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/drop_na.html'>drop_na</a></span><span class='op'>(</span><span class='va'>pill</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>cycle_length</span> <span class='op'>&gt;</span> <span class='fl'>7</span>, <span class='va'>cycle_length</span> <span class='op'>&lt;</span> <span class='fl'>40</span>,
  <span class='va'>bc_day</span> <span class='op'>&gt;</span> <span class='op'>-</span><span class='fl'>40</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>pill</span>, <span class='va'>mens_pm_15</span>, <span class='va'>bc_day</span>, <span class='va'>fc_day</span>, <span class='va'>estradiol</span>, <span class='va'>progesterone</span>, <span class='va'>testosterone</span>, <span class='va'>cortisol</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>estradiol</span>, <span class='va'>progesterone</span>, <span class='va'>testosterone</span>, <span class='va'>cortisol</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>drop_na: removed 267 rows (6%), 3,953 rows remaining</code></pre>
<pre><code>filter: removed 2,297 rows (58%), 1,656 rows remaining</code></pre>
<pre><code>select: dropped 27 variables (block, age, ethnicity, sexpref, date, )</code></pre>
<pre><code>pivot_longer: reorganized (estradiol, progesterone, testosterone, cortisol) into (name, value) [was 1656x9, now 6624x7]</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ocmate_long</span> <span class='op'>%&gt;%</span>  
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>bc_day</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_smooth</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>y</span> <span class='op'>~</span> <span class='fu'>s</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, method <span class='op'>=</span> <span class='st'>"gam"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>facet_grid</span><span class='op'>(</span><span class='va'>name</span> <span class='op'>~</span> <span class='va'>pill</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning: Removed 308 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 308 rows containing missing values (geom_point).</code></pre>
<img src="1_ocmate_import_files/figure-html5/unnamed-chunk-5-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ocmate_long</span> <span class='op'>%&gt;%</span>  
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>fc_day</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_smooth</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>y</span> <span class='op'>~</span> <span class='fu'>s</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, method <span class='op'>=</span> <span class='st'>"gam"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>facet_grid</span><span class='op'>(</span><span class='va'>name</span> <span class='op'>~</span> <span class='va'>pill</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning: Removed 564 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 564 rows containing missing values (geom_point).</code></pre>
<img src="1_ocmate_import_files/figure-html5/unnamed-chunk-5-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ocmate_long</span> <span class='op'>%&gt;%</span>  
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>mens_pm_15</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_smooth</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>y</span> <span class='op'>~</span> <span class='fu'>s</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, method <span class='op'>=</span> <span class='st'>"gam"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>facet_grid</span><span class='op'>(</span><span class='va'>name</span> <span class='op'>~</span> <span class='va'>pill</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning: Removed 608 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning: Removed 608 rows containing missing values (geom_point).</code></pre>
<img src="1_ocmate_import_files/figure-html5/unnamed-chunk-5-3.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>progesterone</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 143.632</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>progesterone</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 121.385</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>progesterone</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 107.2229</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/mad.html'>mad</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>progesterone</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 83.24799</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>estradiol</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 3.188828</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>estradiol</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 2.9625</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>estradiol</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 1.440205</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/mad.html'>mad</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>estradiol</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 1.152647</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='va'>estradiol</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span>, <span class='va'>ocmate</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pill</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed 1,826 rows (43%), 2,394 rows remaining</code></pre>
<pre><code>filter: removed 1,826 rows (43%), 2,394 rows remaining
filter: removed 1,826 rows (43%), 2,394 rows remaining
filter: removed 1,826 rows (43%), 2,394 rows remaining</code></pre>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: estradiol ~ (1 | id)
   Data: ocmate %&gt;% filter(pill == 0)
REML criterion at convergence: 7687.182
Random effects:
 Groups   Name        Std.Dev.
 id       (Intercept) 1.116   
 Residual             1.108   
Number of obs: 2291, groups:  id, 376
Fixed Effects:
(Intercept)  
      3.438  </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>estradiol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span>, <span class='va'>ocmate</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pill</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed 1,826 rows (43%), 2,394 rows remaining
filter: removed 1,826 rows (43%), 2,394 rows remaining
filter: removed 1,826 rows (43%), 2,394 rows remaining
filter: removed 1,826 rows (43%), 2,394 rows remaining</code></pre>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: scale(log(estradiol)) ~ (1 | id)
   Data: ocmate %&gt;% filter(pill == 0)
REML criterion at convergence: 5453.108
Random effects:
 Groups   Name        Std.Dev.
 id       (Intercept) 0.7549  
 Residual             0.6697  
Number of obs: 2291, groups:  id, 376
Fixed Effects:
(Intercept)  
    0.05617  </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>estradiol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span>, <span class='va'>ocmate</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pill</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed 2,661 rows (63%), 1,559 rows remaining</code></pre>
<pre><code>filter: removed 2,661 rows (63%), 1,559 rows remaining
filter: removed 2,661 rows (63%), 1,559 rows remaining
filter: removed 2,661 rows (63%), 1,559 rows remaining</code></pre>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: scale(log(estradiol)) ~ (1 | id)
   Data: ocmate %&gt;% filter(pill == 1)
REML criterion at convergence: 3302.622
Random effects:
 Groups   Name        Std.Dev.
 id       (Intercept) 0.8127  
 Residual             0.5977  
Number of obs: 1483, groups:  id, 264
Fixed Effects:
(Intercept)  
    0.01313  </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>estradiol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span>, <span class='va'>ocmate</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pill</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed 1,826 rows (43%), 2,394 rows remaining</code></pre>
<pre><code>filter: removed 1,826 rows (43%), 2,394 rows remaining
filter: removed 1,826 rows (43%), 2,394 rows remaining
filter: removed 1,826 rows (43%), 2,394 rows remaining</code></pre>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: (log(estradiol)) ~ (1 | id)
   Data: ocmate %&gt;% filter(pill == 0)
REML criterion at convergence: 1418.537
Random effects:
 Groups   Name        Std.Dev.
 id       (Intercept) 0.3128  
 Residual             0.2775  
Number of obs: 2291, groups:  id, 376
Fixed Effects:
(Intercept)  
      1.149  </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>estradiol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span>, <span class='va'>ocmate</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pill</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed 2,661 rows (63%), 1,559 rows remaining</code></pre>
<pre><code>filter: removed 2,661 rows (63%), 1,559 rows remaining
filter: removed 2,661 rows (63%), 1,559 rows remaining
filter: removed 2,661 rows (63%), 1,559 rows remaining</code></pre>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: (log(estradiol)) ~ (1 | id)
   Data: ocmate %&gt;% filter(pill == 1)
REML criterion at convergence: 825.1994
Random effects:
 Groups   Name        Std.Dev.
 id       (Intercept) 0.3523  
 Residual             0.2591  
Number of obs: 1483, groups:  id, 264
Fixed Effects:
(Intercept)  
     0.9883  </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='va'>progesterone</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span>, <span class='va'>ocmate</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: progesterone ~ (1 | id)
   Data: ocmate
REML criterion at convergence: 45665.84
Random effects:
 Groups   Name        Std.Dev.
 id       (Intercept) 68.84   
 Residual             83.19   
Number of obs: 3828, groups:  id, 595
Fixed Effects:
(Intercept)  
      143.3  </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>progesterone</span><span class='op'>)</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span>, <span class='va'>ocmate</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: log(progesterone) ~ (1 | id)
   Data: ocmate
REML criterion at convergence: 7286.302
Random effects:
 Groups   Name        Std.Dev.
 id       (Intercept) 0.5422  
 Residual             0.5392  
Number of obs: 3828, groups:  id, 595
Fixed Effects:
(Intercept)  
      4.705  </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/cor.test.html'>cor.test</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>progesterone</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>ocmate</span><span class='op'>$</span><span class='va'>estradiol</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
    Pearson&#39;s product-moment correlation

data:  log(ocmate$progesterone) and log(ocmate$estradiol)
t = 34.873, df = 3826, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.4666971 0.5147868
sample estimates:
      cor 
0.4911161 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>estradiol</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>progesterone</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>id</span><span class='op'>)</span>, <span class='va'>ocmate</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: scale(log(estradiol)) ~ scale(log(progesterone)) + (1 | id)
   Data: ocmate
REML criterion at convergence: 8104.467
Random effects:
 Groups   Name        Std.Dev.
 id       (Intercept) 0.6704  
 Residual             0.5899  
Number of obs: 3828, groups:  id, 595
Fixed Effects:
             (Intercept)  scale(log(progesterone))  
                 0.04131                   0.39535  </code></pre>
</div>
<h2 id="compare-pillnon-pill">Compare pill/non-pill</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ocmate</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>pill</span>, <span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/summarise_at.html'>summarise_at</a></span><span class='op'>(</span><span class='fu'>vars</span><span class='op'>(</span><span class='va'>progesterone</span>, <span class='va'>estradiol</span>, <span class='va'>testosterone</span>, <span class='va'>cortisol</span><span class='op'>)</span>, <span class='va'>mean</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/summarise_at.html'>summarise_at</a></span><span class='op'>(</span><span class='fu'>vars</span><span class='op'>(</span><span class='va'>progesterone</span>, <span class='va'>estradiol</span>, <span class='va'>testosterone</span>, <span class='va'>cortisol</span><span class='op'>)</span>, <span class='fu'>funs</span><span class='op'>(</span><span class='va'>mean</span>, <span class='va'>var</span><span class='op'>)</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>pill</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/drop_na.html'>drop_na</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='va'>pill</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate.html'>mutate</a></span><span class='op'>(</span>diff <span class='op'>=</span> <span class='va'>`0`</span><span class='op'>-</span><span class='va'>`1`</span>,
         ratio <span class='op'>=</span> <span class='fl'>100</span><span class='op'>*</span><span class='va'>`1`</span><span class='op'>/</span><span class='va'>`0`</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>name</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>group_by: 2 grouping variables (pill, id)</code></pre>
<pre><code>summarise_at: now 770 rows and 6 columns, one group variable remaining (pill)</code></pre>
<pre><code>Warning: `funs()` was deprecated in dplyr 0.8.0.
Please use a list of either functions or lambdas: 

  # Simple named list: 
  list(mean = mean, median = median)

  # Auto named with `tibble::lst()`: 
  tibble::lst(mean, median)

  # Using lambdas
  list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))</code></pre>
<pre><code>summarise_at: now 3 rows and 9 columns, ungrouped</code></pre>
<pre><code>pivot_longer: reorganized (progesterone_mean, estradiol_mean, testosterone_mean, cortisol_mean, progesterone_var, ) into (name, value) [was 3x9, now 24x3]</code></pre>
<pre><code>drop_na: removed 8 rows (33%), 16 rows remaining</code></pre>
<pre><code>pivot_wider: reorganized (pill, value) into (0, 1) [was 16x3, now 8x3]</code></pre>
<pre><code>mutate: new variable &#39;diff&#39; (double) with 8 unique values and 0% NA</code></pre>
<pre><code>        new variable &#39;ratio&#39; (double) with 8 unique values and 0% NA</code></pre>
<pre><code># A tibble: 8  5
  name                   `0`       `1`      diff ratio
  &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 cortisol_mean        0.259    0.301    -0.0423 116. 
2 cortisol_var         0.188    0.0928    0.0952  49.4
3 estradiol_mean       3.45     2.93      0.523   84.9
4 estradiol_var        1.51     1.10      0.403   73.2
5 progesterone_mean  161.     121.       39.7     75.4
6 progesterone_var  7648.    4207.     3441.      55.0
7 testosterone_mean   88.5     61.7      26.8     69.7
8 testosterone_var   601.     361.      240.      60.0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># 83.8 vs. 23.1</span>
<span class='co'># diff in pg/ml for total estradiol in serum for Zethraeus et al. 62.4</span>
<span class='co'># ratio: 23.1/83.8=27%</span>
<span class='co'># diff in pg/ml for free testosterone in serum for Zethraeus et al. 2.1</span>
<span class='co'># ratio: 1.8/3.9=46%</span>
<span class='co'># variance ratio e2 in zethraeus 52.3^2/(70.9^2)=54%</span>
<span class='co'># variance ratio free t in zethraeus 1.2^2/1.6^2=56%</span>

<span class='va'>ocmate</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>pill</span>, <span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/summarise_at.html'>summarise_at</a></span><span class='op'>(</span><span class='fu'>vars</span><span class='op'>(</span><span class='va'>progesterone</span>, <span class='va'>estradiol</span>, <span class='va'>testosterone</span>, <span class='va'>cortisol</span><span class='op'>)</span>, <span class='va'>mean</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>pill</span>, <span class='op'>-</span><span class='va'>id</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/drop_na.html'>drop_na</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>pill</span><span class='op'>)</span>, <span class='va'>value</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>ggbeeswarm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ggbeeswarm/man/geom_beeswarm.html'>geom_beeswarm</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_pointrange</span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>'summary'</span>, fun.data <span class='op'>=</span> <span class='st'>'mean_cl_boot'</span>, color <span class='op'>=</span> <span class='st'>'blue'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>name</span>, scales <span class='op'>=</span> <span class='st'>'free_y'</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>group_by: 2 grouping variables (pill, id)</code></pre>
<pre><code>summarise_at: now 770 rows and 6 columns, one group variable remaining (pill)</code></pre>
<pre><code>pivot_longer: reorganized (progesterone, estradiol, testosterone, cortisol) into (name, value) [was 770x6, now 3080x4]</code></pre>
<pre><code>drop_na (grouped): removed 520 rows (17%), 2,560 rows remaining</code></pre>
<img src="1_ocmate_import_files/figure-html5/unnamed-chunk-6-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ocmate</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>pill</span>, <span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/mutate_at.html'>mutate_at</a></span><span class='op'>(</span><span class='fu'>vars</span><span class='op'>(</span><span class='va'>progesterone</span>, <span class='va'>estradiol</span>, <span class='va'>testosterone</span>, <span class='va'>cortisol</span><span class='op'>)</span>, <span class='va'>log</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/summarise_at.html'>summarise_at</a></span><span class='op'>(</span><span class='fu'>vars</span><span class='op'>(</span><span class='va'>progesterone</span>, <span class='va'>estradiol</span>, <span class='va'>testosterone</span>, <span class='va'>cortisol</span><span class='op'>)</span>, <span class='va'>mean</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>pill</span>, <span class='op'>-</span><span class='va'>id</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/drop_na.html'>drop_na</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>pill</span><span class='op'>)</span>, <span class='va'>value</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>ggbeeswarm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ggbeeswarm/man/geom_beeswarm.html'>geom_beeswarm</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_pointrange</span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>'summary'</span>, fun.data <span class='op'>=</span> <span class='st'>'mean_cl_boot'</span>, color <span class='op'>=</span> <span class='st'>'blue'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>name</span>, scales <span class='op'>=</span> <span class='st'>'free_y'</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>group_by: 2 grouping variables (pill, id)</code></pre>
<pre><code>mutate_at (grouped): changed 3,828 values (91%) of &#39;progesterone&#39; (0 new NA)</code></pre>
<pre><code>                     changed 3,828 values (91%) of &#39;estradiol&#39; (0 new NA)</code></pre>
<pre><code>                     changed 3,828 values (91%) of &#39;testosterone&#39; (0 new NA)</code></pre>
<pre><code>                     changed 3,826 values (91%) of &#39;cortisol&#39; (0 new NA)</code></pre>
<pre><code>summarise_at: now 770 rows and 6 columns, one group variable remaining (pill)</code></pre>
<pre><code>pivot_longer: reorganized (progesterone, estradiol, testosterone, cortisol) into (name, value) [was 770x6, now 3080x4]</code></pre>
<pre><code>drop_na (grouped): removed 520 rows (17%), 2,560 rows remaining</code></pre>
<p><img src="1_ocmate_import_files/figure-html5/unnamed-chunk-6-2.png" width="624" /></p>
</div>
<h2 id="export">Export</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/source.html'>source</a></span><span class='op'>(</span><span class='st'>"0_summary_functions.R"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Loading required package: Rcpp</code></pre>
<pre><code>Loading &#39;brms&#39; package (version 2.16.2). Useful instructions
can be found by typing help(&#39;brms&#39;). A more detailed introduction
to the package is available through vignette(&#39;brms_overview&#39;).</code></pre>
<pre><code>
Attaching package: &#39;brms&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:stats&#39;:

    ar</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>export_anon</span><span class='op'>(</span><span class='st'>"ocmate"</span>, <span class='va'>ocmate</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning: Unknown columns: `lh_day`</code></pre>
<pre><code>select: dropped 27 variables (block, age, ethnicity, sexpref, date, )</code></pre>
<pre><code>ungroup: no grouping variables</code></pre>
<pre><code>mutate: converted &#39;id&#39; from character to factor (0 new NA)</code></pre>
</div>
<h2 id="summarize">Summarize</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>ocmate</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pill</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>bc_day</span>, <span class='va'>fc_day</span>, <span class='va'>estradiol</span>, <span class='va'>progesterone</span>, <span class='va'>cycle_length</span>, <span class='va'>age</span>, <span class='va'>partner</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed 1,826 rows (43%), 2,394 rows remaining</code></pre>
<pre><code>select: dropped 27 variables (block, ethnicity, sexpref, date, pill, )</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>summarise_hormones</span><span class='op'>(</span><span class='va'>df</span>, <span class='st'>"OCMATE Non-HC"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed 730 rows (30%), 1,664 rows remaining</code></pre>
<pre><code>select: dropped 25 variables (prc_wcx_bc, est_estradiol_bc, est_estradiol_bc_se, est_estradiol_bc_low, est_estradiol_bc_high, )</code></pre>
<pre><code>Joining, by = &quot;bc_day&quot;</code></pre>
<pre><code>left_join: added one column (prc_stirn_bc)</code></pre>
<pre><code>           &gt; rows only in x     891</code></pre>
<pre><code>           &gt; rows only in y  (    9)</code></pre>
<pre><code>           &gt; matched rows       773</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,664</code></pre>
<pre><code>select: dropped 25 variables (prc_wcx_fc, est_estradiol_fc, est_estradiol_fc_se, est_estradiol_fc_low, est_estradiol_fc_high, )</code></pre>
<pre><code>left_join: added one column (prc_stirn_fc)</code></pre>
<pre><code>           &gt; rows only in x     112</code></pre>
<pre><code>           &gt; rows only in y  (    5)</code></pre>
<pre><code>           &gt; matched rows     1,552</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,664</code></pre>
<pre><code>Warning: Unknown or uninitialised column: `lh_day`.</code></pre>
<pre><code>left_join: added 22 columns (conception_risk_lh, fertile_lh, est_estradiol_lh, est_estradiol_lh_se, est_estradiol_lh_low, )</code></pre>
<pre><code>           &gt; rows only in x   1,664</code></pre>
<pre><code>           &gt; rows only in y  (   31)</code></pre>
<pre><code>           &gt; matched rows         0</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,664</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed 393 rows (24%), 1,271 rows remaining</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed 36 rows (2%), 1,628 rows remaining</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.

Warning: Rows containing NAs were excluded from the model.

Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>$Dataset
[1] &quot;OCMATE Non-HC&quot;

$Hormone
[1] &quot;Estradiol &amp; Progesterone&quot;

$Method
[1] &quot;Salivary Immunoassay&quot;

$scatterplot</code></pre>
<pre><code>Warning: Removed 103 rows containing missing values (geom_point).</code></pre>
<p><img src="1_ocmate_import_files/figure-html5/unnamed-chunk-8-1.png" width="624" /></p>
<pre><code>
$n_women
[1] 384

$n_cycles
[1] 907

$n_days
[1] 2394

$r_ep
[1] &quot; 0.27 [ 0.23; 0.30]&quot;

$r_log_ep
[1] &quot; 0.43 [ 0.40; 0.46]&quot;

$r_e_ratio
[1] &quot; 0.13 [ 0.09; 0.17]&quot;

$r_log_e_ratio
[1] &quot; 0.12 [ 0.08; 0.16]&quot;

$r_p_ratio
[1] &quot;-0.43 [-0.46;-0.39]&quot;

$r_log_p_ratio
[1] &quot;-0.84 [-0.85;-0.83]&quot;

$usable_n
[1] 1664

$r_bc_ratio
[1] &quot; 0.18 [ 0.11; 0.25]&quot;

$r_bc_log_ratio
[1] &quot; 0.30 [ 0.23; 0.36]&quot;

$m_bc_prob_rat
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: prc_stirn_bc ~ log(estradiol) + log(ratio) 
   Data: df (Number of observations: 773) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept        0.48      0.04     0.40     0.56 1.00     3816
logestradiol    -0.02      0.02    -0.05     0.01 1.00     4041
logratio         0.08      0.01     0.06     0.10 1.00     3981
             Tail_ESS
Intercept        2683
logestradiol     2918
logratio         2715

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.18      0.00     0.17     0.18 1.00     3381     2647

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_erat_bc
[1] &quot;0.29 [0.21;0.34]&quot;

$m_bc_prob
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: prc_stirn_bc ~ s(log(estradiol), log(progesterone)) 
   Data: df (Number of observations: 773) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
                                    Estimate Est.Error l-95% CI
sds(slogestradiollogprogesterone_1)     0.10      0.07     0.01
                                    u-95% CI Rhat Bulk_ESS Tail_ESS
sds(slogestradiollogprogesterone_1)     0.26 1.00      843     1574

Population-Level Effects: 
                               Estimate Est.Error l-95% CI u-95% CI
Intercept                          0.16      0.01     0.15     0.17
slogestradiollogprogesterone_1    -0.28      0.27    -0.89     0.21
slogestradiollogprogesterone_2    -0.70      0.27    -1.12    -0.09
                               Rhat Bulk_ESS Tail_ESS
Intercept                      1.00     6961     3153
slogestradiollogprogesterone_1 1.00     2034     1896
slogestradiollogprogesterone_2 1.00     1518     1579

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.18      0.00     0.17     0.18 1.00     5833     2985

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_loo_bc
[1] &quot;0.29 [0.22;0.35]&quot;

$r_fc_ratio
[1] &quot; 0.10 [ 0.05; 0.15]&quot;

$r_fc_log_ratio
[1] &quot; 0.18 [ 0.14; 0.23]&quot;

$m_fc_prob_rat
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: prc_stirn_fc ~ log(estradiol) + log(ratio) 
   Data: df (Number of observations: 1552) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept        0.38      0.03     0.32     0.44 1.00     3709
logestradiol    -0.01      0.01    -0.03     0.01 1.00     3528
logratio         0.05      0.01     0.04     0.07 1.00     3999
             Tail_ESS
Intercept        2664
logestradiol     2990
logratio         2898

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.19      0.00     0.19     0.20 1.00     3569     2452

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_erat_fc
[1] &quot;0.18 [0.12;0.22]&quot;

$m_fc_prob
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: prc_stirn_fc ~ s(log(estradiol), log(progesterone)) 
   Data: df (Number of observations: 1552) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
                                    Estimate Est.Error l-95% CI
sds(slogestradiollogprogesterone_1)     0.07      0.04     0.01
                                    u-95% CI Rhat Bulk_ESS Tail_ESS
sds(slogestradiollogprogesterone_1)     0.15 1.00     1438     1269

Population-Level Effects: 
                               Estimate Est.Error l-95% CI u-95% CI
Intercept                          0.18      0.01     0.17     0.19
slogestradiollogprogesterone_1    -0.32      0.15    -0.60    -0.01
slogestradiollogprogesterone_2    -0.63      0.22    -1.06    -0.17
                               Rhat Bulk_ESS Tail_ESS
Intercept                      1.00     9654     2380
slogestradiollogprogesterone_1 1.00     3457     2582
slogestradiollogprogesterone_2 1.00     3313     2745

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.19      0.00     0.19     0.20 1.00     6388     2892

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_loo_fc
[1] &quot;0.18 [0.12;0.22]&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>ocmate</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pill</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>bc_day</span>, <span class='va'>fc_day</span>, <span class='va'>estradiol</span>, <span class='va'>progesterone</span>, <span class='va'>cycle_length</span>, <span class='va'>age</span>, <span class='va'>partner</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed 2,661 rows (63%), 1,559 rows remaining</code></pre>
<pre><code>select: dropped 27 variables (block, ethnicity, sexpref, date, pill, )</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>summarise_hormones</span><span class='op'>(</span>df <span class='op'>=</span> <span class='va'>df</span>, Dataset <span class='op'>=</span> <span class='st'>"OCMATE HC"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed 415 rows (27%), 1,144 rows remaining</code></pre>
<pre><code>select: dropped 25 variables (prc_wcx_bc, est_estradiol_bc, est_estradiol_bc_se, est_estradiol_bc_low, est_estradiol_bc_high, )</code></pre>
<pre><code>Joining, by = &quot;bc_day&quot;</code></pre>
<pre><code>left_join: added one column (prc_stirn_bc)</code></pre>
<pre><code>           &gt; rows only in x     637</code></pre>
<pre><code>           &gt; rows only in y  (   12)</code></pre>
<pre><code>           &gt; matched rows       507</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,144</code></pre>
<pre><code>select: dropped 25 variables (prc_wcx_fc, est_estradiol_fc, est_estradiol_fc_se, est_estradiol_fc_low, est_estradiol_fc_high, )</code></pre>
<pre><code>left_join: added one column (prc_stirn_fc)</code></pre>
<pre><code>           &gt; rows only in x      66</code></pre>
<pre><code>           &gt; rows only in y  (    5)</code></pre>
<pre><code>           &gt; matched rows     1,078</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,144</code></pre>
<pre><code>Warning: Unknown or uninitialised column: `lh_day`.</code></pre>
<pre><code>left_join: added 22 columns (conception_risk_lh, fertile_lh, est_estradiol_lh, est_estradiol_lh_se, est_estradiol_lh_low, )</code></pre>
<pre><code>           &gt; rows only in x   1,144</code></pre>
<pre><code>           &gt; rows only in y  (   31)</code></pre>
<pre><code>           &gt; matched rows         0</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,144</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed 264 rows (23%), 880 rows remaining</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed 25 rows (2%), 1,119 rows remaining</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.

Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Estimate&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Estimate&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.

Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Estimate&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>$Dataset
[1] &quot;OCMATE HC&quot;

$Hormone
[1] &quot;Estradiol &amp; Progesterone&quot;

$Method
[1] &quot;Salivary Immunoassay&quot;

$scatterplot</code></pre>
<pre><code>Warning: Removed 76 rows containing missing values (geom_point).</code></pre>
<p><img src="1_ocmate_import_files/figure-html5/unnamed-chunk-8-2.png" width="624" /></p>
<pre><code>
$n_women
[1] 276

$n_cycles
[1] 609

$n_days
[1] 1559

$r_ep
[1] &quot; 0.45 [ 0.41; 0.49]&quot;

$r_log_ep
[1] &quot; 0.55 [ 0.52; 0.59]&quot;

$r_e_ratio
[1] &quot; 0.04 [-0.01; 0.09]&quot;

$r_log_e_ratio
[1] &quot; 0.05 [ 0.00; 0.10]&quot;

$r_p_ratio
[1] &quot;-0.55 [-0.59;-0.52]&quot;

$r_log_p_ratio
[1] &quot;-0.80 [-0.82;-0.79]&quot;

$usable_n
[1] 1144

$r_bc_ratio
[1] &quot; 0.09 [ 0.00; 0.18]&quot;

$r_bc_log_ratio
[1] &quot; 0.08 [-0.01; 0.16]&quot;

$m_bc_prob_rat
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: prc_stirn_bc ~ log(estradiol) + log(ratio) 
   Data: df (Number of observations: 507) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept        0.24      0.05     0.14     0.34 1.00     3513
logestradiol    -0.01      0.02    -0.04     0.03 1.00     3274
logratio         0.02      0.01    -0.00     0.05 1.00     3637
             Tail_ESS
Intercept        2543
logestradiol     2581
logratio         2526

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.18      0.01     0.17     0.20 1.00     3423     2763

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_erat_bc
[1] &quot;NaN [NaN;0.10]&quot;

$m_bc_prob
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: prc_stirn_bc ~ s(log(estradiol), log(progesterone)) 
   Data: df (Number of observations: 507) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
                                    Estimate Est.Error l-95% CI
sds(slogestradiollogprogesterone_1)     0.07      0.06     0.00
                                    u-95% CI Rhat Bulk_ESS Tail_ESS
sds(slogestradiollogprogesterone_1)     0.23 1.00     1121     1709

Population-Level Effects: 
                               Estimate Est.Error l-95% CI u-95% CI
Intercept                          0.16      0.01     0.15     0.18
slogestradiollogprogesterone_1    -0.24      0.19    -0.68     0.10
slogestradiollogprogesterone_2     0.16      0.24    -0.32     0.68
                               Rhat Bulk_ESS Tail_ESS
Intercept                      1.00     6600     2929
slogestradiollogprogesterone_1 1.00     2136     1989
slogestradiollogprogesterone_2 1.00     2395     2129

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.18      0.01     0.17     0.20 1.00     5802     3078

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_loo_bc
[1] &quot;NaN [NaN;0.09]&quot;

$r_fc_ratio
[1] &quot; 0.07 [ 0.01; 0.13]&quot;

$r_fc_log_ratio
[1] &quot; 0.07 [ 0.01; 0.13]&quot;

$m_fc_prob_rat
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: prc_stirn_fc ~ log(estradiol) + log(ratio) 
   Data: df (Number of observations: 1078) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept        0.24      0.04     0.17     0.32 1.00     3681
logestradiol     0.01      0.01    -0.01     0.04 1.00     3925
logratio         0.02      0.01     0.00     0.04 1.00     3912
             Tail_ESS
Intercept        2821
logestradiol     2608
logratio         2713

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.19      0.00     0.18     0.20 1.00     3611     2481

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_erat_fc
[1] &quot;0.04 [NaN;0.10]&quot;

$m_fc_prob
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: prc_stirn_fc ~ s(log(estradiol), log(progesterone)) 
   Data: df (Number of observations: 1078) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
                                    Estimate Est.Error l-95% CI
sds(slogestradiollogprogesterone_1)     0.06      0.05     0.00
                                    u-95% CI Rhat Bulk_ESS Tail_ESS
sds(slogestradiollogprogesterone_1)     0.18 1.00     1121     1865

Population-Level Effects: 
                               Estimate Est.Error l-95% CI u-95% CI
Intercept                          0.18      0.01     0.16     0.19
slogestradiollogprogesterone_1    -0.25      0.23    -0.71     0.20
slogestradiollogprogesterone_2    -0.30      0.17    -0.67     0.01
                               Rhat Bulk_ESS Tail_ESS
Intercept                      1.00     5603     2577
slogestradiollogprogesterone_1 1.00     1920     1787
slogestradiollogprogesterone_2 1.00     2153     1503

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.19      0.00     0.18     0.20 1.00     4694     2289

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_loo_fc
[1] &quot;NaN [NaN;0.10]&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>ocmate</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pill</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>bc_day</span>, <span class='va'>fc_day</span>, <span class='va'>cycle_length</span>, <span class='va'>age</span>, <span class='va'>partner</span>, hormone <span class='op'>=</span> <span class='va'>estradiol</span>, hormone_cens <span class='op'>=</span> <span class='va'>estradiol_cens</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed 1,826 rows (43%), 2,394 rows remaining</code></pre>
<pre><code>select: renamed 2 variables (hormone, hormone_cens) and dropped 27 variables</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>summarise_hormone</span><span class='op'>(</span><span class='va'>df</span>, <span class='st'>"OCMATE Non-HC"</span>, <span class='st'>"Estradiol"</span>, 
                  Method <span class='op'>=</span> <span class='st'>"Salivary immunoassay (Salimetrics)"</span>, 
                  Citation <span class='op'>=</span> <span class='st'>"Jones, B. C., Hahn, A. C., Fisher, C. I., Wang, H., Kandrik, M., Han, C., Fasolt, V., Morrison, D., Lee, A. J., Holzleitner, I. J., OShea, K. J., Roberts, S. C., Little, A. C., &amp; DeBruine, L. M. (2018). No Compelling Evidence that Preferences for Facial Masculinity Track Changes in Womens Hormonal Status. Psychological Science, 29(6), 9961005. https://doi.org/10.1177/0956797618760197"</span>,
                  LOD <span class='op'>=</span> <span class='fl'>0.1</span>,
                  LOQ <span class='op'>=</span> <span class='fl'>1</span>,
                  CV_intra <span class='op'>=</span> <span class='fl'>7.13</span>,
                  CV_inter <span class='op'>=</span> <span class='fl'>7.45</span>,
                  Procedure <span class='op'>=</span> <span class='st'>"Participants provided a saliva sample via passive drool (Papacosta &amp; Nassis, 2011) in each test session. Partici- pants were instructed to avoid consuming alcohol and coffee in the 12 hr prior to participation and avoid eating, smoking, drinking, chewing gum, or brushing their teeth in the 60 min prior to participation. Each womans test sessions took place at approximately the same time of day to minimize effects of diurnal changes in hormone levels (Bao et al., 2003; Veldhuis et al., 1988).
Saliva samples were frozen immediately and stored at 32 C until being shipped on dry ice to the Salimet- rics Lab (Suffolk, United Kingdom) for analysis, where they were assayed using the Salivary 17-Estradiol Enzyme Immunoassay Kit 1-3702 (M = 3.30 pg/mL, SD = 1.27 pg/mL, sensitivity = 0.1 pg/mL, intra-assay coefficient of variability, or CV = 7.13%, inter-assay CV = 7.45%)."</span>,
                  Scheduling <span class='op'>=</span> <span class='st'>"Irrespective of cycle. 'Participants completed up to three blocks of test sessions (mean time between Block 1 and Block 2 = 230 days; mean time between Block 2 and Block 3 = 487 days). Each of the three blocks of test sessions consisted of five weekly test sessions. Table 1 shows how many women completed one, two, three, four, or five test sessions in Blocks 1 through 3.'"</span>, 
                  LH_test <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: dropped 7 variables (bc_day, fc_day, age, partner, hormone, )</code></pre>
<pre><code>group_by: 2 grouping variables (id, cycle)</code></pre>
<pre><code>summarise: now 907 rows and 3 columns, one group variable remaining (id)</code></pre>
<pre><code>ungroup: no grouping variables</code></pre>
<pre><code>select: dropped 8 variables (cycle, bc_day, fc_day, cycle_length, partner, )</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>summarise: now 384 rows and 2 columns, ungrouped</code></pre>
<pre><code>select: dropped 7 variables (cycle, bc_day, fc_day, cycle_length, hormone, )</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>summarise: now 384 rows and 2 columns, ungrouped</code></pre>
<pre><code>filter: removed 730 rows (30%), 1,664 rows remaining</code></pre>
<pre><code>group_by: 2 grouping variables (id, cycle)</code></pre>
<pre><code>mutate (grouped): new variable &#39;hormone_diff&#39; (double) with 1,428 unique values and 0% NA</code></pre>
<pre><code>                  new variable &#39;log_hormone_diff&#39; (double) with 1,433 unique values and 0% NA</code></pre>
<pre><code>ungroup: no grouping variables</code></pre>
<pre><code>Joining, by = &quot;bc_day&quot;</code></pre>
<pre><code>left_join: added 26 columns (prc_stirn_bc, prc_wcx_bc, est_estradiol_bc, est_estradiol_bc_se, est_estradiol_bc_low, )</code></pre>
<pre><code>           &gt; rows only in x     891</code></pre>
<pre><code>           &gt; rows only in y  (    9)</code></pre>
<pre><code>           &gt; matched rows       773</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,664</code></pre>
<pre><code>left_join: added 26 columns (prc_stirn_fc, prc_wcx_fc, est_estradiol_fc, est_estradiol_fc_se, est_estradiol_fc_low, )</code></pre>
<pre><code>           &gt; rows only in x     112</code></pre>
<pre><code>           &gt; rows only in y  (    5)</code></pre>
<pre><code>           &gt; matched rows     1,552</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,664</code></pre>
<pre><code>Warning: Unknown or uninitialised column: `lh_day`.</code></pre>
<pre><code>left_join: added 22 columns (conception_risk_lh, fertile_lh, est_estradiol_lh, est_estradiol_lh_se, est_estradiol_lh_low, )</code></pre>
<pre><code>           &gt; rows only in x   1,664</code></pre>
<pre><code>           &gt; rows only in y  (   31)</code></pre>
<pre><code>           &gt; matched rows         0</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,664</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed 393 rows (24%), 1,271 rows remaining</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed 36 rows (2%), 1,628 rows remaining</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.

Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.

Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Estimate&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q97.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Estimate&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q97.5&quot;]): NaNs produced</code></pre>
<pre><code>$Dataset
[1] &quot;OCMATE Non-HC&quot;

$Citation
[1] &quot;Jones, B. C., Hahn, A. C., Fisher, C. I., Wang, H., Kandrik, M., Han, C., Fasolt, V., Morrison, D., Lee, A. J., Holzleitner, I. J., OShea, K. J., Roberts, S. C., Little, A. C., &amp; DeBruine, L. M. (2018). No Compelling Evidence that Preferences for Facial Masculinity Track Changes in Womens Hormonal Status. Psychological Science, 29(6), 9961005. https://doi.org/10.1177/0956797618760197&quot;

$Hormone
[1] &quot;Estradiol&quot;

$Method
[1] &quot;Salivary immunoassay (Salimetrics)&quot;

$`Limit of detection`
[1] 0.1

$LOQ
[1] 1

$`Intraassay CV`
[1] 7.13

$`Interassay CV`
[1] 7.45

$Procedure
[1] &quot;Participants provided a saliva sample via passive drool (Papacosta &amp; Nassis, 2011) in each test session. Partici- pants were instructed to avoid consuming alcohol and coffee in the 12 hr prior to participation and avoid eating, smoking, drinking, chewing gum, or brushing their teeth in the 60 min prior to participation. Each womans test sessions took place at approximately the same time of day to minimize effects of diurnal changes in hormone levels (Bao et al., 2003; Veldhuis et al., 1988).\nSaliva samples were frozen immediately and stored at 32 C until being shipped on dry ice to the Salimet- rics Lab (Suffolk, United Kingdom) for analysis, where they were assayed using the Salivary 17-Estradiol Enzyme Immunoassay Kit 1-3702 (M = 3.30 pg/mL, SD = 1.27 pg/mL, sensitivity = 0.1 pg/mL, intra-assay coefficient of variability, or CV = 7.13%, inter-assay CV = 7.45%).&quot;

$Scheduling
[1] &quot;Irrespective of cycle. &#39;Participants completed up to three blocks of test sessions (mean time between Block 1 and Block 2 = 230 days; mean time between Block 2 and Block 3 = 487 days). Each of the three blocks of test sessions consisted of five weekly test sessions. Table 1 shows how many women completed one, two, three, four, or five test sessions in Blocks 1 through 3.&#39;&quot;

$LH_test
[1] &quot;&quot;

$distribution</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 103 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_ocmate_import_files/figure-html5/unnamed-chunk-8-3.png" width="624" /></p>
<pre><code>
$mean
[1] 3.362256

$logmean
[1] 1.126175

$logsd
[1] 0.4144053

$median
[1] 3.1117

$sd
[1] 1.550295

$mad
[1] 1.232782

$range
[1] &quot;0.48, 24.22&quot;

$missing
[1] 103

$outliers
[1] 9

$censored
[1] 0

$n_women
[1] 384

$n_cycles
[1] 907

$n_days
[1] 2394

$age
[1] &quot;21.53.29&quot;

$in_relationship
[1] &quot;36%&quot;

$cycle_length
[1] &quot;29.76.73&quot;

$usable_n
[1] 1664

$usable_n_women
[1] 360

$no_lh_surge_woman
[1] &quot;NA&quot;

$no_lh_surge_cycle
[1] &quot;NA&quot;

$var_id_loo
[1] &quot;0.47 [0.43;0.51]&quot;

$var_cycle_loo
[1] &quot;0.51 [0.47;0.54]&quot;

$var_id
[1] &quot;0.30 [0.27;0.33] (50%)&quot;

$var_cycle
[1] &quot;0.14 [0.11;0.17] (12%)&quot;

$var_resid
[1] &quot;0.26 [0.25;0.27] (38%)&quot;

$bc_day_model
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(bc_day) + (1 | id) + (1 | id:cycle) 
   Data: df (Number of observations: 773) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sbc_day_1)     0.31      0.22     0.06     0.90 1.00     1723
               Tail_ESS
sds(sbc_day_1)     2212

Group-Level Effects: 
~id (Number of levels: 255) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.24      0.04     0.14     0.31 1.01      344
              Tail_ESS
sd(Intercept)      480

~id:cycle (Number of levels: 312) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.23      0.03     0.17     0.30 1.01      308
              Tail_ESS
sd(Intercept)      413

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     1.13      0.02     1.09     1.17 1.00     4049     3056
sbc_day_1    -0.19      0.63    -1.66     0.83 1.00     2652     2148

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.25      0.01     0.23     0.26 1.00     2336     2999

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_bc
[1] &quot;0.13 [0.08;0.17]&quot;

$rmse_bc
[1] &quot;0.48 [0.46;0.50]&quot;

$r_loo_bc
[1] &quot;NaN [NaN;NaN]&quot;

$r_bc_stirn
[1] &quot;-0.01 [-0.08; 0.06]&quot;

$r_log_bc_stirn
[1] &quot;-0.00 [-0.08; 0.07]&quot;

$r_diff_bc_stirn
[1] &quot;-0.04 [-0.11; 0.03]&quot;

$r_log_diff_bc_stirn
[1] &quot;-0.04 [-0.11; 0.03]&quot;

$r_bc_imputed
[1] &quot; 0.08 [ 0.01; 0.15]&quot;

$r_diff_bc_imputed
[1] &quot; 0.18 [ 0.11; 0.25]&quot;

$sd_bc_imputed
[1] &quot;0.51 (64%)&quot;

$r_diff_bc_imputed_rr
[1] &quot; 0.22 [ 0.14; 0.30]&quot;

$imputed_bc_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 892 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 892 rows containing missing values (geom_point).</code></pre>
<p><img src="1_ocmate_import_files/figure-html5/unnamed-chunk-8-4.png" width="624" /></p>
<pre><code>
$rmse_bc_imputed
[1] &quot; 0.64&quot;

$fc_day_model
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(fc_day) + (1 | id) + (1 | id:cycle) 
   Data: df (Number of observations: 1552) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sfc_day_1)     0.40      0.22     0.12     0.97 1.00     1361
               Tail_ESS
sds(sfc_day_1)     2066

Group-Level Effects: 
~id (Number of levels: 349) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.30      0.02     0.27     0.34 1.00     1369
              Tail_ESS
sd(Intercept)     2412

~id:cycle (Number of levels: 618) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.14      0.01     0.11     0.17 1.00      687
              Tail_ESS
sd(Intercept)     1768

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     1.14      0.02     1.10     1.17 1.00     1782     2614
sfc_day_1     0.08      0.58    -1.07     1.27 1.00     3211     2587

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.25      0.01     0.24     0.26 1.00     2189     2823

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_fc
[1] &quot;0.12 [0.09;0.16]&quot;

$rmse_fc
[1] &quot;0.48 [0.47;0.49]&quot;

$r_loo_fc
[1] &quot;NaN [NaN;NaN]&quot;

$r_fc_stirn
[1] &quot;-0.00 [-0.05; 0.05]&quot;

$r_log_fc_stirn
[1] &quot;-0.00 [-0.05; 0.05]&quot;

$r_diff_fc_stirn
[1] &quot;-0.01 [-0.06; 0.04]&quot;

$r_log_diff_fc_stirn
[1] &quot;-0.02 [-0.07; 0.03]&quot;

$r_fc_imputed
[1] &quot; 0.07 [ 0.02; 0.12]&quot;

$r_diff_fc_imputed
[1] &quot; 0.15 [ 0.10; 0.19]&quot;

$sd_fc_imputed
[1] &quot;0.52 (101%)&quot;

$r_diff_fc_imputed_rr
[1] &quot; 0.15 [ 0.10; 0.19]&quot;

$imputed_fc_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 150 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 150 rows containing missing values (geom_point).</code></pre>
<p><img src="1_ocmate_import_files/figure-html5/unnamed-chunk-8-5.png" width="624" /></p>
<pre><code>
$rmse_fc_imputed
[1] &quot; 0.69&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>ocmate</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pill</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>bc_day</span>, <span class='va'>fc_day</span>, <span class='va'>cycle_length</span>, <span class='va'>age</span>, <span class='va'>partner</span>, hormone <span class='op'>=</span> <span class='va'>progesterone</span>, hormone_cens <span class='op'>=</span> <span class='va'>progesterone_cens</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed 1,826 rows (43%), 2,394 rows remaining</code></pre>
<pre><code>select: renamed 2 variables (hormone, hormone_cens) and dropped 27 variables</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>summarise_hormone</span><span class='op'>(</span>df <span class='op'>=</span> <span class='va'>df</span>, Dataset <span class='op'>=</span> <span class='st'>"OCMATE Non-HC"</span>, 
                  Hormone <span class='op'>=</span> <span class='st'>"Progesterone"</span>, 
                  Method <span class='op'>=</span> <span class='st'>"Salivary immunoassay (Salimetrics)"</span>, 
                  Citation <span class='op'>=</span> <span class='st'>"Jones, B. C., Hahn, A. C., Fisher, C. I., Wang, H., Kandrik, M., Han, C., Fasolt, V., Morrison, D., Lee, A. J., Holzleitner, I. J., OShea, K. J., Roberts, S. C., Little, A. C., &amp; DeBruine, L. M. (2018). No Compelling Evidence that Preferences for Facial Masculinity Track Changes in Womens Hormonal Status. Psychological Science, 29(6), 9961005. https://doi.org/10.1177/0956797618760197"</span>,
                  LOD <span class='op'>=</span> <span class='fl'>5</span>,
                  LOQ <span class='op'>=</span> <span class='fl'>10</span>,
                  CV_intra <span class='op'>=</span> <span class='fl'>6.20</span>,
                  CV_inter <span class='op'>=</span> <span class='fl'>7.55</span>,
                  Procedure <span class='op'>=</span> <span class='st'>"Participants provided a saliva sample via passive drool (Papacosta &amp; Nassis, 2011) in each test session. Partici- pants were instructed to avoid consuming alcohol and coffee in the 12 hr prior to participation and avoid eating, smoking, drinking, chewing gum, or brushing their teeth in the 60 min prior to participation. Each womans test sessions took place at approximately the same time of day to minimize effects of diurnal changes in hormone levels (Bao et al., 2003; Veldhuis et al., 1988).
Saliva samples were frozen immediately and stored at 32 C until being shipped on dry ice to the Salimet- rics Lab (Suffolk, United Kingdom) for analysis, where they were assayed using the Salivary Progesterone Enzyme Immunoassay Kit 1-1502 (M = 148.55 pg/mL, SD = 96.13 pg/mL, sen- sitivity = 5 pg/mL, intra-assay CV = 6.20%, inter-assay CV = 7.55%)."</span>,
                  Scheduling <span class='op'>=</span> <span class='st'>"Irrespective of cycle. 'Participants completed up to three blocks of test sessions (mean time between Block 1 and Block 2 = 230 days; mean time between Block 2 and Block 3 = 487 days). Each of the three blocks of test sessions consisted of five weekly test sessions. Table 1 shows how many women completed one, two, three, four, or five test sessions in Blocks 1 through 3.'"</span>, 
                  LH_test <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: dropped 7 variables (bc_day, fc_day, age, partner, hormone, )</code></pre>
<pre><code>group_by: 2 grouping variables (id, cycle)</code></pre>
<pre><code>summarise: now 907 rows and 3 columns, one group variable remaining (id)</code></pre>
<pre><code>ungroup: no grouping variables</code></pre>
<pre><code>select: dropped 8 variables (cycle, bc_day, fc_day, cycle_length, partner, )</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>summarise: now 384 rows and 2 columns, ungrouped</code></pre>
<pre><code>select: dropped 7 variables (cycle, bc_day, fc_day, cycle_length, hormone, )</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>summarise: now 384 rows and 2 columns, ungrouped</code></pre>
<pre><code>filter: removed 730 rows (30%), 1,664 rows remaining</code></pre>
<pre><code>group_by: 2 grouping variables (id, cycle)</code></pre>
<pre><code>mutate (grouped): new variable &#39;hormone_diff&#39; (double) with 1,434 unique values and 0% NA</code></pre>
<pre><code>                  new variable &#39;log_hormone_diff&#39; (double) with 1,435 unique values and 0% NA</code></pre>
<pre><code>ungroup: no grouping variables</code></pre>
<pre><code>Joining, by = &quot;bc_day&quot;</code></pre>
<pre><code>left_join: added 26 columns (prc_stirn_bc, prc_wcx_bc, est_estradiol_bc, est_estradiol_bc_se, est_estradiol_bc_low, )</code></pre>
<pre><code>           &gt; rows only in x     891</code></pre>
<pre><code>           &gt; rows only in y  (    9)</code></pre>
<pre><code>           &gt; matched rows       773</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,664</code></pre>
<pre><code>left_join: added 26 columns (prc_stirn_fc, prc_wcx_fc, est_estradiol_fc, est_estradiol_fc_se, est_estradiol_fc_low, )</code></pre>
<pre><code>           &gt; rows only in x     112</code></pre>
<pre><code>           &gt; rows only in y  (    5)</code></pre>
<pre><code>           &gt; matched rows     1,552</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,664</code></pre>
<pre><code>Warning: Unknown or uninitialised column: `lh_day`.</code></pre>
<pre><code>left_join: added 22 columns (conception_risk_lh, fertile_lh, est_estradiol_lh, est_estradiol_lh_se, est_estradiol_lh_low, )</code></pre>
<pre><code>           &gt; rows only in x   1,664</code></pre>
<pre><code>           &gt; rows only in y  (   31)</code></pre>
<pre><code>           &gt; matched rows         0</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,664</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed 393 rows (24%), 1,271 rows remaining</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed 36 rows (2%), 1,628 rows remaining</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.

Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.

Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.

Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>$Dataset
[1] &quot;OCMATE Non-HC&quot;

$Citation
[1] &quot;Jones, B. C., Hahn, A. C., Fisher, C. I., Wang, H., Kandrik, M., Han, C., Fasolt, V., Morrison, D., Lee, A. J., Holzleitner, I. J., OShea, K. J., Roberts, S. C., Little, A. C., &amp; DeBruine, L. M. (2018). No Compelling Evidence that Preferences for Facial Masculinity Track Changes in Womens Hormonal Status. Psychological Science, 29(6), 9961005. https://doi.org/10.1177/0956797618760197&quot;

$Hormone
[1] &quot;Progesterone&quot;

$Method
[1] &quot;Salivary immunoassay (Salimetrics)&quot;

$`Limit of detection`
[1] 5

$LOQ
[1] 10

$`Intraassay CV`
[1] 6.2

$`Interassay CV`
[1] 7.55

$Procedure
[1] &quot;Participants provided a saliva sample via passive drool (Papacosta &amp; Nassis, 2011) in each test session. Partici- pants were instructed to avoid consuming alcohol and coffee in the 12 hr prior to participation and avoid eating, smoking, drinking, chewing gum, or brushing their teeth in the 60 min prior to participation. Each womans test sessions took place at approximately the same time of day to minimize effects of diurnal changes in hormone levels (Bao et al., 2003; Veldhuis et al., 1988).\nSaliva samples were frozen immediately and stored at 32 C until being shipped on dry ice to the Salimet- rics Lab (Suffolk, United Kingdom) for analysis, where they were assayed using the Salivary Progesterone Enzyme Immunoassay Kit 1-1502 (M = 148.55 pg/mL, SD = 96.13 pg/mL, sen- sitivity = 5 pg/mL, intra-assay CV = 6.20%, inter-assay CV = 7.55%).&quot;

$Scheduling
[1] &quot;Irrespective of cycle. &#39;Participants completed up to three blocks of test sessions (mean time between Block 1 and Block 2 = 230 days; mean time between Block 2 and Block 3 = 487 days). Each of the three blocks of test sessions consisted of five weekly test sessions. Table 1 shows how many women completed one, two, three, four, or five test sessions in Blocks 1 through 3.&#39;&quot;

$LH_test
[1] &quot;&quot;

$distribution</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 103 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_ocmate_import_files/figure-html5/unnamed-chunk-8-6.png" width="624" /></p>
<pre><code>
$mean
[1] 158.5442

$logmean
[1] 4.805426

$logsd
[1] 0.7620218

$median
[1] 130.17

$sd
[1] 121.3147

$mad
[1] 90.32296

$range
[1] &quot;5.00, 1859.40&quot;

$missing
[1] 103

$outliers
[1] 1

$censored
[1] 4

$n_women
[1] 384

$n_cycles
[1] 907

$n_days
[1] 2394

$age
[1] &quot;21.53.29&quot;

$in_relationship
[1] &quot;36%&quot;

$cycle_length
[1] &quot;29.76.73&quot;

$usable_n
[1] 1664

$usable_n_women
[1] 360

$no_lh_surge_woman
[1] &quot;NA&quot;

$no_lh_surge_cycle
[1] &quot;NA&quot;

$var_id_loo
[1] &quot;0.32 [0.28;0.36]&quot;

$var_cycle_loo
[1] &quot;0.32 [0.28;0.36]&quot;

$var_id
[1] &quot;0.49 [0.43;0.55] (39%)&quot;

$var_cycle
[1] &quot;0.18 [0.04;0.27] (6%)&quot;

$var_resid
[1] &quot;0.58 [0.56;0.61] (55%)&quot;

$bc_day_model
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(bc_day) + (1 | id) + (1 | id:cycle) 
   Data: df (Number of observations: 773) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sbc_day_1)     1.89      0.64     1.00     3.46 1.00     1676
               Tail_ESS
sds(sbc_day_1)     2172

Group-Level Effects: 
~id (Number of levels: 255) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.37      0.05     0.25     0.46 1.01      306
              Tail_ESS
sd(Intercept)      403

~id:cycle (Number of levels: 312) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.26      0.07     0.10     0.39 1.02      238
              Tail_ESS
sd(Intercept)      307

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     4.92      0.04     4.85     4.98 1.00     2858     2959
sbc_day_1    -3.67      2.35    -8.35     0.95 1.01     1948     2267

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.52      0.02     0.49     0.56 1.00     2275     2515

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_bc
[1] &quot;0.40 [0.36;0.45]&quot;

$rmse_bc
[1] &quot;0.87 [0.84;0.91]&quot;

$r_loo_bc
[1] &quot;0.37 [0.30;0.43]&quot;

$r_bc_stirn
[1] &quot;-0.25 [-0.32;-0.18]&quot;

$r_log_bc_stirn
[1] &quot;-0.27 [-0.33;-0.20]&quot;

$r_diff_bc_stirn
[1] &quot;-0.32 [-0.38;-0.25]&quot;

$r_log_diff_bc_stirn
[1] &quot;-0.35 [-0.41;-0.29]&quot;

$r_bc_imputed
[1] &quot; 0.40 [ 0.34; 0.46]&quot;

$r_diff_bc_imputed
[1] &quot; 0.46 [ 0.41; 0.52]&quot;

$sd_bc_imputed
[1] &quot;1.20 (91%)&quot;

$r_diff_bc_imputed_rr
[1] &quot; 0.48 [ 0.42; 0.54]&quot;

$imputed_bc_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 892 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 892 rows containing missing values (geom_point).</code></pre>
<p><img src="1_ocmate_import_files/figure-html5/unnamed-chunk-8-7.png" width="624" /></p>
<pre><code>
$rmse_bc_imputed
[1] &quot; 1.42&quot;

$fc_day_model
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(fc_day) + (1 | id) + (1 | id:cycle) 
   Data: df (Number of observations: 1552) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sfc_day_1)     0.98      0.39     0.47     2.00 1.00     1805
               Tail_ESS
sds(sfc_day_1)     2367

Group-Level Effects: 
~id (Number of levels: 349) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.50      0.03     0.44     0.56 1.00     1137
              Tail_ESS
sd(Intercept)     2154

~id:cycle (Number of levels: 618) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.17      0.05     0.06     0.25 1.02      316
              Tail_ESS
sd(Intercept)      248

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     4.83      0.03     4.77     4.89 1.00     1419     2229
sfc_day_1    -0.73      1.27    -3.29     1.80 1.00     2504     2419

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.53      0.01     0.51     0.55 1.00     1368     2317

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_fc
[1] &quot;0.31 [0.27;0.34]&quot;

$rmse_fc
[1] &quot;0.91 [0.89;0.94]&quot;

$r_loo_fc
[1] &quot;0.26 [0.20;0.31]&quot;

$r_fc_stirn
[1] &quot;-0.18 [-0.23;-0.13]&quot;

$r_log_fc_stirn
[1] &quot;-0.17 [-0.22;-0.12]&quot;

$r_diff_fc_stirn
[1] &quot;-0.23 [-0.27;-0.18]&quot;

$r_log_diff_fc_stirn
[1] &quot;-0.24 [-0.28;-0.19]&quot;

$r_fc_imputed
[1] &quot; 0.29 [ 0.24; 0.34]&quot;

$r_diff_fc_imputed
[1] &quot; 0.33 [ 0.28; 0.37]&quot;

$sd_fc_imputed
[1] &quot;1.13 (92%)&quot;

$r_diff_fc_imputed_rr
[1] &quot; 0.34 [ 0.29; 0.39]&quot;

$imputed_fc_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 150 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 150 rows containing missing values (geom_point).</code></pre>
<p><img src="1_ocmate_import_files/figure-html5/unnamed-chunk-8-8.png" width="624" /></p>
<pre><code>
$rmse_fc_imputed
[1] &quot; 1.62&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>ocmate</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pill</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>bc_day</span>, <span class='va'>fc_day</span>, <span class='va'>cycle_length</span>, <span class='va'>age</span>, <span class='va'>partner</span>, hormone <span class='op'>=</span> <span class='va'>estradiol</span>, hormone_cens <span class='op'>=</span> <span class='va'>estradiol_cens</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed 2,661 rows (63%), 1,559 rows remaining</code></pre>
<pre><code>select: renamed 2 variables (hormone, hormone_cens) and dropped 27 variables</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>summarise_hormone</span><span class='op'>(</span><span class='va'>df</span>, <span class='st'>"OCMATE HC"</span>, <span class='st'>"Estradiol"</span>, Method <span class='op'>=</span> <span class='st'>"Salivary immunoassay (Salimetrics)"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: dropped 7 variables (bc_day, fc_day, age, partner, hormone, )</code></pre>
<pre><code>group_by: 2 grouping variables (id, cycle)</code></pre>
<pre><code>summarise: now 609 rows and 3 columns, one group variable remaining (id)</code></pre>
<pre><code>ungroup: no grouping variables</code></pre>
<pre><code>select: dropped 8 variables (cycle, bc_day, fc_day, cycle_length, partner, )</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>summarise: now 276 rows and 2 columns, ungrouped</code></pre>
<pre><code>select: dropped 7 variables (cycle, bc_day, fc_day, cycle_length, hormone, )</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>summarise: now 276 rows and 2 columns, ungrouped</code></pre>
<pre><code>filter: removed 415 rows (27%), 1,144 rows remaining</code></pre>
<pre><code>group_by: 2 grouping variables (id, cycle)</code></pre>
<pre><code>mutate (grouped): new variable &#39;hormone_diff&#39; (double) with 971 unique values and 0% NA</code></pre>
<pre><code>                  new variable &#39;log_hormone_diff&#39; (double) with 975 unique values and 0% NA</code></pre>
<pre><code>ungroup: no grouping variables</code></pre>
<pre><code>Joining, by = &quot;bc_day&quot;</code></pre>
<pre><code>left_join: added 26 columns (prc_stirn_bc, prc_wcx_bc, est_estradiol_bc, est_estradiol_bc_se, est_estradiol_bc_low, )</code></pre>
<pre><code>           &gt; rows only in x     637</code></pre>
<pre><code>           &gt; rows only in y  (   12)</code></pre>
<pre><code>           &gt; matched rows       507</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,144</code></pre>
<pre><code>left_join: added 26 columns (prc_stirn_fc, prc_wcx_fc, est_estradiol_fc, est_estradiol_fc_se, est_estradiol_fc_low, )</code></pre>
<pre><code>           &gt; rows only in x      66</code></pre>
<pre><code>           &gt; rows only in y  (    5)</code></pre>
<pre><code>           &gt; matched rows     1,078</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,144</code></pre>
<pre><code>Warning: Unknown or uninitialised column: `lh_day`.</code></pre>
<pre><code>left_join: added 22 columns (conception_risk_lh, fertile_lh, est_estradiol_lh, est_estradiol_lh_se, est_estradiol_lh_low, )</code></pre>
<pre><code>           &gt; rows only in x   1,144</code></pre>
<pre><code>           &gt; rows only in y  (   31)</code></pre>
<pre><code>           &gt; matched rows         0</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,144</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed 264 rows (23%), 880 rows remaining</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed 25 rows (2%), 1,119 rows remaining</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.

Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.

Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Estimate&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q97.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Estimate&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q97.5&quot;]): NaNs produced</code></pre>
<pre><code>$Dataset
[1] &quot;OCMATE HC&quot;

$Citation
[1] &quot;&quot;

$Hormone
[1] &quot;Estradiol&quot;

$Method
[1] &quot;Salivary immunoassay (Salimetrics)&quot;

$`Limit of detection`
[1] NA

$LOQ
[1] NA

$`Intraassay CV`
[1] NA

$`Interassay CV`
[1] NA

$Procedure
[1] &quot;&quot;

$Scheduling
[1] &quot;&quot;

$LH_test
[1] &quot;&quot;

$distribution</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 76 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>
$mean
[1] 2.913146

$logmean
[1] 0.9826145

$logsd
[1] 0.4335113

$median
[1] 2.7674

$sd
[1] 1.195924

$mad
[1] 1.068658

$range
[1] &quot;0.10, 9.06&quot;

$missing
[1] 76

$outliers
[1] 0

$censored
[1] 1

$n_women
[1] 276

$n_cycles
[1] 609

$n_days
[1] 1559

$age
[1] &quot;21.42.58&quot;

$in_relationship
[1] &quot;65%&quot;

$cycle_length
[1] &quot;28.96.94&quot;

$usable_n
[1] 1144

$usable_n_women
[1] 258

$no_lh_surge_woman
[1] &quot;NA&quot;

$no_lh_surge_cycle
[1] &quot;NA&quot;

$var_id_loo
[1] &quot;0.57 [0.53;0.61]&quot;

$var_cycle_loo
[1] &quot;0.59 [0.55;0.63]&quot;

$var_id
[1] &quot;0.34 [0.30;0.38] (59%)&quot;

$var_cycle
[1] &quot;0.13 [0.10;0.17] (9%)&quot;

$var_resid
[1] &quot;0.25 [0.23;0.26] (31%)&quot;

$bc_day_model</code></pre>
<pre><code>Warning: There were 13 divergent transitions after warmup.
Increasing adapt_delta above may help. See http://mc-stan.org/misc/
warnings.html#divergent-transitions-after-warmup</code></pre>
<p><img src="1_ocmate_import_files/figure-html5/unnamed-chunk-8-9.png" width="624" /></p>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(bc_day) + (1 | id) + (1 | id:cycle) 
   Data: df (Number of observations: 507) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sbc_day_1)     0.18      0.23     0.00     0.84 1.00     1213
               Tail_ESS
sds(sbc_day_1)     1293

Group-Level Effects: 
~id (Number of levels: 174) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.31      0.04     0.22     0.38 1.00      717
              Tail_ESS
sd(Intercept)     1034

~id:cycle (Number of levels: 207) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.21      0.04     0.13     0.30 1.01      562
              Tail_ESS
sd(Intercept)     1114

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.98      0.03     0.92     1.04 1.00     3781     2852
sbc_day_1    -0.09      0.47    -1.35     0.57 1.00     2209     1415

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.25      0.01     0.23     0.27 1.00     2499     2762

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_bc
[1] &quot;0.05 [0.01;0.10]&quot;

$rmse_bc
[1] &quot;0.51 [0.49;0.54]&quot;

$r_loo_bc
[1] &quot;NaN [NaN;NaN]&quot;

$r_bc_stirn
[1] &quot;-0.01 [-0.10; 0.08]&quot;

$r_log_bc_stirn
[1] &quot;-0.01 [-0.09; 0.08]&quot;

$r_diff_bc_stirn
[1] &quot;-0.02 [-0.11; 0.06]&quot;

$r_log_diff_bc_stirn
[1] &quot;-0.00 [-0.09; 0.08]&quot;

$r_bc_imputed
[1] &quot; 0.03 [-0.06; 0.11]&quot;

$r_diff_bc_imputed
[1] &quot; 0.03 [-0.06; 0.12]&quot;

$sd_bc_imputed
[1] &quot;0.49 (60%)&quot;

$r_diff_bc_imputed_rr
[1] &quot; 0.04 [-0.07; 0.15]&quot;

$imputed_bc_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 637 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 637 rows containing missing values (geom_point).</code></pre>
<p><img src="1_ocmate_import_files/figure-html5/unnamed-chunk-8-10.png" width="624" /></p>
<pre><code>
$rmse_bc_imputed
[1] &quot; 0.71&quot;

$fc_day_model
 Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(fc_day) + (1 | id) + (1 | id:cycle) 
   Data: df (Number of observations: 1078) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sfc_day_1)     0.54      0.33     0.05     1.31 1.00      562
               Tail_ESS
sds(sfc_day_1)      590

Group-Level Effects: 
~id (Number of levels: 251) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.33      0.02     0.30     0.38 1.00     1120
              Tail_ESS
sd(Intercept)     2082

~id:cycle (Number of levels: 432) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.14      0.02     0.10     0.17 1.00      705
              Tail_ESS
sd(Intercept)     1494

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.98      0.02     0.94     1.03 1.00      842     1455
sfc_day_1    -0.85      0.77    -2.50     0.58 1.00     1318     2145

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.24      0.01     0.23     0.26 1.00     2010     2440

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_fc
[1] &quot;0.08 [0.02;0.12]&quot;

$rmse_fc
[1] &quot;0.50 [0.49;0.52]&quot;

$r_loo_fc
[1] &quot;NaN [NaN;NaN]&quot;

$r_fc_stirn
[1] &quot; 0.05 [-0.01; 0.11]&quot;

$r_log_fc_stirn
[1] &quot; 0.03 [-0.03; 0.09]&quot;

$r_diff_fc_stirn
[1] &quot; 0.04 [-0.02; 0.10]&quot;

$r_log_diff_fc_stirn
[1] &quot; 0.03 [-0.03; 0.09]&quot;

$r_fc_imputed
[1] &quot; 0.05 [-0.01; 0.11]&quot;

$r_diff_fc_imputed
[1] &quot; 0.05 [-0.01; 0.11]&quot;

$sd_fc_imputed
[1] &quot;0.51 (98%)&quot;

$r_diff_fc_imputed_rr
[1] &quot; 0.05 [-0.01; 0.11]&quot;

$imputed_fc_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 90 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 90 rows containing missing values (geom_point).</code></pre>
<p><img src="1_ocmate_import_files/figure-html5/unnamed-chunk-8-11.png" width="624" /></p>
<pre><code>
$rmse_fc_imputed
[1] &quot; 0.71&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>ocmate</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pill</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/tidylog/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>cycle</span>, <span class='va'>bc_day</span>, <span class='va'>fc_day</span>, <span class='va'>cycle_length</span>, <span class='va'>age</span>, <span class='va'>partner</span>, hormone <span class='op'>=</span> <span class='va'>progesterone</span>, hormone_cens <span class='op'>=</span> <span class='va'>progesterone_cens</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>filter: removed 2,661 rows (63%), 1,559 rows remaining</code></pre>
<pre><code>select: renamed 2 variables (hormone, hormone_cens) and dropped 27 variables</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>summarise_hormone</span><span class='op'>(</span>df <span class='op'>=</span> <span class='va'>df</span>, Dataset <span class='op'>=</span> <span class='st'>"OCMATE HC"</span>, Hormone <span class='op'>=</span> <span class='st'>"Progesterone"</span>, Method <span class='op'>=</span> <span class='st'>"Salivary immunoassay (Salimetrics)"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>select: dropped 7 variables (bc_day, fc_day, age, partner, hormone, )</code></pre>
<pre><code>group_by: 2 grouping variables (id, cycle)</code></pre>
<pre><code>summarise: now 609 rows and 3 columns, one group variable remaining (id)</code></pre>
<pre><code>ungroup: no grouping variables</code></pre>
<pre><code>select: dropped 8 variables (cycle, bc_day, fc_day, cycle_length, partner, )</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>summarise: now 276 rows and 2 columns, ungrouped</code></pre>
<pre><code>select: dropped 7 variables (cycle, bc_day, fc_day, cycle_length, hormone, )</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>summarise: now 276 rows and 2 columns, ungrouped</code></pre>
<pre><code>filter: removed 415 rows (27%), 1,144 rows remaining</code></pre>
<pre><code>group_by: 2 grouping variables (id, cycle)</code></pre>
<pre><code>mutate (grouped): new variable &#39;hormone_diff&#39; (double) with 976 unique values and 0% NA</code></pre>
<pre><code>                  new variable &#39;log_hormone_diff&#39; (double) with 977 unique values and 0% NA</code></pre>
<pre><code>ungroup: no grouping variables</code></pre>
<pre><code>Joining, by = &quot;bc_day&quot;</code></pre>
<pre><code>left_join: added 26 columns (prc_stirn_bc, prc_wcx_bc, est_estradiol_bc, est_estradiol_bc_se, est_estradiol_bc_low, )</code></pre>
<pre><code>           &gt; rows only in x     637</code></pre>
<pre><code>           &gt; rows only in y  (   12)</code></pre>
<pre><code>           &gt; matched rows       507</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,144</code></pre>
<pre><code>left_join: added 26 columns (prc_stirn_fc, prc_wcx_fc, est_estradiol_fc, est_estradiol_fc_se, est_estradiol_fc_low, )</code></pre>
<pre><code>           &gt; rows only in x      66</code></pre>
<pre><code>           &gt; rows only in y  (    5)</code></pre>
<pre><code>           &gt; matched rows     1,078</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,144</code></pre>
<pre><code>Warning: Unknown or uninitialised column: `lh_day`.</code></pre>
<pre><code>left_join: added 22 columns (conception_risk_lh, fertile_lh, est_estradiol_lh, est_estradiol_lh_se, est_estradiol_lh_low, )</code></pre>
<pre><code>           &gt; rows only in x   1,144</code></pre>
<pre><code>           &gt; rows only in y  (   31)</code></pre>
<pre><code>           &gt; matched rows         0</code></pre>
<pre><code>           &gt;                 =======</code></pre>
<pre><code>           &gt; rows total       1,144</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed 264 rows (23%), 880 rows remaining</code></pre>
<pre><code>group_by: one grouping variable (id)</code></pre>
<pre><code>filter (grouped): removed 25 rows (2%), 1,119 rows remaining</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.

Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning: Rows containing NAs were excluded from the model.

Warning: Rows containing NAs were excluded from the model.</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Estimate&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q97.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning: Results may not be meaningful for censored models.</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Estimate&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q2.5&quot;]): NaNs produced</code></pre>
<pre><code>Warning in sqrt(r2[, &quot;Q97.5&quot;]): NaNs produced</code></pre>
<pre><code>$Dataset
[1] &quot;OCMATE HC&quot;

$Citation
[1] &quot;&quot;

$Hormone
[1] &quot;Progesterone&quot;

$Method
[1] &quot;Salivary immunoassay (Salimetrics)&quot;

$`Limit of detection`
[1] NA

$LOQ
[1] NA

$`Intraassay CV`
[1] NA

$`Interassay CV`
[1] NA

$Procedure
[1] &quot;&quot;

$Scheduling
[1] &quot;&quot;

$LH_test
[1] &quot;&quot;

$distribution</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>Warning: Removed 76 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>
$mean
[1] 120.9104

$logmean
[1] 4.572098

$logsd
[1] 0.7278873

$median
[1] 109.69

$sd
[1] 75.42415

$mad
[1] 73.65705

$range
[1] &quot;5.00, 542.53&quot;

$missing
[1] 76

$outliers
[1] 0

$censored
[1] 1

$n_women
[1] 276

$n_cycles
[1] 609

$n_days
[1] 1559

$age
[1] &quot;21.42.58&quot;

$in_relationship
[1] &quot;65%&quot;

$cycle_length
[1] &quot;28.96.94&quot;

$usable_n
[1] 1144

$usable_n_women
[1] 258

$no_lh_surge_woman
[1] &quot;NA&quot;

$no_lh_surge_cycle
[1] &quot;NA&quot;

$var_id_loo
[1] &quot;0.58 [0.53;0.62]&quot;

$var_cycle_loo
[1] &quot;0.60 [0.56;0.64]&quot;

$var_id
[1] &quot;0.57 [0.51;0.64] (62%)&quot;

$var_cycle
[1] &quot;0.22 [0.15;0.27] (9%)&quot;

$var_resid
[1] &quot;0.40 [0.38;0.42] (29%)&quot;

$bc_day_model</code></pre>
<pre><code>Warning: There were 3 divergent transitions after warmup.
Increasing adapt_delta above may help. See http://mc-stan.org/misc/
warnings.html#divergent-transitions-after-warmup</code></pre>
<p><img src="1_ocmate_import_files/figure-html5/unnamed-chunk-8-12.png" width="624" /></p>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(bc_day) + (1 | id) + (1 | id:cycle) 
   Data: df (Number of observations: 507) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sbc_day_1)     0.30      0.28     0.01     1.05 1.00     1401
               Tail_ESS
sds(sbc_day_1)     1630

Group-Level Effects: 
~id (Number of levels: 174) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.56      0.06     0.43     0.67 1.01      595
              Tail_ESS
sd(Intercept)     1013

~id:cycle (Number of levels: 207) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.30      0.08     0.17     0.46 1.01      387
              Tail_ESS
sd(Intercept)      704

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     4.58      0.05     4.48     4.69 1.00     3247     2436
sbc_day_1     0.45      0.66    -1.00     1.77 1.00     2870     2074

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.40      0.02     0.37     0.43 1.00     1696     2235

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_bc
[1] &quot;0.12 [0.06;0.17]&quot;

$rmse_bc
[1] &quot;0.86 [0.82;0.90]&quot;

$r_loo_bc
[1] &quot;NaN [NaN;NaN]&quot;

$r_bc_stirn
[1] &quot;-0.06 [-0.15; 0.03]&quot;

$r_log_bc_stirn
[1] &quot;-0.07 [-0.15; 0.02]&quot;

$r_diff_bc_stirn
[1] &quot;-0.11 [-0.19;-0.02]&quot;

$r_log_diff_bc_stirn
[1] &quot;-0.14 [-0.22;-0.05]&quot;

$r_bc_imputed
[1] &quot; 0.08 [-0.00; 0.17]&quot;

$r_diff_bc_imputed
[1] &quot; 0.13 [ 0.05; 0.22]&quot;

$sd_bc_imputed
[1] &quot;1.21 (93%)&quot;

$r_diff_bc_imputed_rr
[1] &quot; 0.14 [ 0.05; 0.23]&quot;

$imputed_bc_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 637 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 637 rows containing missing values (geom_point).</code></pre>
<pre><code>
$rmse_bc_imputed
[1] &quot; 1.73&quot;

$fc_day_model</code></pre>
<pre><code>Warning: There were 1 divergent transitions after warmup.
Increasing adapt_delta above may help. See http://mc-stan.org/misc/
warnings.html#divergent-transitions-after-warmup</code></pre>
<p><img src="1_ocmate_import_files/figure-html5/unnamed-chunk-8-13.png" width="624" /></p>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(hormone) | cens(hormone_cens) ~ s(fc_day) + (1 | id) + (1 | id:cycle) 
   Data: df (Number of observations: 1078) 
  Draws: 4 chains, each with iter = 1000; warmup = 0; thin = 1;
         total post-warmup draws = 4000

Smooth Terms: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sds(sfc_day_1)     0.65      0.39     0.14     1.67 1.01      997
               Tail_ESS
sds(sfc_day_1)     1441

Group-Level Effects: 
~id (Number of levels: 251) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.57      0.03     0.51     0.63 1.01     1511
              Tail_ESS
sd(Intercept)     2347

~id:cycle (Number of levels: 432) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)     0.22      0.03     0.16     0.28 1.01      728
              Tail_ESS
sd(Intercept)     1722

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     4.57      0.04     4.49     4.65 1.00     1479     2445
sfc_day_1    -0.94      1.04    -3.10     0.99 1.00     2693     1913

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.39      0.01     0.37     0.42 1.00     2060     2673

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).

$r_fc
[1] &quot;0.09 [0.06;0.13]&quot;

$rmse_fc
[1] &quot;0.83 [0.81;0.86]&quot;

$r_loo_fc
[1] &quot;NaN [NaN;NaN]&quot;

$r_fc_stirn
[1] &quot;-0.03 [-0.09; 0.03]&quot;

$r_log_fc_stirn
[1] &quot;-0.04 [-0.10; 0.02]&quot;

$r_diff_fc_stirn
[1] &quot;-0.06 [-0.12;-0.00]&quot;

$r_log_diff_fc_stirn
[1] &quot;-0.09 [-0.15;-0.03]&quot;

$r_fc_imputed
[1] &quot; 0.07 [ 0.01; 0.13]&quot;

$r_diff_fc_imputed
[1] &quot; 0.12 [ 0.06; 0.18]&quot;

$sd_fc_imputed
[1] &quot;1.14 (95%)&quot;

$r_diff_fc_imputed_rr
[1] &quot; 0.12 [ 0.06; 0.18]&quot;

$imputed_fc_vs_measured_graph</code></pre>
<pre><code>Warning: Removed 90 rows containing missing values (geom_smooth).</code></pre>
<pre><code>Warning: Removed 90 rows containing missing values (geom_point).</code></pre>
<p><img src="1_ocmate_import_files/figure-html5/unnamed-chunk-8-14.png" width="624" /></p>
<pre><code>
$rmse_fc_imputed
[1] &quot; 1.83&quot;</code></pre>
</div>
<div class="sourceCode" id="cb525"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
